<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Fortran Object oriented Ordinary Differential Equations integration library">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>integrate_oscillation &ndash; FOODIE</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FOODIE </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
                
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
				
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>integrate_oscillation 
    <small>Program</small>
    
    </h1>
	 
<div class="row">
<div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
    <li><i class="fa fa-code"></i><a href="../src/oscillation.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/oscillation.f90.html'>oscillation.f90</a></li>
  
     <li class="active">integrate_oscillation</li>
  </ol>
</div>
</div>
</div>
    
  </div>
  
  <div class="row">
    <div class="col-lg-3">
    
<div id="sidebar">
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars">Variables</a></h3></div>
    <div id="vars" class="panel-collapse collapse">
      <div class="list-group">
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-cli%7E32">cli</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-space_dimension">space_dimension</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-initial_state%7E9">initial_state</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-f%7E8">f</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-amplitude">amplitude</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-t_final">t_final</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-dt%7E18">Dt</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-tolerance%7E3">tolerance</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-error%7E27">error</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-stages_steps">stages_steps</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-implicit_iterations">implicit_iterations</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-solver%7E2">solver</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-plots">plots</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-results">results</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-output_cli">output_cli</a>
        
        <a class="list-group-item" href="../program/integrate_oscillation.html#variable-errors_analysis">errors_analysis</a>
        
      </div>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#funcs">Functions</a></h3></div>
    <div id="funcs" class="panel-collapse collapse">
        <div class="list-group">
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-exact_solution">exact_solution</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-compute_amplitude_phase">compute_amplitude_phase</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-compute_errors">compute_errors</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-estimate_orders">estimate_orders</a>
          
        </div>
    </div>
  </div>
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs">Subroutines</a></h3></div>
    <div class="list-group">
        <div id="subs" class="panel-collapse collapse">
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-init%7E9">init</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-save_results">save_results</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_ab">test_ab</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_abm">test_abm</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_am">test_am</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_bdf">test_bdf</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_emd_rk">test_emd_rk</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_euler">test_euler</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_leapfrog">test_leapfrog</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_ls_rk">test_ls_rk</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_tvd_rk">test_tvd_rk</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-ab_solver">ab_solver</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-abm_solver">abm_solver</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-am_solver">am_solver</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-bdf_solver">bdf_solver</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-emd_rk_solver">emd_rk_solver</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-euler_solver">euler_solver</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-leapfrog_solver">leapfrog_solver</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-ls_rk_solver">ls_rk_solver</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-tvd_rk_solver">tvd_rk_solver</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-perform_errors_analysis">perform_errors_analysis</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html#proc-print_analysis">print_analysis</a>
          
        </div>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
    <div class="list-group">
      <a class="list-group-item" href="../program/integrate_oscillation.html#src">integrate_oscillation</a>
    </div>
  </div>
  
  <hr>
  
  <div class="panel panel-default">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprogs">All Programs</a></h3></div>
    <div id="allprogs" class="panel-collapse collapse">
        <div class="list-group">
          
          <a class="list-group-item" href="../program/integrate_burgers.html">integrate_burgers</a>
          
          <a class="list-group-item" href="../program/integrate_euler_1d.html">integrate_euler_1D</a>
          
          <a class="list-group-item" href="../program/integrate_euler_1d_caf.html">integrate_euler_1D_caf</a>
          
          <a class="list-group-item" href="../program/integrate_euler_1d_caf%7E2.html">integrate_euler_1D_caf</a>
          
          <a class="list-group-item" href="../program/integrate_euler_1d_openmp.html">integrate_euler_1D_openmp</a>
          
          <a class="list-group-item" href="../program/integrate_euler_1d_openmp_no_foodie.html">integrate_euler_1D_openmp_no_foodie</a>
          
          <a class="list-group-item" href="../program/integrate_lorenz.html">integrate_lorenz</a>
          
          <a class="list-group-item" href="../program/integrate_oscillation.html">integrate_oscillation</a>
          
          <a class="list-group-item" href="../program/test.html">test</a>
          
          <a class="list-group-item" href="../program/test_basic.html">test_basic</a>
          
          <a class="list-group-item" href="../program/test_choices_logical.html">test_choices_logical</a>
          
          <a class="list-group-item" href="../program/test_driver.html">Test_Driver</a>
          
          <a class="list-group-item" href="../program/test_driver%7E2.html">Test_Driver</a>
          
          <a class="list-group-item" href="../program/test_nested.html">test_nested</a>
          
          <a class="list-group-item" href="../program/test_string.html">test_string</a>
          
        </div>
    </div>
  </div>
  
</div>

    </div>
    
    <div class="col-lg-9" id='text'>
    
  
    <ul class="list-inline">
      <li><h4>Uses:</h4></li>
      
      <li>IR_Precision</li>
      
      <li><a href='../module/type_oscillation.html'>type_oscillation</a></li>
      
      <li><a href='../module/data_type_command_line_interface.html'>Data_Type_Command_Line_Interface</a></li>
      
      <li><a href='../module/foodie.html'>foodie</a></li>
      
      <li><a href='../module/pyplot_module.html'>pyplot_module</a></li>
      
    </ul>
  

    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: program~~integrate_oscillation~~UsesGraph Pages: 1 -->
<svg id="programintegrate_oscillationUsesGraph" width="641pt" height="248pt"
 viewBox="0.00 0.00 641.00 248.11" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~integrate_oscillation~~UsesGraph" class="graph" transform="scale(0.499221 0.499221) rotate(0) translate(4 493)">
<title>program~~integrate_oscillation~~UsesGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-493 1281,-493 1281,5 -4,5"/>
<!-- program~integrate_oscillation -->
<g id="node1" class="node"><title>program~integrate_oscillation</title>
<polygon fill="none" stroke="black" points="1275,-109 1169,-109 1169,-83 1275,-83 1275,-109"/>
<text text-anchor="middle" x="1222" y="-93.55" font-family="Helvetica,sans-Serif" font-size="10.50">integrate_oscillation</text>
</g>
<!-- module~type_oscillation -->
<g id="node2" class="node"><title>module~type_oscillation</title>
<a xlink:href="../module/type_oscillation.html" xlink:title="type_oscillation">
<polygon fill="#337ab7" stroke="#337ab7" points="1076,-130 992,-130 992,-104 1076,-104 1076,-130"/>
<text text-anchor="middle" x="1034" y="-114.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">type_oscillation</text>
</a>
</g>
<!-- module~type_oscillation&#45;&gt;program~integrate_oscillation -->
<g id="edge76" class="edge"><title>module~type_oscillation&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1076.66,-112.235C1100.77,-109.541 1131.39,-106.122 1158.29,-103.116"/>
<polygon fill="black" stroke="black" points="1158.85,-106.576 1168.4,-101.987 1158.07,-99.6191 1158.85,-106.576"/>
</g>
<!-- module~pyplot_module -->
<g id="node3" class="node"><title>module~pyplot_module</title>
<a xlink:href="../module/pyplot_module.html" xlink:title="pyplot_module">
<polygon fill="#337ab7" stroke="#337ab7" points="900,-110 818,-110 818,-84 900,-84 900,-110"/>
<text text-anchor="middle" x="859" y="-94.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pyplot_module</text>
</a>
</g>
<!-- module~pyplot_module&#45;&gt;program~integrate_oscillation -->
<g id="edge78" class="edge"><title>module~pyplot_module&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M900.239,-87.9303C935.619,-81.1391 988.019,-73.4293 1034,-76"/>
</g>
<!-- IR_Precision -->
<g id="node4" class="node"><title>IR_Precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="895,-66 823,-66 823,-40 895,-40 895,-66"/>
<text text-anchor="middle" x="859" y="-50.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">IR_Precision</text>
</g>
<!-- IR_Precision&#45;&gt;program~integrate_oscillation -->
<g id="edge80" class="edge"><title>IR_Precision&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M895.721,-59.4538C931.028,-65.2723 985.965,-73.3145 1034,-76"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1034,-76C1075.49,-78.3195 1121.92,-83.236 1158.26,-87.6136"/>
<polygon fill="black" stroke="black" points="1157.88,-91.093 1168.23,-88.8315 1158.72,-84.1446 1157.88,-91.093"/>
</g>
<!-- IR_Precision&#45;&gt;module~type_oscillation -->
<g id="edge4" class="edge"><title>IR_Precision&#45;&gt;module~type_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M883.476,-66.1514C898.37,-73.8013 917.944,-83.2369 936,-90 950.368,-95.3817 966.279,-100.222 981.029,-104.268"/>
<polygon fill="black" stroke="black" points="980.456,-107.738 991.021,-106.939 982.264,-100.975 980.456,-107.738"/>
</g>
<!-- module~data_type_command_line_interface -->
<g id="node6" class="node"><title>module~data_type_command_line_interface</title>
<a xlink:href="../module/data_type_command_line_interface.html" xlink:title="Data_Type_Command_Line_Interface">
<polygon fill="#337ab7" stroke="#337ab7" points="1131,-48 937,-48 937,-22 1131,-22 1131,-48"/>
<text text-anchor="middle" x="1034" y="-32.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Data_Type_Command_Line_Interface</text>
</a>
</g>
<!-- IR_Precision&#45;&gt;module~data_type_command_line_interface -->
<g id="edge74" class="edge"><title>IR_Precision&#45;&gt;module~data_type_command_line_interface</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M895.686,-49.2266C904.971,-48.2716 915.424,-47.1964 926.319,-46.0758"/>
<polygon fill="black" stroke="black" points="926.838,-49.541 936.427,-45.0361 926.122,-42.5777 926.838,-49.541"/>
</g>
<!-- module~foodie -->
<g id="node5" class="node"><title>module~foodie</title>
<a xlink:href="../module/foodie.html" xlink:title="foodie">
<polygon fill="#337ab7" stroke="#337ab7" points="886,-154 832,-154 832,-128 886,-128 886,-154"/>
<text text-anchor="middle" x="859" y="-138.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie</text>
</a>
</g>
<!-- module~foodie&#45;&gt;program~integrate_oscillation -->
<g id="edge82" class="edge"><title>module~foodie&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M886.19,-144.657C935.804,-150.484 1044.02,-159.278 1132,-139 1153.36,-134.078 1175.59,-123.513 1192.62,-114.087"/>
<polygon fill="black" stroke="black" points="1194.56,-117.011 1201.51,-109.011 1191.09,-110.933 1194.56,-117.011"/>
</g>
<!-- module~foodie&#45;&gt;module~type_oscillation -->
<g id="edge2" class="edge"><title>module~foodie&#45;&gt;module~type_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M886.344,-137.25C911.563,-133.791 949.704,-128.561 980.904,-124.282"/>
<polygon fill="black" stroke="black" points="981.758,-127.697 991.19,-122.871 980.807,-120.762 981.758,-127.697"/>
</g>
<!-- module~data_type_command_line_interface&#45;&gt;program~integrate_oscillation -->
<g id="edge84" class="edge"><title>module~data_type_command_line_interface&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1084.88,-48.0583C1100.12,-52.2275 1116.81,-57.0515 1132,-62 1147.89,-67.1792 1165.11,-73.5051 1180.2,-79.2896"/>
<polygon fill="black" stroke="black" points="1179.17,-82.6469 1189.76,-82.9952 1181.7,-76.1195 1179.17,-82.6469"/>
</g>
<!-- iso_fortran_env -->
<g id="node9" class="node"><title>iso_fortran_env</title>
<a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="432,-26 346,-26 346,-1.24345e-14 432,-3.55271e-15 432,-26"/>
<text text-anchor="middle" x="389" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
<!-- iso_fortran_env&#45;&gt;module~pyplot_module -->
<g id="edge6" class="edge"><title>iso_fortran_env&#45;&gt;module~pyplot_module</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M668,-12C719.388,-17.555 737.107,-9.38337 782,-35 802.774,-46.8537 799.182,-60.2371 818,-75 819.525,-76.1967 821.125,-77.3623 822.772,-78.4923"/>
<polygon fill="black" stroke="black" points="820.939,-81.4742 831.27,-83.8225 824.658,-75.544 820.939,-81.4742"/>
</g>
<!-- iso_fortran_env&#45;&gt;module~data_type_command_line_interface -->
<g id="edge72" class="edge"><title>iso_fortran_env&#45;&gt;module~data_type_command_line_interface</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M432.649,-9.85557C487.697,-6.57542 585.17,-3.0461 668,-12"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M668,-12C754.601,-21.3615 853.174,-27.2861 926.187,-30.7735"/>
<polygon fill="black" stroke="black" points="926.163,-34.2761 936.316,-31.2495 926.492,-27.2838 926.163,-34.2761"/>
</g>
<!-- module~foodie_integrator_low_storage_runge_kutta -->
<g id="node13" class="node"><title>module~foodie_integrator_low_storage_runge_kutta</title>
<a xlink:href="../module/foodie_integrator_low_storage_runge_kutta.html" xlink:title="foodie_integrator_low_storage_runge_kutta">
<polygon fill="#337ab7" stroke="#337ab7" points="778,-70 558,-70 558,-44 778,-44 778,-70"/>
<text text-anchor="middle" x="668" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_low_storage_runge_kutta</text>
</a>
</g>
<!-- iso_fortran_env&#45;&gt;module~foodie_integrator_low_storage_runge_kutta -->
<g id="edge16" class="edge"><title>iso_fortran_env&#45;&gt;module~foodie_integrator_low_storage_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M432.594,-19.875C470.654,-25.8773 527.174,-34.7908 575.292,-42.3794"/>
<polygon fill="black" stroke="black" points="575,-45.8765 585.423,-43.9771 576.091,-38.962 575,-45.8765"/>
</g>
<!-- module~foodie_integrator_euler_explicit -->
<g id="node11" class="node"><title>module~foodie_integrator_euler_explicit</title>
<a xlink:href="../module/foodie_integrator_euler_explicit.html" xlink:title="foodie_integrator_euler_explicit">
<polygon fill="#337ab7" stroke="#337ab7" points="470,-401 308,-401 308,-375 470,-375 470,-401"/>
<text text-anchor="middle" x="389" y="-385.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_euler_explicit</text>
</a>
</g>
<!-- module~foodie_integrator_euler_explicit&#45;&gt;module~foodie -->
<g id="edge52" class="edge"><title>module~foodie_integrator_euler_explicit&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M470.157,-377.075C486.166,-374.104 502.73,-370.445 518,-366 587.426,-345.79 601.944,-332.411 668,-303"/>
</g>
<!-- module~foodie_integrator_adams_bashforth -->
<g id="node12" class="node"><title>module~foodie_integrator_adams_bashforth</title>
<a xlink:href="../module/foodie_integrator_adams_bashforth.html" xlink:title="foodie_integrator_adams_bashforth">
<polygon fill="#337ab7" stroke="#337ab7" points="480,-275 298,-275 298,-249 480,-249 480,-275"/>
<text text-anchor="middle" x="389" y="-259.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_adams_bashforth</text>
</a>
</g>
<!-- module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie -->
<g id="edge54" class="edge"><title>module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M452.86,-275.046C529.087,-290.049 648.74,-311.575 668,-303"/>
</g>
<!-- module~foodie_integrator_adams_bashforth_moulton -->
<g id="node16" class="node"><title>module~foodie_integrator_adams_bashforth_moulton</title>
<a xlink:href="../module/foodie_integrator_adams_bashforth_moulton.html" xlink:title="foodie_integrator_adams_bashforth_moulton">
<polygon fill="#337ab7" stroke="#337ab7" points="781,-154 555,-154 555,-128 781,-128 781,-154"/>
<text text-anchor="middle" x="668" y="-138.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_adams_bashforth_moulton</text>
</a>
</g>
<!-- module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie_integrator_adams_bashforth_moulton -->
<g id="edge36" class="edge"><title>module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie_integrator_adams_bashforth_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M472.866,-248.95C488.168,-245.31 503.781,-240.73 518,-235 565.533,-215.846 614.785,-181.762 643.349,-160.325"/>
<polygon fill="black" stroke="black" points="645.683,-162.947 651.525,-154.109 641.446,-157.375 645.683,-162.947"/>
</g>
<!-- module~foodie_integrator_low_storage_runge_kutta&#45;&gt;module~foodie -->
<g id="edge56" class="edge"><title>module~foodie_integrator_low_storage_runge_kutta&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M744.559,-70.0064C757.494,-73.8141 770.457,-78.7113 782,-85 801.326,-95.5287 800.148,-106.129 818,-119 819.622,-120.169 821.313,-121.318 823.046,-122.439"/>
<polygon fill="black" stroke="black" points="821.545,-125.622 831.917,-127.785 825.158,-119.626 821.545,-125.622"/>
</g>
<!-- module~foodie_integrator_tvd_runge_kutta -->
<g id="node14" class="node"><title>module~foodie_integrator_tvd_runge_kutta</title>
<a xlink:href="../module/foodie_integrator_tvd_runge_kutta.html" xlink:title="foodie_integrator_tvd_runge_kutta">
<polygon fill="#337ab7" stroke="#337ab7" points="477,-357 301,-357 301,-331 477,-331 477,-357"/>
<text text-anchor="middle" x="389" y="-341.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_tvd_runge_kutta</text>
</a>
</g>
<!-- module~foodie_integrator_tvd_runge_kutta&#45;&gt;module~foodie -->
<g id="edge58" class="edge"><title>module~foodie_integrator_tvd_runge_kutta&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M477.549,-343.141C534.161,-339.704 607.957,-329.734 668,-303"/>
</g>
<!-- module~foodie_integrator_emd_runge_kutta -->
<g id="node15" class="node"><title>module~foodie_integrator_emd_runge_kutta</title>
<a xlink:href="../module/foodie_integrator_emd_runge_kutta.html" xlink:title="foodie_integrator_emd_runge_kutta">
<polygon fill="#337ab7" stroke="#337ab7" points="481,-193 297,-193 297,-167 481,-167 481,-193"/>
<text text-anchor="middle" x="389" y="-177.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_emd_runge_kutta</text>
</a>
</g>
<!-- module~foodie_integrator_emd_runge_kutta&#45;&gt;module~foodie -->
<g id="edge60" class="edge"><title>module~foodie_integrator_emd_runge_kutta&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417.069,-193.028C486.622,-225.225 661.804,-305.759 668,-303"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M668,-303C742.65,-269.762 810.631,-198.019 841.504,-162.218"/>
<polygon fill="black" stroke="black" points="844.391,-164.226 848.198,-154.339 839.056,-159.694 844.391,-164.226"/>
</g>
<!-- module~foodie_integrator_adams_bashforth_moulton&#45;&gt;module~foodie -->
<g id="edge62" class="edge"><title>module~foodie_integrator_adams_bashforth_moulton&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M781.588,-141C795.94,-141 809.727,-141 821.586,-141"/>
<polygon fill="black" stroke="black" points="821.897,-144.5 831.897,-141 821.896,-137.5 821.897,-144.5"/>
</g>
<!-- module~foodie_integrator_backward_differentiation_formula -->
<g id="node17" class="node"><title>module~foodie_integrator_backward_differentiation_formula</title>
<a xlink:href="../module/foodie_integrator_backward_differentiation_formula.html" xlink:title="foodie_integrator_backward_differentiation_formula">
<polygon fill="#337ab7" stroke="#337ab7" points="518,-489 260,-489 260,-463 518,-463 518,-489"/>
<text text-anchor="middle" x="389" y="-473.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_backward_differentiation_formula</text>
</a>
</g>
<!-- module~foodie_integrator_backward_differentiation_formula&#45;&gt;module~foodie -->
<g id="edge64" class="edge"><title>module~foodie_integrator_backward_differentiation_formula&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M496.643,-462.978C504.049,-460.472 511.245,-457.507 518,-454 601.957,-410.417 581.583,-341.477 668,-303"/>
</g>
<!-- module~foodie_integrator_adams_moulton -->
<g id="node18" class="node"><title>module~foodie_integrator_adams_moulton</title>
<a xlink:href="../module/foodie_integrator_adams_moulton.html" xlink:title="foodie_integrator_adams_moulton">
<polygon fill="#337ab7" stroke="#337ab7" points="477,-111 301,-111 301,-85 477,-85 477,-111"/>
<text text-anchor="middle" x="389" y="-95.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_adams_moulton</text>
</a>
</g>
<!-- module~foodie_integrator_adams_moulton&#45;&gt;module~foodie -->
<g id="edge66" class="edge"><title>module~foodie_integrator_adams_moulton&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M477.027,-97.072C557.083,-97.5585 678.221,-101.63 782,-119 795.308,-121.228 809.593,-124.928 822.201,-128.665"/>
<polygon fill="black" stroke="black" points="821.316,-132.054 831.902,-131.642 823.369,-125.362 821.316,-132.054"/>
</g>
<!-- module~foodie_integrator_adams_moulton&#45;&gt;module~foodie_integrator_adams_bashforth_moulton -->
<g id="edge30" class="edge"><title>module~foodie_integrator_adams_moulton&#45;&gt;module~foodie_integrator_adams_bashforth_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M473.466,-111.018C505.007,-115.879 541.018,-121.429 573.411,-126.422"/>
<polygon fill="black" stroke="black" points="572.923,-129.888 583.34,-127.952 573.99,-122.97 572.923,-129.888"/>
</g>
<!-- module~foodie_adt_integrand -->
<g id="node19" class="node"><title>module~foodie_adt_integrand</title>
<a xlink:href="../module/foodie_adt_integrand.html" xlink:title="foodie_adt_integrand">
<polygon fill="#337ab7" stroke="#337ab7" points="224,-275 110,-275 110,-249 224,-249 224,-275"/>
<text text-anchor="middle" x="167" y="-259.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_adt_integrand</text>
</a>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie -->
<g id="edge68" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M214.467,-275.022C228.975,-278.516 245.048,-281.902 260,-284 349.884,-296.613 585.083,-339.919 668,-303"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_euler_explicit -->
<g id="edge10" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_euler_explicit</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M174.544,-275.091C188.339,-297.72 219.936,-343.85 260,-366 271.566,-372.395 284.537,-377.019 297.676,-380.348"/>
<polygon fill="black" stroke="black" points="297.208,-383.831 307.737,-382.648 298.769,-377.007 297.208,-383.831"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_bashforth -->
<g id="edge14" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_bashforth</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224.171,-262C243.357,-262 265.375,-262 286.94,-262"/>
<polygon fill="black" stroke="black" points="287.139,-265.5 297.139,-262 287.139,-258.5 287.139,-265.5"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_low_storage_runge_kutta -->
<g id="edge18" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_low_storage_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M174.213,-248.674C185.224,-228.23 206.76,-187.833 224,-153 240.757,-119.142 229.695,-98.5561 260,-76 306.488,-41.3985 333.417,-73.4003 389,-57"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_tvd_runge_kutta -->
<g id="edge24" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_tvd_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M184.962,-275.057C203.054,-287.606 232.195,-306.209 260,-317 271.614,-321.507 284.122,-325.318 296.62,-328.526"/>
<polygon fill="black" stroke="black" points="296.078,-331.997 306.623,-330.971 297.74,-325.197 296.078,-331.997"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_emd_runge_kutta -->
<g id="edge28" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_emd_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M184.962,-248.943C203.054,-236.394 232.195,-217.791 260,-207 271.614,-202.493 284.122,-198.682 296.62,-195.474"/>
<polygon fill="black" stroke="black" points="297.74,-198.803 306.623,-193.029 296.078,-192.003 297.74,-198.803"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_bashforth_moulton -->
<g id="edge34" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_bashforth_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218.481,-248.988C231.944,-245.814 246.475,-242.591 260,-240 373.834,-218.195 406.18,-232.495 518,-202 558.381,-190.988 602.529,-172.152 632.403,-158.317"/>
<polygon fill="black" stroke="black" points="634.008,-161.43 641.578,-154.017 631.038,-155.092 634.008,-161.43"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_backward_differentiation_formula -->
<g id="edge40" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_backward_differentiation_formula</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M172.532,-275.136C190.068,-316.516 244.195,-442.126 260,-454 261.845,-455.386 263.746,-456.697 265.697,-457.936"/>
<polygon fill="black" stroke="black" points="264.113,-461.06 274.543,-462.922 267.55,-454.962 264.113,-461.06"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_moulton -->
<g id="edge44" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M175.942,-248.946C191.118,-227.58 223.817,-184.842 260,-158 284.626,-139.731 315.703,-125.071 341.184,-114.816"/>
<polygon fill="black" stroke="black" points="342.619,-118.013 350.65,-111.103 340.063,-111.496 342.619,-118.013"/>
</g>
<!-- module~foodie_integrator_leapfrog -->
<g id="node20" class="node"><title>module~foodie_integrator_leapfrog</title>
<a xlink:href="../module/foodie_integrator_leapfrog.html" xlink:title="foodie_integrator_leapfrog">
<polygon fill="#337ab7" stroke="#337ab7" points="458,-445 320,-445 320,-419 458,-419 458,-445"/>
<text text-anchor="middle" x="389" y="-429.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_leapfrog</text>
</a>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_leapfrog -->
<g id="edge50" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_leapfrog</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M171.161,-275.305C181.164,-304.909 209.546,-376.266 260,-410 274.525,-419.711 291.965,-425.573 309.258,-429.022"/>
<polygon fill="black" stroke="black" points="308.948,-432.521 319.399,-430.785 310.147,-425.624 308.948,-432.521"/>
</g>
<!-- module~foodie_integrator_leapfrog&#45;&gt;module~foodie -->
<g id="edge70" class="edge"><title>module~foodie_integrator_leapfrog&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M458.567,-425.989C478.291,-422.736 499.436,-417.724 518,-410 593.607,-378.543 593.19,-336.309 668,-303"/>
</g>
<!-- module~foodie_kinds -->
<g id="node21" class="node"><title>module~foodie_kinds</title>
<a xlink:href="../module/foodie_kinds.html" xlink:title="foodie_kinds">
<polygon fill="#337ab7" stroke="#337ab7" points="73,-275 1,-275 1,-249 73,-249 73,-275"/>
<text text-anchor="middle" x="37" y="-259.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_kinds</text>
</a>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_euler_explicit -->
<g id="edge8" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_euler_explicit</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-410C179.108,-415.48 242.051,-408.759 297.837,-401.346"/>
<polygon fill="black" stroke="black" points="298.352,-404.808 307.796,-400.005 297.418,-397.871 298.352,-404.808"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth -->
<g id="edge12" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-139C213.717,-121.394 216.561,-177.394 260,-202 288.49,-218.138 322.065,-233.651 347.819,-244.86"/>
<polygon fill="black" stroke="black" points="346.711,-248.193 357.28,-248.937 349.482,-241.765 346.711,-248.193"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_low_storage_runge_kutta -->
<g id="edge20" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_low_storage_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M45.4274,-248.909C63.6791,-221.954 109.861,-160.946 167,-139"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-139C213.605,-121.1 213.469,-94.0917 260,-76 314.013,-54.9993 333.417,-73.4003 389,-57"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389,-57C445.52,-40.3233 511.33,-39.4972 564.836,-43.2226"/>
<polygon fill="black" stroke="black" points="564.786,-46.7288 575.022,-43.9966 565.316,-39.7489 564.786,-46.7288"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_tvd_runge_kutta -->
<g id="edge22" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_tvd_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43.5117,-275.175C59.5084,-305.835 104.064,-381.514 167,-410"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-410C208.658,-428.855 216.39,-379.749 260,-366 269.77,-362.92 280.1,-360.242 290.49,-357.921"/>
<polygon fill="black" stroke="black" points="291.4,-361.306 300.454,-355.803 289.945,-354.458 291.4,-361.306"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_emd_runge_kutta -->
<g id="edge26" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_emd_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-139C174.144,-136.308 254.843,-152.084 316.906,-164.843"/>
<polygon fill="black" stroke="black" points="316.581,-168.349 327.082,-166.942 317.995,-161.493 316.581,-168.349"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth_moulton -->
<g id="edge32" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-139C233.418,-113.969 418.773,-121.667 544.421,-130.536"/>
<polygon fill="black" stroke="black" points="544.269,-134.034 554.494,-131.258 544.77,-127.052 544.269,-134.034"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_backward_differentiation_formula -->
<g id="edge38" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_backward_differentiation_formula</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-410C208.658,-428.855 216.39,-440.251 260,-454 267.943,-456.504 276.256,-458.742 284.67,-460.739"/>
<polygon fill="black" stroke="black" points="284.053,-464.188 294.578,-462.974 285.593,-457.359 284.053,-464.188"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_moulton -->
<g id="edge42" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-139C206.221,-124.219 251.414,-114.632 290.745,-108.48"/>
<polygon fill="black" stroke="black" points="291.51,-111.904 300.875,-106.95 290.465,-104.982 291.51,-111.904"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_adt_integrand -->
<g id="edge46" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_adt_integrand</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M73.5582,-262C81.7428,-262 90.6769,-262 99.6705,-262"/>
<polygon fill="black" stroke="black" points="99.8131,-265.5 109.813,-262 99.8131,-258.5 99.8131,-265.5"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_leapfrog -->
<g id="edge48" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_leapfrog</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-410C211.274,-430.039 265.479,-435.719 309.245,-436.302"/>
<polygon fill="black" stroke="black" points="309.256,-439.802 319.273,-436.35 309.289,-432.803 309.256,-439.802"/>
</g>
</g>
</svg>
</div>
                <script>var panprogramintegrate_oscillationUsesGraph = svgPanZoom('#programintegrate_oscillationUsesGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
    <br><br>
    <p>Test FOODIE with the integration of Oscillation equations.</p>
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: program~~integrate_oscillation~~CallsGraph Pages: 1 -->
<svg id="programintegrate_oscillationCallsGraph" width="586pt" height="910pt"
 viewBox="0.00 0.00 586.00 909.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~integrate_oscillation~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 905.798)">
<title>program~~integrate_oscillation~~CallsGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-905.798 583,-905.798 583,5 -4,5"/>
<!-- program~integrate_oscillation -->
<g id="node1" class="node"><title>program~integrate_oscillation</title>
<polygon fill="none" stroke="black" points="107,-678 1,-678 1,-652 107,-652 107,-678"/>
<text text-anchor="middle" x="54" y="-662.55" font-family="Helvetica,sans-Serif" font-size="10.50">integrate_oscillation</text>
</g>
<!-- proc~test_am -->
<g id="node2" class="node"><title>proc~test_am</title>
<a xlink:href="../proc/test_am.html" xlink:title="test_am">
<polygon fill="#d9534f" stroke="#d9534f" points="236,-744 182,-744 182,-718 236,-718 236,-744"/>
<text text-anchor="middle" x="209" y="-728.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_am</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_am -->
<g id="edge132" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_am</title>
<path fill="none" stroke="black" d="M78.4398,-678.008C96.324,-687.265 121.323,-699.664 144,-709 152.98,-712.697 162.832,-716.27 172.09,-719.424"/>
<polygon fill="black" stroke="black" points="171.239,-722.829 181.833,-722.667 173.45,-716.188 171.239,-722.829"/>
</g>
<!-- proc~test_tvd_rk -->
<g id="node3" class="node"><title>proc~test_tvd_rk</title>
<a xlink:href="../proc/test_tvd_rk.html" xlink:title="test_tvd_rk">
<polygon fill="#d9534f" stroke="#d9534f" points="241,-612 177,-612 177,-586 241,-586 241,-612"/>
<text text-anchor="middle" x="209" y="-596.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_tvd_rk</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_tvd_rk -->
<g id="edge134" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_tvd_rk</title>
<path fill="none" stroke="black" d="M78.4398,-651.992C96.324,-642.735 121.323,-630.336 144,-621 151.281,-618.002 159.135,-615.086 166.781,-612.409"/>
<polygon fill="black" stroke="black" points="167.965,-615.704 176.296,-609.158 165.701,-609.08 167.965,-615.704"/>
</g>
<!-- proc~test_emd_rk -->
<g id="node4" class="node"><title>proc~test_emd_rk</title>
<a xlink:href="../proc/test_emd_rk.html" xlink:title="test_emd_rk">
<polygon fill="#d9534f" stroke="#d9534f" points="245,-656 173,-656 173,-630 245,-630 245,-656"/>
<text text-anchor="middle" x="209" y="-640.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_emd_rk</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_emd_rk -->
<g id="edge136" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_emd_rk</title>
<path fill="none" stroke="black" d="M107.776,-657.367C125.589,-654.839 145.252,-652.048 162.473,-649.604"/>
<polygon fill="black" stroke="black" points="163.432,-653.003 172.841,-648.132 162.449,-646.072 163.432,-653.003"/>
</g>
<!-- proc~test_ls_rk -->
<g id="node5" class="node"><title>proc~test_ls_rk</title>
<a xlink:href="../proc/test_ls_rk.html" xlink:title="test_ls_rk">
<polygon fill="#d9534f" stroke="#d9534f" points="238,-832 180,-832 180,-806 238,-806 238,-832"/>
<text text-anchor="middle" x="209" y="-816.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_ls_rk</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_ls_rk -->
<g id="edge138" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_ls_rk</title>
<path fill="none" stroke="black" d="M59.5572,-678.342C71.2513,-704.826 100.922,-764.295 144,-797 151.665,-802.819 160.965,-807.157 170.105,-810.368"/>
<polygon fill="black" stroke="black" points="169.285,-813.779 179.874,-813.427 171.377,-807.099 169.285,-813.779"/>
</g>
<!-- proc~test_euler -->
<g id="node6" class="node"><title>proc~test_euler</title>
<a xlink:href="../proc/test_euler.html" xlink:title="test_euler">
<polygon fill="#d9534f" stroke="#d9534f" points="239,-876 179,-876 179,-850 239,-850 239,-876"/>
<text text-anchor="middle" x="209" y="-860.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_euler</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_euler -->
<g id="edge140" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_euler</title>
<path fill="none" stroke="black" d="M57.0723,-678.172C65.3214,-710.651 91.0086,-795.247 144,-841 151.152,-847.175 160.111,-851.636 169.072,-854.851"/>
<polygon fill="black" stroke="black" points="168.121,-858.221 178.71,-857.874 170.216,-851.542 168.121,-858.221"/>
</g>
<!-- proc~test_leapfrog -->
<g id="node7" class="node"><title>proc~test_leapfrog</title>
<a xlink:href="../proc/test_leapfrog.html" xlink:title="test_leapfrog">
<polygon fill="#d9534f" stroke="#d9534f" points="246,-568 172,-568 172,-542 246,-542 246,-568"/>
<text text-anchor="middle" x="209" y="-552.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_leapfrog</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_leapfrog -->
<g id="edge142" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_leapfrog</title>
<path fill="none" stroke="black" d="M64.2215,-651.776C79.5976,-632.719 110.471,-597.569 144,-577 149.465,-573.648 155.504,-570.733 161.635,-568.219"/>
<polygon fill="black" stroke="black" points="163.147,-571.39 171.275,-564.595 160.683,-564.838 163.147,-571.39"/>
</g>
<!-- proc~test_bdf -->
<g id="node8" class="node"><title>proc~test_bdf</title>
<a xlink:href="../proc/test_bdf.html" xlink:title="test_bdf">
<polygon fill="#d9534f" stroke="#d9534f" points="236,-700 182,-700 182,-674 236,-674 236,-700"/>
<text text-anchor="middle" x="209" y="-684.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_bdf</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_bdf -->
<g id="edge144" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_bdf</title>
<path fill="none" stroke="black" d="M107.776,-672.633C128.876,-675.628 152.572,-678.991 171.73,-681.71"/>
<polygon fill="black" stroke="black" points="171.468,-685.208 181.861,-683.148 172.452,-678.277 171.468,-685.208"/>
</g>
<!-- proc~test_abm -->
<g id="node9" class="node"><title>proc~test_abm</title>
<a xlink:href="../proc/test_abm.html" xlink:title="test_abm">
<polygon fill="#d9534f" stroke="#d9534f" points="237,-524 181,-524 181,-498 237,-498 237,-524"/>
<text text-anchor="middle" x="209" y="-508.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_abm</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_abm -->
<g id="edge146" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_abm</title>
<path fill="none" stroke="black" d="M59.5572,-651.658C71.2513,-625.174 100.922,-565.705 144,-533 151.817,-527.065 161.334,-522.672 170.648,-519.442"/>
<polygon fill="black" stroke="black" points="171.684,-522.785 180.2,-516.482 169.613,-516.099 171.684,-522.785"/>
</g>
<!-- proc~perform_errors_analysis -->
<g id="node10" class="node"><title>proc~perform_errors_analysis</title>
<a xlink:href="../proc/perform_errors_analysis.html" xlink:title="perform_errors_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="273,-328 145,-328 145,-302 273,-302 273,-328"/>
<text text-anchor="middle" x="209" y="-312.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">perform_errors_analysis</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~perform_errors_analysis -->
<g id="edge148" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~perform_errors_analysis</title>
<path fill="none" stroke="black" d="M59.8869,-651.707C83.2404,-598.973 169.52,-404.149 199.028,-337.518"/>
<polygon fill="black" stroke="black" points="202.258,-338.867 203.107,-328.306 195.858,-336.033 202.258,-338.867"/>
</g>
<!-- proc~test_ab -->
<g id="node11" class="node"><title>proc~test_ab</title>
<a xlink:href="../proc/test_ab.html" xlink:title="test_ab">
<polygon fill="#d9534f" stroke="#d9534f" points="236,-788 182,-788 182,-762 236,-762 236,-788"/>
<text text-anchor="middle" x="209" y="-772.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_ab</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_ab -->
<g id="edge150" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_ab</title>
<path fill="none" stroke="black" d="M64.2215,-678.224C79.5976,-697.281 110.471,-732.431 144,-753 152.592,-758.271 162.605,-762.461 172.161,-765.709"/>
<polygon fill="black" stroke="black" points="171.286,-769.102 181.875,-768.758 173.382,-762.424 171.286,-769.102"/>
</g>
<!-- str -->
<g id="node12" class="node"><title>str</title>
<polygon fill="#777777" stroke="#777777" points="534,-703 480,-703 480,-677 534,-677 534,-703"/>
<text text-anchor="middle" x="507" y="-687.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">str</text>
</g>
<!-- proc~test_am&#45;&gt;str -->
<g id="edge12" class="edge"><title>proc~test_am&#45;&gt;str</title>
<path fill="none" stroke="black" d="M236.241,-735.483C248.835,-738.666 263.329,-744.032 274,-753 299.579,-774.497 281.268,-801.944 310,-819 344.396,-839.419 367.518,-842.343 400,-819 440.745,-789.719 400.096,-747.049 436,-712 445.09,-703.126 457.687,-697.824 469.75,-694.659"/>
<polygon fill="black" stroke="black" points="470.658,-698.043 479.669,-692.471 469.15,-691.207 470.658,-698.043"/>
</g>
<!-- proc~save_results -->
<g id="node13" class="node"><title>proc~save_results</title>
<a xlink:href="../proc/save_results.html" xlink:title="save_results">
<polygon fill="#d9534f" stroke="#d9534f" points="391,-662 319,-662 319,-636 391,-636 391,-662"/>
<text text-anchor="middle" x="355" y="-646.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_results</text>
</a>
</g>
<!-- proc~test_am&#45;&gt;proc~save_results -->
<g id="edge14" class="edge"><title>proc~test_am&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M236.02,-723.916C248.009,-720.258 262.071,-715.24 274,-709 295.196,-697.912 316.849,-681.56 332.429,-668.725"/>
<polygon fill="black" stroke="black" points="335.013,-671.125 340.418,-662.013 330.51,-665.766 335.013,-671.125"/>
</g>
<!-- proc~init~9 -->
<g id="node14" class="node"><title>proc~init~9</title>
<a xlink:href="../proc/init%7E9.html" xlink:title="init">
<polygon fill="#d9534f" stroke="#d9534f" points="382,-744 328,-744 328,-718 382,-718 382,-744"/>
<text text-anchor="middle" x="355" y="-728.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init</text>
</a>
</g>
<!-- proc~test_am&#45;&gt;proc~init~9 -->
<g id="edge16" class="edge"><title>proc~test_am&#45;&gt;proc~init~9</title>
<path fill="none" stroke="black" d="M236.119,-731C259.023,-731 292.059,-731 317.496,-731"/>
<polygon fill="black" stroke="black" points="317.531,-734.5 327.53,-731 317.53,-727.5 317.531,-734.5"/>
</g>
<!-- proc~am_solver -->
<g id="node15" class="node"><title>proc~am_solver</title>
<a xlink:href="../proc/am_solver.html" xlink:title="am_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="386,-416 324,-416 324,-390 386,-390 386,-416"/>
<text text-anchor="middle" x="355" y="-400.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">am_solver</text>
</a>
</g>
<!-- proc~test_am&#45;&gt;proc~am_solver -->
<g id="edge18" class="edge"><title>proc~test_am&#45;&gt;proc~am_solver</title>
<path fill="none" stroke="black" d="M236.223,-728.477C249.608,-725.777 264.801,-720.253 274,-709 354.522,-610.49 235.962,-528.472 310,-425 311.55,-422.834 313.373,-420.872 315.381,-419.095"/>
<polygon fill="black" stroke="black" points="317.7,-421.743 323.864,-413.125 313.671,-416.018 317.7,-421.743"/>
</g>
<!-- proc~test_tvd_rk&#45;&gt;str -->
<g id="edge22" class="edge"><title>proc~test_tvd_rk&#45;&gt;str</title>
<path fill="none" stroke="black" d="M241.676,-599.98C280.453,-602.001 346.582,-608.173 400,-627 429.709,-637.471 460.364,-656.514 481.206,-670.932"/>
<polygon fill="black" stroke="black" points="479.317,-673.883 489.506,-676.79 483.354,-668.164 479.317,-673.883"/>
</g>
<!-- proc~test_tvd_rk&#45;&gt;proc~save_results -->
<g id="edge24" class="edge"><title>proc~test_tvd_rk&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M241.748,-610.038C252.072,-613.53 263.517,-617.414 274,-621 285.215,-624.836 297.294,-628.997 308.613,-632.907"/>
<polygon fill="black" stroke="black" points="307.729,-636.305 318.324,-636.266 310.017,-629.689 307.729,-636.305"/>
</g>
<!-- proc~test_tvd_rk&#45;&gt;proc~init~9 -->
<g id="edge26" class="edge"><title>proc~test_tvd_rk&#45;&gt;proc~init~9</title>
<path fill="none" stroke="black" d="M241.654,-605.763C252.646,-609.11 264.516,-613.989 274,-621 296.02,-637.277 293.784,-648.935 310,-671 319.462,-683.876 330.194,-698.195 338.803,-709.615"/>
<polygon fill="black" stroke="black" points="336.097,-711.839 344.916,-717.71 341.683,-707.621 336.097,-711.839"/>
</g>
<!-- proc~tvd_rk_solver -->
<g id="node28" class="node"><title>proc~tvd_rk_solver</title>
<a xlink:href="../proc/tvd_rk_solver.html" xlink:title="tvd_rk_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="393,-284 317,-284 317,-258 393,-258 393,-284"/>
<text text-anchor="middle" x="355" y="-268.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tvd_rk_solver</text>
</a>
</g>
<!-- proc~test_tvd_rk&#45;&gt;proc~tvd_rk_solver -->
<g id="edge28" class="edge"><title>proc~test_tvd_rk&#45;&gt;proc~tvd_rk_solver</title>
<path fill="none" stroke="black" d="M241.565,-595.263C253.49,-592.23 266.008,-586.778 274,-577 354.522,-478.49 235.962,-396.472 310,-293 310.455,-292.364 310.934,-291.745 311.435,-291.143"/>
<polygon fill="black" stroke="black" points="313.953,-293.582 318.963,-284.247 309.225,-288.42 313.953,-293.582"/>
</g>
<!-- proc~test_emd_rk&#45;&gt;str -->
<g id="edge32" class="edge"><title>proc~test_emd_rk&#45;&gt;str</title>
<path fill="none" stroke="black" d="M245.107,-654.658C264.211,-660.405 288.173,-666.954 310,-671 365.048,-681.204 429.829,-686.116 469.652,-688.339"/>
<polygon fill="black" stroke="black" points="469.534,-691.837 479.705,-688.872 469.905,-684.847 469.534,-691.837"/>
</g>
<!-- proc~test_emd_rk&#45;&gt;proc~save_results -->
<g id="edge34" class="edge"><title>proc~test_emd_rk&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M245.09,-644.483C264.161,-645.267 287.793,-646.238 308.251,-647.079"/>
<polygon fill="black" stroke="black" points="308.176,-650.579 318.311,-647.492 308.463,-643.584 308.176,-650.579"/>
</g>
<!-- proc~test_emd_rk&#45;&gt;proc~init~9 -->
<g id="edge36" class="edge"><title>proc~test_emd_rk&#45;&gt;proc~init~9</title>
<path fill="none" stroke="black" d="M245.216,-651.725C255.015,-655.007 265.307,-659.356 274,-665 293.785,-677.846 291.701,-689.114 310,-704 313.596,-706.925 317.539,-709.754 321.551,-712.409"/>
<polygon fill="black" stroke="black" points="320,-715.568 330.332,-717.915 323.719,-709.637 320,-715.568"/>
</g>
<!-- proc~emd_rk_solver -->
<g id="node34" class="node"><title>proc~emd_rk_solver</title>
<a xlink:href="../proc/emd_rk_solver.html" xlink:title="emd_rk_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="396,-328 314,-328 314,-302 396,-302 396,-328"/>
<text text-anchor="middle" x="355" y="-312.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">emd_rk_solver</text>
</a>
</g>
<!-- proc~test_emd_rk&#45;&gt;proc~emd_rk_solver -->
<g id="edge38" class="edge"><title>proc~test_emd_rk&#45;&gt;proc~emd_rk_solver</title>
<path fill="none" stroke="black" d="M245.291,-638.238C256.039,-635.052 266.837,-629.763 274,-621 354.522,-522.49 235.962,-440.472 310,-337 310.455,-336.364 310.934,-335.745 311.435,-335.143"/>
<polygon fill="black" stroke="black" points="313.953,-337.582 318.963,-328.247 309.225,-332.42 313.953,-337.582"/>
</g>
<!-- proc~test_ls_rk&#45;&gt;str -->
<g id="edge42" class="edge"><title>proc~test_ls_rk&#45;&gt;str</title>
<path fill="none" stroke="black" d="M238.282,-827.523C249.634,-831.185 262.615,-835.817 274,-841 290.858,-848.675 292.119,-857.166 310,-862 348.614,-872.439 368.588,-886.765 400,-862 453.84,-819.553 389.12,-762.027 436,-712 444.824,-702.584 457.588,-697.167 469.867,-694.062"/>
<polygon fill="black" stroke="black" points="470.893,-697.424 479.971,-691.96 469.468,-690.57 470.893,-697.424"/>
</g>
<!-- proc~test_ls_rk&#45;&gt;proc~save_results -->
<g id="edge44" class="edge"><title>proc~test_ls_rk&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M238.004,-814.706C250.376,-811.587 264.19,-806.22 274,-797 304.792,-768.059 289.153,-745.757 310,-709 317.78,-695.281 328.272,-681.112 337.168,-669.991"/>
<polygon fill="black" stroke="black" points="339.968,-672.095 343.588,-662.138 334.549,-667.664 339.968,-672.095"/>
</g>
<!-- proc~test_ls_rk&#45;&gt;proc~init~9 -->
<g id="edge46" class="edge"><title>proc~test_ls_rk&#45;&gt;proc~init~9</title>
<path fill="none" stroke="black" d="M238.123,-812.882C249.956,-809.479 263.324,-804.393 274,-797 294.772,-782.614 290.194,-768.688 310,-753 312.742,-750.828 315.733,-748.796 318.827,-746.913"/>
<polygon fill="black" stroke="black" points="320.64,-749.91 327.699,-742.009 317.254,-743.783 320.64,-749.91"/>
</g>
<!-- proc~ls_rk_solver -->
<g id="node40" class="node"><title>proc~ls_rk_solver</title>
<a xlink:href="../proc/ls_rk_solver.html" xlink:title="ls_rk_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-504 320,-504 320,-478 390,-478 390,-504"/>
<text text-anchor="middle" x="355" y="-488.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ls_rk_solver</text>
</a>
</g>
<!-- proc~test_ls_rk&#45;&gt;proc~ls_rk_solver -->
<g id="edge48" class="edge"><title>proc~test_ls_rk&#45;&gt;proc~ls_rk_solver</title>
<path fill="none" stroke="black" d="M238.151,-815.65C250.857,-812.72 264.899,-807.241 274,-797 325.305,-739.273 289.839,-701.553 310,-627 320.89,-586.731 336.828,-540.846 346.524,-513.992"/>
<polygon fill="black" stroke="black" points="349.898,-514.956 350.029,-504.362 343.32,-512.562 349.898,-514.956"/>
</g>
<!-- proc~test_euler&#45;&gt;str -->
<g id="edge52" class="edge"><title>proc~test_euler&#45;&gt;str</title>
<path fill="none" stroke="black" d="M235.178,-876.12C275.379,-894.188 352.623,-920.395 400,-882 460.001,-833.374 383.953,-769.059 436,-712 444.697,-702.466 457.433,-697.024 469.726,-693.931"/>
<polygon fill="black" stroke="black" points="470.76,-697.291 479.849,-691.847 469.348,-690.435 470.76,-697.291"/>
</g>
<!-- proc~test_euler&#45;&gt;proc~save_results -->
<g id="edge54" class="edge"><title>proc~test_euler&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M239.211,-859.088C251.51,-856.042 264.934,-850.628 274,-841 315.687,-796.729 283.283,-763.626 310,-709 316.838,-695.019 327.101,-681.013 336.1,-670.053"/>
<polygon fill="black" stroke="black" points="338.861,-672.209 342.657,-662.318 333.521,-667.683 338.861,-672.209"/>
</g>
<!-- proc~test_euler&#45;&gt;proc~init~9 -->
<g id="edge56" class="edge"><title>proc~test_euler&#45;&gt;proc~init~9</title>
<path fill="none" stroke="black" d="M239.323,-858.366C251.349,-855.202 264.538,-849.894 274,-841 304.792,-812.059 281.128,-783.856 310,-753 312.588,-750.234 315.599,-747.772 318.813,-745.591"/>
<polygon fill="black" stroke="black" points="320.758,-748.509 327.646,-740.458 317.241,-742.457 320.758,-748.509"/>
</g>
<!-- proc~euler_solver -->
<g id="node46" class="node"><title>proc~euler_solver</title>
<a xlink:href="../proc/euler_solver.html" xlink:title="euler_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-788 320,-788 320,-762 390,-762 390,-788"/>
<text text-anchor="middle" x="355" y="-772.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">euler_solver</text>
</a>
</g>
<!-- proc~test_euler&#45;&gt;proc~euler_solver -->
<g id="edge58" class="edge"><title>proc~test_euler&#45;&gt;proc~euler_solver</title>
<path fill="none" stroke="black" d="M239.065,-855.283C250.396,-851.75 263.157,-846.995 274,-841 296.576,-828.519 319.066,-809.537 334.598,-795.129"/>
<polygon fill="black" stroke="black" points="337.197,-797.488 342.05,-788.07 332.383,-792.406 337.197,-797.488"/>
</g>
<!-- proc~test_leapfrog&#45;&gt;str -->
<g id="edge62" class="edge"><title>proc~test_leapfrog&#45;&gt;str</title>
<path fill="none" stroke="black" d="M246.606,-559.224C286.414,-564.819 350.242,-577.051 400,-602 434.507,-619.302 467.803,-649.498 487.844,-669.62"/>
<polygon fill="black" stroke="black" points="485.358,-672.084 494.85,-676.791 490.365,-667.192 485.358,-672.084"/>
</g>
<!-- proc~test_leapfrog&#45;&gt;proc~save_results -->
<g id="edge64" class="edge"><title>proc~test_leapfrog&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M246.56,-564.871C255.85,-568.07 265.554,-572.091 274,-577 297.905,-590.894 321.056,-612.562 336.442,-628.5"/>
<polygon fill="black" stroke="black" points="333.93,-630.938 343.34,-635.805 339.019,-626.132 333.93,-630.938"/>
</g>
<!-- proc~test_leapfrog&#45;&gt;proc~init~9 -->
<g id="edge66" class="edge"><title>proc~test_leapfrog&#45;&gt;proc~init~9</title>
<path fill="none" stroke="black" d="M246.812,-561.713C256.628,-564.975 266.528,-569.817 274,-577 306.251,-608.005 288.371,-631.839 310,-671 317.625,-684.806 328.109,-698.979 337.039,-710.082"/>
<polygon fill="black" stroke="black" points="334.432,-712.423 343.492,-717.916 339.836,-707.972 334.432,-712.423"/>
</g>
<!-- proc~leapfrog_solver -->
<g id="node52" class="node"><title>proc~leapfrog_solver</title>
<a xlink:href="../proc/leapfrog_solver.html" xlink:title="leapfrog_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="398,-196 312,-196 312,-170 398,-170 398,-196"/>
<text text-anchor="middle" x="355" y="-180.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">leapfrog_solver</text>
</a>
</g>
<!-- proc~test_leapfrog&#45;&gt;proc~leapfrog_solver -->
<g id="edge68" class="edge"><title>proc~test_leapfrog&#45;&gt;proc~leapfrog_solver</title>
<path fill="none" stroke="black" d="M246.736,-549.896C257.033,-546.674 267.209,-541.451 274,-533 365.858,-418.679 225.663,-324.977 310,-205 310.45,-204.36 310.924,-203.737 311.42,-203.132"/>
<polygon fill="black" stroke="black" points="313.943,-205.567 318.907,-196.207 309.189,-200.428 313.943,-205.567"/>
</g>
<!-- proc~test_bdf&#45;&gt;str -->
<g id="edge72" class="edge"><title>proc~test_bdf&#45;&gt;str</title>
<path fill="none" stroke="black" d="M236.046,-690.816C248.898,-693.854 263.67,-699.291 274,-709 304.792,-737.941 274.916,-773.446 310,-797 343.21,-819.296 366.653,-819.091 400,-797 434.202,-774.342 405.574,-739.522 436,-712 445.421,-703.479 458.094,-698.258 470.126,-695.059"/>
<polygon fill="black" stroke="black" points="471.019,-698.445 479.997,-692.82 469.47,-691.619 471.019,-698.445"/>
</g>
<!-- proc~test_bdf&#45;&gt;proc~save_results -->
<g id="edge74" class="edge"><title>proc~test_bdf&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M236.119,-679.942C256.395,-674.664 284.613,-667.32 308.469,-661.111"/>
<polygon fill="black" stroke="black" points="309.594,-664.435 318.39,-658.529 307.831,-657.66 309.594,-664.435"/>
</g>
<!-- proc~test_bdf&#45;&gt;proc~init~9 -->
<g id="edge76" class="edge"><title>proc~test_bdf&#45;&gt;proc~init~9</title>
<path fill="none" stroke="black" d="M236.119,-695.173C259.124,-702.106 292.353,-712.12 317.835,-719.799"/>
<polygon fill="black" stroke="black" points="316.946,-723.187 327.53,-722.722 318.966,-716.485 316.946,-723.187"/>
</g>
<!-- proc~bdf_solver -->
<g id="node58" class="node"><title>proc~bdf_solver</title>
<a xlink:href="../proc/bdf_solver.html" xlink:title="bdf_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="386,-372 324,-372 324,-346 386,-346 386,-372"/>
<text text-anchor="middle" x="355" y="-356.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bdf_solver</text>
</a>
</g>
<!-- proc~test_bdf&#45;&gt;proc~bdf_solver -->
<g id="edge78" class="edge"><title>proc~test_bdf&#45;&gt;proc~bdf_solver</title>
<path fill="none" stroke="black" d="M236.223,-684.477C249.608,-681.777 264.801,-676.253 274,-665 354.522,-566.49 235.962,-484.472 310,-381 311.55,-378.834 313.373,-376.872 315.381,-375.095"/>
<polygon fill="black" stroke="black" points="317.7,-377.743 323.864,-369.125 313.671,-372.018 317.7,-377.743"/>
</g>
<!-- proc~test_abm&#45;&gt;str -->
<g id="edge82" class="edge"><title>proc~test_abm&#45;&gt;str</title>
<path fill="none" stroke="black" d="M237.63,-514.277C276.913,-519.858 348.507,-533.993 400,-567 441.318,-593.485 475.754,-640.522 493.674,-668.119"/>
<polygon fill="black" stroke="black" points="490.791,-670.107 499.104,-676.675 496.701,-666.356 490.791,-670.107"/>
</g>
<!-- proc~test_abm&#45;&gt;proc~save_results -->
<g id="edge84" class="edge"><title>proc~test_abm&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M237.757,-516.539C249.798,-519.872 263.423,-525.062 274,-533 307.273,-557.97 331.973,-600.672 344.88,-626.715"/>
<polygon fill="black" stroke="black" points="341.762,-628.307 349.243,-635.809 348.073,-625.279 341.762,-628.307"/>
</g>
<!-- proc~test_abm&#45;&gt;proc~init~9 -->
<g id="edge86" class="edge"><title>proc~test_abm&#45;&gt;proc~init~9</title>
<path fill="none" stroke="black" d="M237.607,-514.468C250.353,-517.421 264.582,-522.886 274,-533 317.198,-579.387 282.467,-613.906 310,-671 316.761,-685.019 327.018,-699.027 336.034,-709.979"/>
<polygon fill="black" stroke="black" points="333.462,-712.357 342.607,-717.707 338.794,-707.822 333.462,-712.357"/>
</g>
<!-- proc~abm_solver -->
<g id="node64" class="node"><title>proc~abm_solver</title>
<a xlink:href="../proc/abm_solver.html" xlink:title="abm_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="389,-152 321,-152 321,-126 389,-126 389,-152"/>
<text text-anchor="middle" x="355" y="-136.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">abm_solver</text>
</a>
</g>
<!-- proc~test_abm&#45;&gt;proc~abm_solver -->
<g id="edge88" class="edge"><title>proc~test_abm&#45;&gt;proc~abm_solver</title>
<path fill="none" stroke="black" d="M214.784,-497.703C227.131,-468.896 256.377,-398.369 274,-337 296.037,-260.26 261.116,-224.127 310,-161 310.932,-159.797 311.946,-158.655 313.028,-157.573"/>
<polygon fill="black" stroke="black" points="315.328,-160.215 320.977,-151.252 310.972,-154.736 315.328,-160.215"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;str -->
<g id="edge108" class="edge"><title>proc~perform_errors_analysis&#45;&gt;str</title>
<path fill="none" stroke="black" d="M210.963,-301.955C217.314,-264.943 241.06,-159.225 310,-117 344.11,-96.1078 370.001,-90.5408 400,-117 448.04,-159.372 424.288,-340.023 436,-403 454.496,-502.46 486.597,-618.889 500.39,-667.204"/>
<polygon fill="black" stroke="black" points="497.068,-668.315 503.192,-676.961 503.796,-666.383 497.068,-668.315"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~save_results -->
<g id="edge112" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M214.723,-328.093C236.893,-378.81 317.267,-562.68 345.286,-626.777"/>
<polygon fill="black" stroke="black" points="342.104,-628.236 349.316,-635.997 348.518,-625.433 342.104,-628.236"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~init~9 -->
<g id="edge98" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~init~9</title>
<path fill="none" stroke="black" d="M214.814,-328.288C227.221,-357.078 256.576,-427.574 274,-489 296.501,-568.327 276.423,-595.69 310,-671 316.338,-685.215 326.568,-699.236 335.673,-710.146"/>
<polygon fill="black" stroke="black" points="333.141,-712.568 342.334,-717.833 338.431,-707.984 333.141,-712.568"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~am_solver -->
<g id="edge104" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~am_solver</title>
<path fill="none" stroke="black" d="M227.551,-328.123C247.486,-341.987 280.315,-364.131 310,-381 312.481,-382.41 315.065,-383.82 317.685,-385.206"/>
<polygon fill="black" stroke="black" points="316.14,-388.347 326.635,-389.798 319.336,-382.119 316.14,-388.347"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~tvd_rk_solver -->
<g id="edge106" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~tvd_rk_solver</title>
<path fill="none" stroke="black" d="M252.41,-301.918C269.554,-296.751 289.321,-290.794 306.898,-285.496"/>
<polygon fill="black" stroke="black" points="308.394,-288.701 316.959,-282.464 306.374,-281.999 308.394,-288.701"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~emd_rk_solver -->
<g id="edge114" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~emd_rk_solver</title>
<path fill="none" stroke="black" d="M273.888,-315C283.731,-315 293.774,-315 303.288,-315"/>
<polygon fill="black" stroke="black" points="303.37,-318.5 313.37,-315 303.37,-311.5 303.37,-318.5"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~ls_rk_solver -->
<g id="edge110" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~ls_rk_solver</title>
<path fill="none" stroke="black" d="M214.693,-328.247C227.715,-357.207 262.271,-426.925 310,-469 311.301,-470.147 312.672,-471.248 314.094,-472.304"/>
<polygon fill="black" stroke="black" points="312.377,-475.362 322.673,-477.862 316.183,-469.487 312.377,-475.362"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~leapfrog_solver -->
<g id="edge118" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~leapfrog_solver</title>
<path fill="none" stroke="black" d="M218.59,-301.656C235.167,-279.331 271.153,-234.007 310,-205 311.62,-203.79 313.317,-202.619 315.064,-201.489"/>
<polygon fill="black" stroke="black" points="317.229,-204.276 324.083,-196.196 313.687,-198.239 317.229,-204.276"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~bdf_solver -->
<g id="edge120" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~bdf_solver</title>
<path fill="none" stroke="black" d="M252.41,-328.082C271.879,-333.95 294.729,-340.836 313.916,-346.619"/>
<polygon fill="black" stroke="black" points="312.994,-349.996 323.578,-349.53 315.014,-343.294 312.994,-349.996"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~abm_solver -->
<g id="edge122" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~abm_solver</title>
<path fill="none" stroke="black" d="M214.693,-301.753C227.715,-272.793 262.271,-203.075 310,-161 311.301,-159.853 312.672,-158.752 314.094,-157.696"/>
<polygon fill="black" stroke="black" points="316.183,-160.513 322.673,-152.138 312.377,-154.638 316.183,-160.513"/>
</g>
<!-- proc~compute_errors -->
<g id="node70" class="node"><title>proc~compute_errors</title>
<a xlink:href="../proc/compute_errors.html" xlink:title="compute_errors">
<polygon fill="#d94e8f" stroke="#d94e8f" points="399,-26 311,-26 311,-1.24345e-14 399,-3.55271e-15 399,-26"/>
<text text-anchor="middle" x="355" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_errors</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~compute_errors -->
<g id="edge96" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~compute_errors</title>
<path fill="none" stroke="black" d="M210.267,-301.816C215.095,-258.33 235.986,-117.517 310,-35 310.755,-34.1584 311.549,-33.3456 312.377,-32.5608"/>
<polygon fill="black" stroke="black" points="314.794,-35.1161 320.568,-26.2328 310.515,-29.5766 314.794,-35.1161"/>
</g>
<!-- proc~print_analysis -->
<g id="node71" class="node"><title>proc~print_analysis</title>
<a xlink:href="../proc/print_analysis.html" xlink:title="print_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="394,-240 316,-240 316,-214 394,-214 394,-240"/>
<text text-anchor="middle" x="355" y="-224.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_analysis</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~print_analysis -->
<g id="edge100" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~print_analysis</title>
<path fill="none" stroke="black" d="M227.551,-301.877C247.486,-288.013 280.315,-265.869 310,-249 312.481,-247.59 315.065,-246.18 317.685,-244.794"/>
<polygon fill="black" stroke="black" points="319.336,-247.881 326.635,-240.202 316.14,-241.653 319.336,-247.881"/>
</g>
<!-- proc~ab_solver -->
<g id="node72" class="node"><title>proc~ab_solver</title>
<a xlink:href="../proc/ab_solver.html" xlink:title="ab_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="384,-460 326,-460 326,-434 384,-434 384,-460"/>
<text text-anchor="middle" x="355" y="-444.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ab_solver</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~ab_solver -->
<g id="edge102" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~ab_solver</title>
<path fill="none" stroke="black" d="M218.59,-328.344C235.167,-350.669 271.153,-395.993 310,-425 312.012,-426.502 314.143,-427.946 316.34,-429.324"/>
<polygon fill="black" stroke="black" points="314.615,-432.37 325.031,-434.307 318.096,-426.297 314.615,-432.37"/>
</g>
<!-- proc~estimate_orders -->
<g id="node73" class="node"><title>proc~estimate_orders</title>
<a xlink:href="../proc/estimate_orders.html" xlink:title="estimate_orders">
<polygon fill="#d94e8f" stroke="#d94e8f" points="400,-70 310,-70 310,-44 400,-44 400,-70"/>
<text text-anchor="middle" x="355" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">estimate_orders</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~estimate_orders -->
<g id="edge116" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~estimate_orders</title>
<path fill="none" stroke="black" d="M211.732,-301.991C220.223,-264.249 249.303,-153.026 310,-84 312.493,-81.1649 315.358,-78.5402 318.409,-76.132"/>
<polygon fill="black" stroke="black" points="320.605,-78.8674 326.793,-70.2676 316.593,-73.1314 320.605,-78.8674"/>
</g>
<!-- proc~test_ab&#45;&gt;str -->
<g id="edge124" class="edge"><title>proc~test_ab&#45;&gt;str</title>
<path fill="none" stroke="black" d="M236.184,-780.571C248.476,-783.968 262.737,-789.2 274,-797 294.772,-811.386 287.167,-830.18 310,-841 346.147,-858.129 368.14,-865.186 400,-841 447.41,-805.009 394.511,-754.682 436,-712 444.924,-702.819 457.596,-697.45 469.77,-694.317"/>
<polygon fill="black" stroke="black" points="470.738,-697.689 479.786,-692.177 469.275,-690.844 470.738,-697.689"/>
</g>
<!-- proc~test_ab&#45;&gt;proc~save_results -->
<g id="edge126" class="edge"><title>proc~test_ab&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M236.27,-769.552C248.58,-766.181 262.831,-760.935 274,-753 278.203,-750.014 316.627,-699.695 339.011,-670.163"/>
<polygon fill="black" stroke="black" points="341.876,-672.177 345.122,-662.091 336.295,-667.951 341.876,-672.177"/>
</g>
<!-- proc~test_ab&#45;&gt;proc~init~9 -->
<g id="edge128" class="edge"><title>proc~test_ab&#45;&gt;proc~init~9</title>
<path fill="none" stroke="black" d="M236.119,-766.827C259.124,-759.894 292.353,-749.88 317.835,-742.201"/>
<polygon fill="black" stroke="black" points="318.966,-745.515 327.53,-739.278 316.946,-738.813 318.966,-745.515"/>
</g>
<!-- proc~test_ab&#45;&gt;proc~ab_solver -->
<g id="edge130" class="edge"><title>proc~test_ab&#45;&gt;proc~ab_solver</title>
<path fill="none" stroke="black" d="M236.223,-772.477C249.608,-769.777 264.801,-764.253 274,-753 354.522,-654.49 235.962,-572.472 310,-469 311.923,-466.313 314.267,-463.938 316.864,-461.843"/>
<polygon fill="black" stroke="black" points="318.792,-464.764 325.247,-456.363 314.962,-458.905 318.792,-464.764"/>
</g>
<!-- proc~exact_solution -->
<g id="node16" class="node"><title>proc~exact_solution</title>
<a xlink:href="../proc/exact_solution.html" xlink:title="exact_solution">
<polygon fill="#d94e8f" stroke="#d94e8f" points="547,-177 467,-177 467,-151 547,-151 547,-177"/>
<text text-anchor="middle" x="507" y="-161.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_solution</text>
</a>
</g>
<!-- proc~save_results&#45;&gt;proc~exact_solution -->
<g id="edge2" class="edge"><title>proc~save_results&#45;&gt;proc~exact_solution</title>
<path fill="none" stroke="black" d="M359.739,-635.992C368.41,-611.923 387.12,-558.722 400,-513 419.059,-445.344 415.94,-426.366 436,-359 454.904,-295.516 483.275,-222.642 497.765,-186.608"/>
<polygon fill="black" stroke="black" points="501.123,-187.641 501.628,-177.058 494.633,-185.016 501.123,-187.641"/>
</g>
<!-- proc~compute_amplitude_phase -->
<g id="node17" class="node"><title>proc~compute_amplitude_phase</title>
<a xlink:href="../proc/compute_amplitude_phase.html" xlink:title="compute_amplitude_phase">
<polygon fill="#d94e8f" stroke="#d94e8f" points="578,-394 436,-394 436,-368 578,-368 578,-394"/>
<text text-anchor="middle" x="507" y="-378.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_amplitude_phase</text>
</a>
</g>
<!-- proc~save_results&#45;&gt;proc~compute_amplitude_phase -->
<g id="edge4" class="edge"><title>proc~save_results&#45;&gt;proc~compute_amplitude_phase</title>
<path fill="none" stroke="black" d="M362.538,-635.71C386.956,-592.657 464.061,-456.708 494.482,-403.071"/>
<polygon fill="black" stroke="black" points="497.707,-404.479 499.596,-394.054 491.618,-401.026 497.707,-404.479"/>
</g>
<!-- proc~init~9&#45;&gt;str -->
<g id="edge6" class="edge"><title>proc~init~9&#45;&gt;str</title>
<path fill="none" stroke="black" d="M382.175,-723.67C406.632,-717.073 442.787,-707.321 469.9,-700.007"/>
<polygon fill="black" stroke="black" points="471.061,-703.319 479.805,-697.336 469.238,-696.561 471.061,-703.319"/>
</g>
<!-- strz -->
<g id="node20" class="node"><title>strz</title>
<polygon fill="#777777" stroke="#777777" points="534,-747 480,-747 480,-721 534,-721 534,-747"/>
<text text-anchor="middle" x="507" y="-731.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">strz</text>
</g>
<!-- proc~init~9&#45;&gt;strz -->
<g id="edge8" class="edge"><title>proc~init~9&#45;&gt;strz</title>
<path fill="none" stroke="black" d="M382.175,-731.536C406.524,-732.017 442.469,-732.726 469.541,-733.261"/>
<polygon fill="black" stroke="black" points="469.738,-736.765 479.805,-733.463 469.876,-729.767 469.738,-736.765"/>
</g>
<!-- proc~am_solver&#45;&gt;proc~compute_amplitude_phase -->
<g id="edge10" class="edge"><title>proc~am_solver&#45;&gt;proc~compute_amplitude_phase</title>
<path fill="none" stroke="black" d="M386.126,-398.495C397.728,-396.816 411.504,-394.822 425.529,-392.792"/>
<polygon fill="black" stroke="black" points="426.363,-396.208 435.758,-391.311 425.36,-389.28 426.363,-396.208"/>
</g>
<!-- proc~tvd_rk_solver&#45;&gt;proc~compute_amplitude_phase -->
<g id="edge20" class="edge"><title>proc~tvd_rk_solver&#45;&gt;proc~compute_amplitude_phase</title>
<path fill="none" stroke="black" d="M384.592,-284.237C389.843,-286.93 395.173,-289.896 400,-293 431.789,-313.443 464.868,-341.946 485.676,-360.912"/>
<polygon fill="black" stroke="black" points="483.556,-363.717 493.282,-367.919 488.299,-358.569 483.556,-363.717"/>
</g>
<!-- proc~emd_rk_solver&#45;&gt;proc~compute_amplitude_phase -->
<g id="edge30" class="edge"><title>proc~emd_rk_solver&#45;&gt;proc~compute_amplitude_phase</title>
<path fill="none" stroke="black" d="M385.03,-328.039C408.659,-338.299 441.785,-352.683 467.552,-363.871"/>
<polygon fill="black" stroke="black" points="466.465,-367.215 477.032,-367.988 469.253,-360.794 466.465,-367.215"/>
</g>
<!-- proc~ls_rk_solver&#45;&gt;proc~compute_amplitude_phase -->
<g id="edge40" class="edge"><title>proc~ls_rk_solver&#45;&gt;proc~compute_amplitude_phase</title>
<path fill="none" stroke="black" d="M384.592,-477.763C389.843,-475.07 395.173,-472.104 400,-469 431.789,-448.557 464.868,-420.054 485.676,-401.088"/>
<polygon fill="black" stroke="black" points="488.299,-403.431 493.282,-394.081 483.556,-398.283 488.299,-403.431"/>
</g>
<!-- proc~euler_solver&#45;&gt;proc~compute_amplitude_phase -->
<g id="edge50" class="edge"><title>proc~euler_solver&#45;&gt;proc~compute_amplitude_phase</title>
<path fill="none" stroke="black" d="M389.647,-761.954C393.511,-759.429 397.094,-756.464 400,-753 423.209,-725.337 482.869,-481.91 501.414,-404.516"/>
<polygon fill="black" stroke="black" points="504.924,-404.886 503.842,-394.347 498.115,-403.26 504.924,-404.886"/>
</g>
<!-- proc~leapfrog_solver&#45;&gt;proc~compute_amplitude_phase -->
<g id="edge60" class="edge"><title>proc~leapfrog_solver&#45;&gt;proc~compute_amplitude_phase</title>
<path fill="none" stroke="black" d="M387.43,-196.023C391.927,-198.612 396.274,-201.6 400,-205 449.016,-249.723 483.191,-322.078 498.287,-358.513"/>
<polygon fill="black" stroke="black" points="495.042,-359.825 502.036,-367.784 501.532,-357.201 495.042,-359.825"/>
</g>
<!-- proc~bdf_solver&#45;&gt;proc~compute_amplitude_phase -->
<g id="edge70" class="edge"><title>proc~bdf_solver&#45;&gt;proc~compute_amplitude_phase</title>
<path fill="none" stroke="black" d="M386.126,-363.505C397.728,-365.184 411.504,-367.178 425.529,-369.208"/>
<polygon fill="black" stroke="black" points="425.36,-372.72 435.758,-370.689 426.363,-365.792 425.36,-372.72"/>
</g>
<!-- proc~abm_solver&#45;&gt;proc~compute_amplitude_phase -->
<g id="edge80" class="edge"><title>proc~abm_solver&#45;&gt;proc~compute_amplitude_phase</title>
<path fill="none" stroke="black" d="M388.642,-152.268C392.763,-154.776 396.683,-157.676 400,-161 457.805,-218.923 489.209,-314.275 501.208,-357.906"/>
<polygon fill="black" stroke="black" points="497.894,-359.064 503.845,-367.83 504.66,-357.267 497.894,-359.064"/>
</g>
<!-- proc~compute_errors&#45;&gt;proc~exact_solution -->
<g id="edge90" class="edge"><title>proc~compute_errors&#45;&gt;proc~exact_solution</title>
<path fill="none" stroke="black" d="M386.059,-26.0108C390.938,-28.6573 395.762,-31.6665 400,-35 439.656,-66.1942 474.681,-114.314 493.155,-142.119"/>
<polygon fill="black" stroke="black" points="490.37,-144.256 498.768,-150.716 496.232,-140.429 490.37,-144.256"/>
</g>
<!-- proc~print_analysis&#45;&gt;str -->
<g id="edge92" class="edge"><title>proc~print_analysis&#45;&gt;str</title>
<path fill="none" stroke="black" d="M390.257,-240.205C393.922,-242.688 397.29,-245.6 400,-249 443.806,-303.97 419.56,-334.66 436,-403 459.662,-501.359 488.974,-618.382 501.211,-667.029"/>
<polygon fill="black" stroke="black" points="497.849,-668.013 503.684,-676.856 504.637,-666.304 497.849,-668.013"/>
</g>
<!-- proc~ab_solver&#45;&gt;proc~compute_amplitude_phase -->
<g id="edge94" class="edge"><title>proc~ab_solver&#45;&gt;proc~compute_amplitude_phase</title>
<path fill="none" stroke="black" d="M384.668,-434.118C408.367,-423.827 441.787,-409.316 467.709,-398.061"/>
<polygon fill="black" stroke="black" points="469.109,-401.269 476.887,-394.075 466.321,-394.848 469.109,-401.269"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>

    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cli%7E32"></span>type(Type_Command_Line_Interface)</td>
  
  
  <td></td><td>::</td>
  <td><strong>cli</strong></td><td></td><td></td><td><p>Command line interface handler.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-space_dimension"></span>integer,</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>space_dimension</strong></td><td> =</td><td>2</td><td><p>Space dimensions.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-initial_state%7E9"></span>real(kind=R_P),</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>initial_state</strong>(1:space_dimension)</td><td> =</td><td>[0._R_P, 1._R_P]</td><td><p>Initial state.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f%7E8"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>f</strong></td><td></td><td></td><td><p>Oscillation frequency.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-amplitude"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>amplitude</strong></td><td></td><td></td><td><p>Oscillation amplitude.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t_final"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>t_final</strong></td><td></td><td></td><td><p>Final time.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E18"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>Dt</strong></td><td></td><td></td><td><p>Time step.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tolerance%7E3"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>tolerance</strong></td><td></td><td></td><td><p>Tolerance on local truncation error.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-error%7E27"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>error</strong></td><td></td><td></td><td><p>Error handler.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-stages_steps"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>stages_steps</strong></td><td></td><td></td><td><p>Number of stages/steps used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-implicit_iterations"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>implicit_iterations</strong></td><td></td><td></td><td><p>Number of iterations for implicit solvers.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-solver%7E2"></span>character(len=99)</td>
  
  
  <td></td><td>::</td>
  <td><strong>solver</strong></td><td></td><td></td><td><p>Solver used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-plots"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>plots</strong></td><td></td><td></td><td><p>Flag for activating plots saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-results"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>results</strong></td><td></td><td></td><td><p>Flag for activating results saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-output_cli"></span>character(len=99)</td>
  
  
  <td></td><td>::</td>
  <td><strong>output_cli</strong></td><td></td><td></td><td><p>Output files basename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-errors_analysis"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>errors_analysis</strong></td><td></td><td></td><td><p>Flag for activating errors analysis.</p></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    
    
    

    
    
     
    <section>
    <h2>Functions</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-exact_solution"></span><h3>
function <a href='../proc/exact_solution.html'>exact_solution</a>(t) result(ex_sol)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t</strong></td><td><p>Time.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:space_dimension)</small></h4>
  <p>Exact solution.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Compute the exact solution.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-compute_amplitude_phase"></span><h3>
function <a href='../proc/compute_amplitude_phase.html'>compute_amplitude_phase</a>(sol) result(ap)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>sol</strong>(1:2)</td><td><p>Solution.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:2)</small></h4>
  <p>Amplitude and phase.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Compute amplitude and phase of the solution.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-compute_errors"></span><h3>
function <a href='../proc/compute_errors.html'>compute_errors</a>(solution) result(error_L2)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:space_dimension)</small></h4>
  <p>L2 norm of the numerical error.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Compute the L2 norm of numerical error with respect the exact solution.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-estimate_orders"></span><h3>
function <a href='../proc/estimate_orders.html'>estimate_orders</a>(solver_error, Dt_used) result(order)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solver_error</strong>(1:space_dimension,1:2)</td><td><p>Computed errors.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dt_used</strong>(1:2)</td><td><p>Time steps used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:space_dimension)</small></h4>
  <p>Estimation of the order of accuracy.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Estimate the order of accuracy using 2 subsequent refined numerical solutions.</p>
        

  </div>
  </div>

    
    </section>
    <br>
    


    
    <section>
    <h2>Subroutines</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-init%7E9"></span><h3>
subroutine <a href='../proc/init%7E9.html'>init</a>(output, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=:),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>output</strong></td><td><p>Output files basename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>solution</strong>(:,:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Initialize solver local variable from global variables.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-save_results"></span><h3>
subroutine <a href='../proc/save_results.html'>save_results</a>(title, basename, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>title</strong></td><td><p>Plot title.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>basename</strong></td><td><p>Output files basename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Save plots of results.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_ab"></span><h3>
subroutine <a href='../proc/test_ab.html'>test_ab</a>(steps)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit Adams-Bashforth class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_abm"></span><h3>
subroutine <a href='../proc/test_abm.html'>test_abm</a>(steps)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test predictor-corrector Adams-Bashforth-Moulton class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_am"></span><h3>
subroutine <a href='../proc/test_am.html'>test_am</a>(steps)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test implicit Adams-Moulton class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_bdf"></span><h3>
subroutine <a href='../proc/test_bdf.html'>test_bdf</a>(steps)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all BDF solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test implicit Backward-Differentiation-Formula class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_emd_rk"></span><h3>
subroutine <a href='../proc/test_emd_rk.html'>test_emd_rk</a>(stages)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit embedded Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_euler"></span><h3>
subroutine <a href='../proc/test_euler.html'>test_euler</a>()
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit forward Euler ODE solver.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_leapfrog"></span><h3>
subroutine <a href='../proc/test_leapfrog.html'>test_leapfrog</a>(raw)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>raw</strong></td><td><p>Activate RAW filter.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit leapfrog class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_ls_rk"></span><h3>
subroutine <a href='../proc/test_ls_rk.html'>test_ls_rk</a>(stages)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit low storage Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_tvd_rk"></span><h3>
subroutine <a href='../proc/test_tvd_rk.html'>test_tvd_rk</a>(stages)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit TVD/SSP Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-ab_solver"></span><h3>
subroutine <a href='../proc/ab_solver.html'>ab_solver</a>(steps, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit Adams-Bashforth class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-abm_solver"></span><h3>
subroutine <a href='../proc/abm_solver.html'>abm_solver</a>(steps, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all ABM solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with predictor-corrector Adams-Bashforth-Moulton class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-am_solver"></span><h3>
subroutine <a href='../proc/am_solver.html'>am_solver</a>(steps, iterations, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AM solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>iterations</strong></td><td><p>Number of fixed point iterations.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with implicit Adams-Moulton class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-bdf_solver"></span><h3>
subroutine <a href='../proc/bdf_solver.html'>bdf_solver</a>(steps, iterations, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all BDF solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>iterations</strong></td><td><p>Number of fixed point iterations.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with implicit Bacward-Differentiation-Formula class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-emd_rk_solver"></span><h3>
subroutine <a href='../proc/emd_rk_solver.html'>emd_rk_solver</a>(stages, tol, solution, last_step)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>tol</strong></td><td><p>Tolerance on local truncation error.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>last_step</strong></td><td><p>Last time step number.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit embedded Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-euler_solver"></span><h3>
subroutine <a href='../proc/euler_solver.html'>euler_solver</a>(solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit forward Euler ODE solver.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-leapfrog_solver"></span><h3>
subroutine <a href='../proc/leapfrog_solver.html'>leapfrog_solver</a>(solution, raw)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>raw</strong></td><td><p>Activate RAW filter.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit leapfrog class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-ls_rk_solver"></span><h3>
subroutine <a href='../proc/ls_rk_solver.html'>ls_rk_solver</a>(stages, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit low storage Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-tvd_rk_solver"></span><h3>
subroutine <a href='../proc/tvd_rk_solver.html'>tvd_rk_solver</a>(stages, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit TVD/SSP Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-perform_errors_analysis"></span><h3>
subroutine <a href='../proc/perform_errors_analysis.html'>perform_errors_analysis</a>()
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Peform errors analysis.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-print_analysis"></span><h3>
subroutine <a href='../proc/print_analysis.html'>print_analysis</a>(solver, time_steps, mean_time_steps, errors, orders)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solver</strong></td><td><p>Solver name.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>time_steps</strong>(:)</td><td><p>Time steps exercised.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>mean_time_steps</strong>(:,:)</td><td><p>Mean time steps exercised.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>errors</strong>(:,:,:)</td><td><p>Errors of the solver.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>orders</strong>(:,:,:)</td><td><p>Observed orders of the solver.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Print summary of the error analysis.</p>
        

  </div>
  </div>

    
    </section>    
    
    
    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span class="k">program </span><span class="n">integrate_oscillation</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c">!&lt; Test FOODIE with the integration of Oscillation equations.</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">use </span><span class="n">IR_Precision</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">R_P</span><span class="p">,</span> <span class="n">I_P</span><span class="p">,</span> <span class="n">FR_P</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">strz</span>
<span class="k">use </span><span class="n">type_oscillation</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">oscillation</span>
<span class="k">use </span><span class="n">Data_Type_Command_Line_Interface</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Type_Command_Line_Interface</span>
<span class="k">use </span><span class="n">foodie</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">adams_bashforth_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">adams_bashforth_moulton_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">adams_moulton_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">bdf_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">emd_runge_kutta_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">euler_explicit_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">leapfrog_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">ls_runge_kutta_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">tvd_runge_kutta_integrator</span>
<span class="k">use </span><span class="n">pyplot_module</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span>  <span class="n">pyplot</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">implicit none</span>
<span class="k">type</span><span class="p">(</span><span class="n">Type_Command_Line_Interface</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cli</span>                                               <span class="c">!&lt; Command line interface handler.</span>
<span class="kt">integer</span><span class="p">,</span>   <span class="k">parameter</span>              <span class="kd">::</span> <span class="n">space_dimension</span><span class="o">=</span><span class="mi">2</span>                                 <span class="c">!&lt; Space dimensions.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">parameter</span>              <span class="kd">::</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="mf">1._R_P</span><span class="p">]</span> <span class="c">!&lt; Initial state.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">f</span>                                                 <span class="c">!&lt; Oscillation frequency.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">amplitude</span>                                         <span class="c">!&lt; Oscillation amplitude.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">t_final</span>                                           <span class="c">!&lt; Final time.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">Dt</span>                                                <span class="c">!&lt; Time step.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">tolerance</span>                                         <span class="c">!&lt; Tolerance on local truncation error.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">error</span>                                             <span class="c">!&lt; Error handler.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">stages_steps</span>                                      <span class="c">!&lt; Number of stages/steps used.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">implicit_iterations</span>                               <span class="c">!&lt; Number of iterations for implicit solvers.</span>
<span class="kt">character</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">solver</span>                                            <span class="c">!&lt; Solver used.</span>
<span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">plots</span>                                             <span class="c">!&lt; Flag for activating plots saving.</span>
<span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">results</span>                                           <span class="c">!&lt; Flag for activating results saving.</span>
<span class="kt">character</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">output_cli</span>                                        <span class="c">!&lt; Output files basename.</span>
<span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">errors_analysis</span>                                   <span class="c">!&lt; Flag for activating errors analysis.</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c">! set Command Line Interface</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">progname</span>    <span class="o">=</span> <span class="s1">&#39;oscillation&#39;</span><span class="p">,</span>                                              <span class="p">&amp;</span>
              <span class="n">authors</span>     <span class="o">=</span> <span class="s1">&#39;Fortran-FOSS-Programmers&#39;</span><span class="p">,</span>                                 <span class="p">&amp;</span>
              <span class="n">license</span>     <span class="o">=</span> <span class="s1">&#39;GNU GPLv3&#39;</span><span class="p">,</span>                                                <span class="p">&amp;</span>
              <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Test FOODIE library on Oscillation equations integration&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">examples</span>    <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;oscillation --solver euler --results  &quot;</span><span class="p">,</span>                  <span class="p">&amp;</span>
                             <span class="s2">&quot;oscillation --solver ls-runge-kutta -r&quot;</span><span class="p">,</span>                  <span class="p">&amp;</span>
                             <span class="s2">&quot;oscillation --solver adams-bashforth  &quot;</span><span class="p">,</span>                  <span class="p">&amp;</span>
                             <span class="s2">&quot;oscillation --solver all --plots -r   &quot;</span><span class="p">])</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--solver&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;ODE solver used&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--ss&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Stages/steps used&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--iterations&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Number of iterations for implicit solvers&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;5&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--frequency&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Oscillation frequency&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;1e-4&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--time_step&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-Dt&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Integration time step&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;100.d0&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--tolerance&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-tol&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Tolerance on local error&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;0.001d0&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--t_final&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-tf&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Final integration time&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;1e6&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--results&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Save results&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--plots&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Save plots of results&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Output files basename&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;unset&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--errors_analysis&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Peform errors analysis&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">)</span>
<span class="c">! parse Command Line Interface</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">parse</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--ss&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--iterations&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">implicit_iterations</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-Dt&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-tol&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-tf&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">t_final</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">plots</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">output_cli</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--errors_analysis&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">errors_analysis</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="c">! run tests</span>
<span class="k">if</span> <span class="p">(</span><span class="n">errors_analysis</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  call </span><span class="n">perform_errors_analysis</span>
<span class="k">else</span>
<span class="k">  select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">)))</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;adams-bashforth&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_ab</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;adams-bashforth-moulton&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_abm</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;adams-moulton&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_am</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;backward-diff-formula&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_bdf</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;emd-runge-kutta&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_emd_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;euler&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_euler</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;leapfrog&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_leapfrog</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;leapfrog-raw&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_leapfrog</span><span class="p">(</span><span class="n">raw</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;ls-runge-kutta&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_ls_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;tvd-runge-kutta&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_tvd_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_ab</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_abm</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_am</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_emd_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_euler</span>
    <span class="k">call </span><span class="n">test_leapfrog</span>
    <span class="k">call </span><span class="n">test_ls_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_tvd_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case </span><span class="n">default</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Error: unknown solver &quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Valid solver names are:&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + adams-bashforth&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + adams-bashforth-moulton&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + adams-moulton&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + backward-diff-formula&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + emd-runge-kutta&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + euler&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + leapfrog&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + leapfrog-raw&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + ls-runge-kutta&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + tvd-runge-kutta&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + all&#39;</span>
  <span class="n">endselect</span>
<span class="n">endif</span>
<span class="k">stop</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">contains</span>
<span class="k">  subroutine </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Initialize solver local variable from global variables.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">output</span>        <span class="c">!&lt; Output files basename.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>        <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span> <span class="c">!&lt; Solution at each time step.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">t_final</span><span class="p">,</span> <span class="n">Dt</span><span class="p">)</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Error: the final integration time must be an exact multiple of the time step used!&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Final integration time: &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">t_final</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Time step: &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">Dt</span><span class="p">)</span>
    <span class="k">stop</span>
<span class="k">  </span><span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">output_cli</span><span class="p">))</span><span class="o">/=</span><span class="s1">&#39;unset&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    if</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span><span class="o">/=</span><span class="s1">&#39;emd-runge-kutta&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      </span><span class="n">output</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">output_cli</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span><span class="o">//</span><span class="s1">&#39;-time_steps-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">output</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">output_cli</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">n</span><span class="o">=</span><span class="n">tolerance</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;-tolerance-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
    <span class="n">endif</span>
  <span class="k">else</span>
<span class="k">    if</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span><span class="o">/=</span><span class="s1">&#39;emd-runge-kutta&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      </span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;oscillation_integration-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span><span class="o">//</span><span class="s1">&#39;-time_steps-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;oscillation_integration-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">n</span><span class="o">=</span><span class="n">tolerance</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;-tolerance-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
    <span class="n">endif</span>
  <span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">solution</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="p">;</span> <span class="k">allocate</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span>
  <span class="n">amplitude</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">init</span>

  <span class="k">function </span><span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ex_sol</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the exact solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">t</span>                         <span class="c">!&lt; Time.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span> <span class="c">!&lt; Exact solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
  <span class="n">ex_sol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">exact_solution</span>

  <span class="k">function </span><span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ap</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute amplitude and phase of the solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Solution.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ap</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>  <span class="c">!&lt; Amplitude and phase.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">ap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">sol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">ap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">atan</span><span class="p">(</span><span class="o">-</span><span class="n">sol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">sol</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">compute_amplitude_phase</span>

  <span class="k">subroutine </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Save plots of results.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">title</span>                       <span class="c">!&lt; Plot title.</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">basename</span>                    <span class="c">!&lt; Output files basename.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>             <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">rawfile</span>                     <span class="c">!&lt; Raw file unit for saving results.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Exact solution.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">pyplot</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">plt</span>                         <span class="c">!&lt; Plot file handler.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">i</span>                           <span class="c">!&lt; Counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">s</span>                           <span class="c">!&lt; Counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">rawfile</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">basename</span><span class="o">//</span><span class="s1">&#39;.dat&#39;</span><span class="p">)</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;TITLE=&quot;&#39;</span><span class="o">//</span><span class="n">title</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;VARIABLES=&quot;t&quot; &quot;x&quot; &quot;y&quot; &quot;amplitude&quot; &quot;phase&quot;&#39;</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;ZONE T=&quot;FOODIE time serie&quot;&#39;</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ubound</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(5(&#39;</span><span class="o">//</span><span class="n">FR_P</span><span class="o">//</span><span class="s1">&#39;,1X))&#39;</span><span class="p">)(</span><span class="n">solution</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">space_dimension</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">enddo</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;ZONE T=&quot;Exact solution&quot;&#39;</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ubound</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
      <span class="n">ex_sol</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">))</span>
      <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(5(&#39;</span><span class="o">//</span><span class="n">FR_P</span><span class="o">//</span><span class="s1">&#39;,1X))&#39;</span><span class="p">)</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="p">(</span><span class="n">ex_sol</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">enddo</span>
    <span class="k">close</span><span class="p">(</span><span class="n">rawfile</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">plots</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    call </span><span class="n">plt</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">:),</span> <span class="n">y</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">:),</span> <span class="n">y</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">savefig</span><span class="p">(</span><span class="n">basename</span><span class="o">//</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>

    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="o">//</span><span class="s1">&#39;-path&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">:),</span> <span class="n">y</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;path-&#39;</span><span class="o">//</span><span class="n">basename</span><span class="o">//</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">save_results</span>

  <span class="k">subroutine </span><span class="n">test_ab</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit Adams-Bashforth class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">steps</span>            <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">ab_steps</span><span class="o">=</span><span class="mi">4</span>       <span class="c">!&lt; Adams-Bashforth steps number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                <span class="c">!&lt; AB steps counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Steps used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>           <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>            <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of Adams-Bashforth class of solvers&#39;</span>
  <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">steps</span><span class="p">,</span> <span class="n">steps</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; AB-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit Adams-Bashforth, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">ab_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_ab</span>

  <span class="k">subroutine </span><span class="n">test_abm</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test predictor-corrector Adams-Bashforth-Moulton class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">steps</span>            <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">abm_steps</span><span class="o">=</span><span class="mi">4</span>      <span class="c">!&lt; Adams-Bashforth-Moulton steps number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                <span class="c">!&lt; ABM steps counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Steps used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>           <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>            <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth-moulton&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of Adams-Bashforth-Moulton class of solvers&#39;</span>
  <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">abm_steps</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">steps</span><span class="p">,</span> <span class="n">steps</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; ABM-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, predictor/corrector Adams-Bashforth-Moulton, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
            <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">abm_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_abm</span>

  <span class="k">subroutine </span><span class="n">test_am</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test implicit Adams-Moulton class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">steps</span>            <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">am_steps</span><span class="o">=</span><span class="mi">3</span>       <span class="c">!&lt; Adams-Moulton steps number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                <span class="c">!&lt; AM steps counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Steps used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>           <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>            <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-moulton&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of Adams-Moulton class of solvers&#39;</span>
  <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">am_steps</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">steps</span><span class="p">,</span> <span class="n">steps</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; AM-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, implicit Adams-Moulton, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
            <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">implicit_iterations</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      call </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">implicit_iterations</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">endif</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_am</span>

  <span class="k">subroutine </span><span class="n">test_bdf</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test implicit Backward-Differentiation-Formula class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">steps</span>            <span class="c">!&lt; Number of steps used: if negative all BDF solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">bdf_steps</span><span class="o">=</span><span class="mi">3</span>      <span class="c">!&lt; BDF steps number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                <span class="c">!&lt; Steps counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Steps used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>           <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>            <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;bdf&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of Backward-Differentiation-Formula class of solvers&#39;</span>
  <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">bdf_steps</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">steps</span><span class="p">,</span> <span class="n">steps</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; BDF-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, implicit Backward-Differentation-Formula, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
            <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">implicit_iterations</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      call </span><span class="n">bdf_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">implicit_iterations</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">bdf_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">endif</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_bdf</span>

  <span class="k">subroutine </span><span class="n">test_emd_rk</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit embedded Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">stages</span>            <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">17</span>      <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>     <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                 <span class="c">!&lt; RK stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Stages used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>            <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>             <span class="c">!&lt; Output files title.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">last_step</span>         <span class="c">!&lt; Last time step computed.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;emd-runge-kutta&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of embedded Runge-Kutta class of solvers&#39;</span>
  <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">stages</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">stages</span><span class="p">,</span> <span class="n">stages</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1 stages not allowed</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not suited for test</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 5 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 8 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 10 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">11</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 11 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">12</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 12 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">13</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 13 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">14</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 14 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">15</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 15 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">16</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 16 stages not yet implemented</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; RK-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit embedded Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">emd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">last_step</span><span class="o">=</span><span class="n">last_step</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">(:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">last_step</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_emd_rk</span>

  <span class="k">subroutine </span><span class="n">test_euler</span><span class="p">()</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit forward Euler ODE solver.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span> <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>        <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>         <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;euler&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of explicit Euler solver&#39;</span>
  <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit Euler, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
  <span class="k">call </span><span class="n">euler_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_euler</span>

  <span class="k">subroutine </span><span class="n">test_leapfrog</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit leapfrog class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">logical</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">raw</span>           <span class="c">!&lt; Activate RAW filter.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span> <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>        <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>         <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;leapfrog&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of leapfrog (RAW filtered) class of solvers&#39;</span>
  <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, leapfrog (RAW filtered), t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
  <span class="k">call </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span>
  <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_leapfrog</span>

  <span class="k">subroutine </span><span class="n">test_ls_rk</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit low storage Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">stages</span>            <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">14</span>      <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>     <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                 <span class="c">!&lt; RK stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Stages used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>            <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>             <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;ls-runge-kutta&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of low storage (2N) Runge-Kutta class of solvers&#39;</span>
  <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">stages</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">stages</span><span class="p">,</span> <span class="n">stages</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 8 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">9</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 9 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 10 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">11</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 11 stages not yet implemented</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; RK-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit low storage Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
      <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">ls_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_ls_rk</span>

  <span class="k">subroutine </span><span class="n">test_tvd_rk</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit TVD/SSP Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">stages</span>            <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>       <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>     <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                 <span class="c">!&lt; RK stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Stages used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>            <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>             <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;tvd-runge-kutta&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of TVD/SSP Runge-Kutta class of solvers&#39;</span>
  <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">stages</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">stages</span><span class="p">,</span> <span class="n">stages</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; RK-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit TVD/SSP Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">tvd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_tvd_rk</span>

  <span class="k">subroutine </span><span class="n">ab_solver</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit Adams-Bashforth class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">steps</span>                 <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>               <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">adams_bashforth_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_integrator</span>         <span class="c">!&lt; Adams-Bashforth integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">steps</span><span class="p">)</span>     <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                          <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">ab_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">endselect</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to s - 1 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">ab_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">-</span><span class="n">steps</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
    <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">ab_solver</span>

  <span class="k">subroutine </span><span class="n">abm_solver</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with predictor-corrector Adams-Bashforth-Moulton class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">steps</span>                 <span class="c">!&lt; Number of steps used: if negative all ABM solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>                       <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">adams_bashforth_moulton_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">abm_integrator</span>        <span class="c">!&lt; Adams-Bashforth-Moulton integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">steps</span><span class="p">)</span>     <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                                  <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">abm_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">endselect</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to s - 1 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">abm_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">-</span><span class="n">steps</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
    <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">abm_solver</span>

  <span class="k">subroutine </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with implicit Adams-Moulton class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">steps</span>                 <span class="c">!&lt; Number of steps used: if negative all AM solvers are used.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iterations</span>            <span class="c">!&lt; Number of fixed point iterations.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>                  <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">adams_moulton_integrator</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">am_integrator</span>         <span class="c">!&lt; Adams-Moulton integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">steps</span><span class="p">)</span>     <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">am_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">steps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">endselect</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to s - 1 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">steps</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">am_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">)</span>
      <span class="k">else</span>
<span class="k">        call </span><span class="n">am_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">step</span><span class="o">-</span><span class="n">steps</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">)</span>
      <span class="n">endif</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
    <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">am_solver</span>

  <span class="k">subroutine </span><span class="n">bdf_solver</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with implicit Bacward-Differentiation-Formula class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">steps</span>                 <span class="c">!&lt; Number of steps used: if negative all BDF solvers are used.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iterations</span>            <span class="c">!&lt; Number of fixed point iterations.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>                  <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">bdf_integrator</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">integrator</span>            <span class="c">!&lt; BDF integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">steps</span><span class="p">)</span>     <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">steps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">endselect</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to s - 1 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">steps</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">)</span>
      <span class="k">else</span>
<span class="k">        call </span><span class="n">integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">step</span><span class="o">-</span><span class="n">steps</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">)</span>
      <span class="n">endif</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
    <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">bdf_solver</span>

  <span class="k">subroutine </span><span class="n">emd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">solution</span><span class="p">,</span> <span class="n">last_step</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit embedded Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">stages</span>             <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">tol</span>                <span class="c">!&lt; Tolerance on local truncation error.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">last_step</span>          <span class="c">!&lt; Last time step number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">emd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>      <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>         <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">step</span>               <span class="c">!&lt; Time steps counter.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">Dt_a</span>               <span class="c">!&lt; Adaptive time step.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">Dt_a</span> <span class="o">=</span> <span class="mi">1000</span><span class="mf">0._R_P</span> <span class="c">! initial step very large to trigger adaptation</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt_a</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Dt_a</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
    <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="n">last_step</span> <span class="o">=</span> <span class="n">step</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">emd_rk_solver</span>

  <span class="k">subroutine </span><span class="n">euler_solver</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit forward Euler ODE solver.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>  <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">euler_explicit_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">euler_integrator</span> <span class="c">!&lt; Euler integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">oscillator</span>       <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">step</span>             <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">euler_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
    <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">euler_solver</span>

  <span class="k">subroutine </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit leapfrog class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">logical</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">raw</span>                   <span class="c">!&lt; Activate RAW filter.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>               <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">leapfrog_integrator</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">lf_integrator</span>         <span class="c">!&lt; Leapfrog integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>         <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">filter</span>                <span class="c">!&lt; Filter displacement.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                          <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="kt">logical</span>                          <span class="kd">::</span> <span class="n">filtered</span>              <span class="c">!&lt; Activate RAW filter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">filtered</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">raw</span><span class="p">))</span> <span class="n">filtered</span> <span class="o">=</span> <span class="n">raw</span>
  <span class="k">call </span><span class="n">lf_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">()</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">rk_stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">2</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to 2 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">filtered</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">lf_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span> <span class="n">filter</span><span class="o">=</span><span class="n">filter</span><span class="p">)</span>
      <span class="k">else</span>
<span class="k">        call </span><span class="n">lf_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">endif</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
    <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">leapfrog_solver</span>

  <span class="k">subroutine </span><span class="n">ls_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit low storage Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">stages</span>                <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">ls_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>              <span class="kd">::</span> <span class="n">registers</span><span class="o">=</span><span class="mi">2</span>           <span class="c">!&lt; Runge-Kutta stages registers number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">registers</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta registers.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
    <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">ls_rk_solver</span>

  <span class="k">subroutine </span><span class="n">tvd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit TVD/SSP Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">stages</span>             <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>      <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>         <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">step</span>               <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
    <span class="n">solution</span><span class="p">(</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_amplitude_phase</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">tvd_rk_solver</span>

  <span class="k">subroutine </span><span class="n">perform_errors_analysis</span><span class="p">()</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Peform errors analysis.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The analysis is based on the integration of the Oscillation equations with different, decreasing time steps in the range</span>
  <span class="c">!&lt; *[5000, 2500, 1250, 625, 320, 100]*. The error is estimated by the L2 norm of the difference between the exact (\(U_e\)) and</span>
  <span class="c">!&lt; the numerical (\(U_{\Delta t}\)) solutions for each time step:</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;\varepsilon (\Delta t) = || U_e - U_{\Delta t} ||_2 = \sqrt{ \sum_{s=1}^{N_s} { \left(U_e(t_0 + s * \Delta t) -</span>
  <span class="c">!&lt;U_{\Delta t}(t_0 + s * \Delta t) \right)^2 }}</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; Using two pairs of subsequent-decreasing time steps solution is possible to estimate the order of accuracy of the solver</span>
  <span class="c">!&lt; employed computing the \emph{observed order} of accuracy:</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;p = \frac{log10 \left( \frac{\varepsilon (\Delta t_1)}{\varepsilon (\Delta t_2)} \right)}</span>
  <span class="c">!&lt;{log10 \left( \frac{\Delta t_1}{\Delta t_2} \right)}</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt;where \(\frac{\Delta t_1}{\Delta t_2}&gt;1\).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">parameter</span>       <span class="kd">::</span> <span class="n">NDt</span><span class="o">=</span><span class="mi">6</span>                               <span class="c">!&lt; Number of time steps exercised.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">parameter</span>       <span class="kd">::</span> <span class="n">time_steps</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="mi">250</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="mi">125</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="mi">62</span><span class="mf">5._R_P</span><span class="p">,</span>  <span class="p">&amp;</span>
                                                      <span class="mi">32</span><span class="mf">0._R_P</span><span class="p">,</span>  <span class="p">&amp;</span>
                                                      <span class="mi">10</span><span class="mf">0._R_P</span><span class="p">]</span>      <span class="c">!&lt; Time steps exercised.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">parameter</span>       <span class="kd">::</span> <span class="n">tolerances</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="mf">0.001_R_P</span><span class="p">,</span>     <span class="p">&amp;</span>
                                                      <span class="mf">0.0001_R_P</span><span class="p">,</span>    <span class="p">&amp;</span>
                                                      <span class="mf">0.00001_R_P</span><span class="p">,</span>   <span class="p">&amp;</span>
                                                      <span class="mf">0.000001_R_P</span><span class="p">,</span>  <span class="p">&amp;</span>
                                                      <span class="mf">0.0000001_R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="mf">0.00000001_R_P</span><span class="p">]</span>  <span class="c">!&lt; Tolerances for embedded RK solvers.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">ab_steps</span><span class="o">=</span><span class="mi">4</span>                          <span class="c">!&lt; Adams-Bashforth steps number.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">bdf_steps</span><span class="o">=</span><span class="mi">6</span>                         <span class="c">!&lt; BDF steps number.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">emd_rk_stages</span><span class="o">=</span><span class="mi">17</span>                    <span class="c">!&lt; Embedded Runge-Kutta stages number.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">tvd_rk_stages</span><span class="o">=</span><span class="mi">5</span>                     <span class="c">!&lt; TVD/SSP Runge-Kutta stages number.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">ls_rk_stages</span><span class="o">=</span><span class="mi">14</span>                     <span class="c">!&lt; Low storage Runge-Kutta stages number.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                                   <span class="c">!&lt; Steps/stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">d</span>                                   <span class="c">!&lt; Time steps-exercised counter.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>                              <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>                               <span class="c">!&lt; Output files title.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>                       <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">last_step</span>                           <span class="c">!&lt; Last time step computed.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">emd_Dt_mean</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">emd_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span> <span class="c">!&lt; Mean time resolution for adaptive step methods.</span>
  <span class="c">! errors and orders</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>            <span class="c">!&lt; Adams-Bashforth errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">abm_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>           <span class="c">!&lt; Adams-Bashforth-Moulton errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">am_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>            <span class="c">!&lt; Adams-Moulton errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bdf_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">bdf_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>          <span class="c">!&lt; BDF errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">emd_rk_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">emd_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>   <span class="c">!&lt; TVD/SSP Runge-Kutta errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lf_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>                   <span class="c">!&lt; Leapfrog errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ls_rk_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ls_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>     <span class="c">!&lt; Low storage Runge-Kutta errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tvd_rk_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">tvd_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>   <span class="c">!&lt; TVD/SSP Runge-Kutta errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>          <span class="c">!&lt; Adams-Bashforth orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">abm_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>         <span class="c">!&lt; Adams-Bashforth-Moulton orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">am_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>          <span class="c">!&lt; Adams-Moulton orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bdf_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">bdf_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>        <span class="c">!&lt; BDF orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">emd_rk_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">emd_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">!&lt; Embedded Runge-Kutta orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lf_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                 <span class="c">!&lt; Leapfrog orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ls_rk_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ls_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>   <span class="c">!&lt; Low storage Runge-Kutta orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tvd_rk_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">tvd_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">!&lt; TVD/SSP Runge-Kutta orders.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">ab_errors</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R_P</span>     <span class="p">;</span> <span class="n">ab_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">abm_errors</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R_P</span>    <span class="p">;</span> <span class="n">abm_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">am_errors</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R_P</span>     <span class="p">;</span> <span class="n">am_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">bdf_errors</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R_P</span>    <span class="p">;</span> <span class="n">bdf_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">emd_rk_errors</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R_P</span> <span class="p">;</span> <span class="n">emd_rk_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">lf_errors</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R_P</span>     <span class="p">;</span> <span class="n">lf_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">ls_rk_errors</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R_P</span>  <span class="p">;</span> <span class="n">ls_rk_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">tvd_rk_errors</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1._R_P</span> <span class="p">;</span> <span class="n">tvd_rk_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">solution</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="p">;</span> <span class="k">allocate</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span>
  <span class="n">results</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">! activate results saving</span>
  <span class="c">! Analyze errors of Adams-Bashforth solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit Adams-Bashforth, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">ab_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">ab_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">ab_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">ab_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of Adams-Bashforth-Moulton solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth-moulton&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, predictor-corrector Adams-Bashforth-Moulton, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
              <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">abm_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">abm_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">abm_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">abm_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of Adams-Moulton solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-moulton&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ab_steps</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, implicit Adams-Moulton, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
              <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">implicit_iterations</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">implicit_iterations</span><span class="p">)</span>
      <span class="k">else</span>
<span class="k">        call </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">am_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ab_steps</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">am_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">am_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of Backward-Differentiation-Formul solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;bdf&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bdf_steps</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, implicit Backward-Differentiation-Formula, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
              <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">implicit_iterations</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">bdf_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">implicit_iterations</span><span class="p">)</span>
      <span class="k">else</span>
<span class="k">        call </span><span class="n">bdf_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">bdf_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bdf_steps</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">bdf_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">bdf_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of embedded Runge-Kutta solvers</span>
  <span class="n">emd_Dt_mean</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised tolerances</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">NDt</span><span class="p">)</span>
    <span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerances</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;emd-runge-kutta&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">emd_rk_stages</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1 stages not allowed</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not suited for test</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 5 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 8 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 10 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">11</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 11 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">12</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 12 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">13</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 13 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">14</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 14 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">15</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 15 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">16</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 16 stages not yet implemented</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit embedded Runge-Kutta t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; stages=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">17</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">emd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tolerances</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">last_step</span><span class="o">=</span><span class="n">last_step</span><span class="p">)</span>
      <span class="k">else</span>
<span class="k">        call </span><span class="n">emd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tolerances</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">last_step</span><span class="o">=</span><span class="n">last_step</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="n">emd_Dt_mean</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">t_final</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">last_step</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">R_P</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">(:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">last_step</span><span class="p">))</span>
      <span class="n">emd_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">(:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">last_step</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">emd_rk_stages</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1 stages not allowed</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not suited for test</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 5 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 8 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 10 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">11</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 11 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">12</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 12 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">13</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 13 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">14</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 14 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">15</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 15 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">16</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 16 stages not yet implemented</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">emd_rk_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">emd_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">emd_Dt_mean</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of leapfrog solver</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;leapfrog&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, leapfrog (unfiltered), t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
    <span class="k">call </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">lf_errors</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;leapfrog&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, leapfrog (RAW filtered), t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
    <span class="k">call </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-raw&#39;</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">lf_errors</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">lf_orders</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">lf_errors</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">lf_orders</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">lf_errors</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of low storage Runge-Kutta solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;ls-runge-kutta&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls_rk_stages</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 8 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">9</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 9 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 10 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">11</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 11 stages not yet implemented</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit low storage Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
        <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">ls_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">ls_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls_rk_stages</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 8 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">9</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 9 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 10 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">11</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 11 stages not yet implemented</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">ls_rk_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">ls_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of TVD/SSP Runge-Kutta solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;tvd-runge-kutta&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tvd_rk_stages</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit TVD/SSP Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">tvd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">tvd_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tvd_rk_stages</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">tvd_rk_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">tvd_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s2">&quot;Solver &amp; Time Step &amp; f*Dt &amp; Error X &amp; Error Y &amp; Observed Order of Accuracy X &amp; Observed Order of Accuracy Y&quot;</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adams-bashforth&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">ab_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">ab_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adams-bashforth-moulton&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">abm_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">abm_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adams-moulton&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">am_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">am_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;bdf&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">bdf_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">bdf_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;emd-runge-kutta&#39;</span><span class="p">,</span> <span class="n">mean_time_steps</span><span class="o">=</span><span class="n">emd_Dt_mean</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">emd_rk_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">emd_rk_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;leapfrog&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">lf_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">lf_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;ls-runge-kutta&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">ls_rk_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">ls_rk_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;tvd-runge-kutta&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">tvd_rk_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">tvd_rk_orders</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">perform_errors_analysis</span>

  <span class="k">function </span><span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">error_L2</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the L2 norm of numerical error with respect the exact solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>             <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">error_L2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span> <span class="c">!&lt; L2 norm of the numerical error.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span>   <span class="c">!&lt; Exact solution.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">s</span>                           <span class="c">!&lt; Steps/stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">v</span>                           <span class="c">!&lt; Variables counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">error_L2</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ubound</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ex_sol</span> <span class="o">=</span> <span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">do </span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_dimension</span>
      <span class="n">error_L2</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">error_L2</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="n">ex_sol</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="n">error_L2</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">error_L2</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">compute_errors</span>

  <span class="k">function </span><span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="p">,</span> <span class="n">Dt_used</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Estimate the order of accuracy using 2 subsequent refined numerical solutions.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solver_error</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Computed errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Dt_used</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>                         <span class="c">!&lt; Time steps used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">order</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span>             <span class="c">!&lt; Estimation of the order of accuracy.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">v</span>                                    <span class="c">!&lt; Variables counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">do </span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_dimension</span>
    <span class="n">order</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">log</span><span class="p">(</span><span class="n">solver_error</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">solver_error</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="nb">log</span><span class="p">(</span><span class="n">Dt_used</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">Dt_used</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">estimate_orders</span>

  <span class="k">subroutine </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">,</span> <span class="n">mean_time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">orders</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Print summary of the error analysis.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solver</span>               <span class="c">!&lt; Solver name.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">time_steps</span><span class="p">(:)</span>        <span class="c">!&lt; Time steps exercised.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mean_time_steps</span><span class="p">(:,:)</span> <span class="c">!&lt; Mean time steps exercised.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">errors</span><span class="p">(:,:,:)</span>        <span class="c">!&lt; Errors of the solver.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">orders</span><span class="p">(:,:,:)</span>        <span class="c">!&lt; Observed orders of the solver.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">s</span>                    <span class="c">!&lt; Solver index.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">d</span>                    <span class="c">!&lt; Time steps-exercised counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">time_steps</span><span class="p">))</span> <span class="k">then</span>
<span class="k">    do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0._R_P</span><span class="p">)</span> <span class="k">cycle</span>
<span class="k">      print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">solver</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
      <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A)&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; / &amp; /&quot;</span>
        <span class="k">else</span>
<span class="k">          print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A,F9.2,A,F9.2)&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="n">orders</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">orders</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">endif</span>
      <span class="n">enddo</span>
    <span class="n">enddo</span>
  <span class="n">elseif</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">mean_time_steps</span><span class="p">))</span> <span class="k">then</span>
<span class="k">    do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0._R_P</span><span class="p">)</span> <span class="k">cycle</span>
<span class="k">      print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">solver</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
      <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">          print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A)&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">mean_time_steps</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">mean_time_steps</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; / &amp; /&quot;</span>
        <span class="k">else</span>
<span class="k">          print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A,F9.2,A,F9.2)&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">mean_time_steps</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">mean_time_steps</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
            <span class="n">orders</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">orders</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">endif</span>
      <span class="n">enddo</span>
    <span class="n">enddo</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">print_analysis</span>
<span class="n">endprogram</span> <span class="n">integrate_oscillation</span>
</pre></div>

    </section>
    
    
    </div>
  </div>

    <hr>
    <footer>
        <div class="row">
        <div class="col-md-4">&copy; 2016 </div>
	<div class="col-md-4"><span class="text-center"> FOODIE was developed by Fortran-FOSS-Programmers Group</span></div>
        <div class="col-md-4"><span class="pull-right">Documentation generated by <a href="https://github.com/cmacmackin/ford">FORD</a></span></div>
        </div>
        <br>
    </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>