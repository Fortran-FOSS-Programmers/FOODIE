<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Fortran Object oriented Ordinary Differential Equations integration library">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>integrate_oscillation &ndash; FOODiE</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FOODiE </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
                
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
				
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>integrate_oscillation 
    <small>Program</small>
    
    </h1>
	 
<div class="row">
<div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
    <li><i class="fa fa-code"></i><a href="../src/oscillation.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/oscillation.f90.html'>oscillation.f90</a></li>
  
     <li class="active">integrate_oscillation</li>
  </ol>
</div>
</div>
</div>
    
  </div>
  
  <div class="row">
    <div class="col-lg-3">
    
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Variables</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-cli%7E5">cli</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-space_dimension%7E2">space_dimension</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-initial_state%7E10">initial_state</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-f%7E5">f</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-t_final%7E4">t_final</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-dt%7E10">Dt</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-error%7E5">error</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-stages_steps%7E2">stages_steps</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-implicit_iterations">implicit_iterations</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-solver%7E5">solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-plots%7E5">plots</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-results%7E5">results</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-output_cli%7E2">output_cli</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-errors_analysis">errors_analysis</a>
      
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Functions</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-exact_solution">exact_solution</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-compute_errors">compute_errors</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-estimate_orders">estimate_orders</a>
      
    </div>
  </div>
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Subroutines</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-init%7E14">init</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-save_results%7E5">save_results</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_ab%7E4">test_ab</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_abm">test_abm</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_am">test_am</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_euler%7E4">test_euler</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_leapfrog%7E4">test_leapfrog</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_ls_rk%7E4">test_ls_rk</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_tvd_rk%7E4">test_tvd_rk</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-ab_solver">ab_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-abm_solver">abm_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-am_solver">am_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-euler_solver">euler_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-leapfrog_solver">leapfrog_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-ls_rk_solver">ls_rk_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-tvd_rk_solver">tvd_rk_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-perform_errors_analysis">perform_errors_analysis</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-print_analysis">print_analysis</a>
      
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
    <div class="list-group">
      <a class="list-group-item" href="../program/integrate_oscillation.html#src">integrate_oscillation</a>
    </div>
  </div>
  
  <hr>
  
  <div class="panel panel-default">
    <div class="panel-heading text-left"><h3 class="panel-title">All Programs</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_burgers.html">integrate_burgers</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d.html">integrate_euler_1D</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_openmp.html">integrate_euler_1D_openmp</a>
      
      <a class="list-group-item" href="../program/integrate_lorenz.html">integrate_lorenz</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html">integrate_oscillation</a>
      
    </div>
  </div>
  
  
    </div>
    
    <div class="col-lg-9" id='text'>
    
  
    <ul class="list-inline">
      <li><h4>Uses:</h4></li>
      
      <li>IR_Precision</li>
      
      <li><a href='../module/type_oscillation.html'>type_oscillation</a></li>
      
      <li>Data_Type_Command_Line_Interface</li>
      
      <li><a href='../module/foodie.html'>foodie</a></li>
      
      <li>pyplot_module</li>
      
    </ul>
  

    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: program~~integrate_oscillation~~UsesGraph Pages: 1 -->
<svg id="programintegrate_oscillationUsesGraph" width="641pt" height="171pt"
 viewBox="0.00 0.00 641.00 170.86" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~integrate_oscillation~~UsesGraph" class="graph" transform="scale(0.517771 0.517771) rotate(0) translate(4 326)">
<title>program~~integrate_oscillation~~UsesGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-326 1235,-326 1235,5 -4,5"/>
<!-- program~integrate_oscillation -->
<g id="node1" class="node"><title>program~integrate_oscillation</title>
<polygon fill="none" stroke="black" points="1229,-165 1123,-165 1123,-139 1229,-139 1229,-165"/>
<text text-anchor="middle" x="1176" y="-149.55" font-family="Helvetica,sans-Serif" font-size="10.50">integrate_oscillation</text>
</g>
<!-- IR_Precision -->
<g id="node2" class="node"><title>IR_Precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="853,-237 781,-237 781,-211 853,-211 853,-237"/>
<text text-anchor="middle" x="817" y="-221.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">IR_Precision</text>
</g>
<!-- IR_Precision&#45;&gt;program~integrate_oscillation -->
<g id="edge58" class="edge"><title>IR_Precision&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M853.835,-229.233C906.755,-235.327 1006.66,-241.477 1086,-215 1112.43,-206.18 1138.01,-186.909 1155.09,-171.988"/>
<polygon fill="black" stroke="black" points="1157.68,-174.371 1162.77,-165.078 1152.99,-169.169 1157.68,-174.371"/>
</g>
<!-- module~type_oscillation -->
<g id="node4" class="node"><title>module~type_oscillation</title>
<a xlink:href="../module/type_oscillation.html" xlink:title="type_oscillation">
<polygon fill="#337ab7" stroke="#337ab7" points="1030,-206 946,-206 946,-180 1030,-180 1030,-206"/>
<text text-anchor="middle" x="988" y="-190.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">type_oscillation</text>
</a>
</g>
<!-- IR_Precision&#45;&gt;module~type_oscillation -->
<g id="edge54" class="edge"><title>IR_Precision&#45;&gt;module~type_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M853.684,-217.35C877.527,-213.027 908.987,-207.324 935.466,-202.524"/>
<polygon fill="black" stroke="black" points="936.129,-205.961 945.344,-200.733 934.88,-199.073 936.129,-205.961"/>
</g>
<!-- module~foodie -->
<g id="node3" class="node"><title>module~foodie</title>
<a xlink:href="../module/foodie.html" xlink:title="foodie">
<polygon fill="#337ab7" stroke="#337ab7" points="844,-174 790,-174 790,-148 844,-148 844,-174"/>
<text text-anchor="middle" x="817" y="-158.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie</text>
</a>
</g>
<!-- module~foodie&#45;&gt;program~integrate_oscillation -->
<g id="edge60" class="edge"><title>module~foodie&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M844.278,-160.316C900.888,-158.897 1032.46,-155.599 1111.83,-153.609"/>
<polygon fill="black" stroke="black" points="1112.29,-157.098 1122.2,-153.349 1112.11,-150.101 1112.29,-157.098"/>
</g>
<!-- module~foodie&#45;&gt;module~type_oscillation -->
<g id="edge56" class="edge"><title>module~foodie&#45;&gt;module~type_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M844.095,-166.07C868.548,-170.646 905.208,-177.507 935.406,-183.158"/>
<polygon fill="black" stroke="black" points="934.899,-186.624 945.372,-185.023 936.187,-179.743 934.899,-186.624"/>
</g>
<!-- module~type_oscillation&#45;&gt;program~integrate_oscillation -->
<g id="edge62" class="edge"><title>module~type_oscillation&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1030.66,-183.696C1054.77,-178.438 1085.39,-171.762 1112.29,-165.894"/>
<polygon fill="black" stroke="black" points="1113.38,-169.24 1122.4,-163.689 1111.88,-162.401 1113.38,-169.24"/>
</g>
<!-- pyplot_module -->
<g id="node5" class="node"><title>pyplot_module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="1029,-124 947,-124 947,-98 1029,-98 1029,-124"/>
<text text-anchor="middle" x="988" y="-108.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pyplot_module</text>
</g>
<!-- pyplot_module&#45;&gt;program~integrate_oscillation -->
<g id="edge64" class="edge"><title>pyplot_module&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1029.26,-119.998C1053.61,-125.309 1084.95,-132.144 1112.41,-138.132"/>
<polygon fill="black" stroke="black" points="1111.82,-141.585 1122.33,-140.296 1113.31,-134.745 1111.82,-141.585"/>
</g>
<!-- Data_Type_Command_Line_Interface -->
<g id="node6" class="node"><title>Data_Type_Command_Line_Interface</title>
<polygon fill="#337ab7" stroke="#337ab7" points="1085,-80 891,-80 891,-54 1085,-54 1085,-80"/>
<text text-anchor="middle" x="988" y="-64.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Data_Type_Command_Line_Interface</text>
</g>
<!-- Data_Type_Command_Line_Interface&#45;&gt;program~integrate_oscillation -->
<g id="edge66" class="edge"><title>Data_Type_Command_Line_Interface&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1061.01,-80.0453C1069.6,-82.5531 1078.1,-85.5137 1086,-89 1110.89,-99.9895 1135.99,-118.295 1153.33,-132.349"/>
<polygon fill="black" stroke="black" points="1151.26,-135.174 1161.19,-138.857 1155.72,-129.783 1151.26,-135.174"/>
</g>
<!-- module~foodie_integrator_adams_bashforth -->
<g id="node7" class="node"><title>module~foodie_integrator_adams_bashforth</title>
<a xlink:href="../module/foodie_integrator_adams_bashforth.html" xlink:title="foodie_integrator_adams_bashforth">
<polygon fill="#337ab7" stroke="#337ab7" points="461,-234 279,-234 279,-208 461,-208 461,-234"/>
<text text-anchor="middle" x="370" y="-218.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_adams_bashforth</text>
</a>
</g>
<!-- module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie -->
<g id="edge38" class="edge"><title>module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M438.408,-234.002C512.278,-247.827 620.722,-267.407 630,-265"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M630,-265C693.315,-248.578 757.998,-205.546 792.215,-180.278"/>
<polygon fill="black" stroke="black" points="794.336,-183.063 800.238,-174.264 790.138,-177.462 794.336,-183.063"/>
</g>
<!-- module~foodie_integrator_adams_bashforth_moulton -->
<g id="node10" class="node"><title>module~foodie_integrator_adams_bashforth_moulton</title>
<a xlink:href="../module/foodie_integrator_adams_bashforth_moulton.html" xlink:title="foodie_integrator_adams_bashforth_moulton">
<polygon fill="#337ab7" stroke="#337ab7" points="743,-174 517,-174 517,-148 743,-148 743,-174"/>
<text text-anchor="middle" x="630" y="-158.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_adams_bashforth_moulton</text>
</a>
</g>
<!-- module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie_integrator_adams_bashforth_moulton -->
<g id="edge18" class="edge"><title>module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie_integrator_adams_bashforth_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M426.416,-207.981C466.652,-198.696 520.91,-186.175 563.294,-176.394"/>
<polygon fill="black" stroke="black" points="564.289,-179.756 573.246,-174.097 562.715,-172.935 564.289,-179.756"/>
</g>
<!-- module~foodie_integrator_tvd_runge_kutta -->
<g id="node8" class="node"><title>module~foodie_integrator_tvd_runge_kutta</title>
<a xlink:href="../module/foodie_integrator_tvd_runge_kutta.html" xlink:title="foodie_integrator_tvd_runge_kutta">
<polygon fill="#337ab7" stroke="#337ab7" points="458,-278 282,-278 282,-252 458,-252 458,-278"/>
<text text-anchor="middle" x="370" y="-262.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_tvd_runge_kutta</text>
</a>
</g>
<!-- module~foodie_integrator_tvd_runge_kutta&#45;&gt;module~foodie -->
<g id="edge40" class="edge"><title>module~foodie_integrator_tvd_runge_kutta&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M458.653,-275.922C509.58,-279.506 574.291,-279.449 630,-265"/>
</g>
<!-- module~foodie_adt_integrand -->
<g id="node9" class="node"><title>module~foodie_adt_integrand</title>
<a xlink:href="../module/foodie_adt_integrand.html" xlink:title="foodie_adt_integrand">
<polygon fill="#337ab7" stroke="#337ab7" points="224,-155 110,-155 110,-129 224,-129 224,-155"/>
<text text-anchor="middle" x="167" y="-139.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_adt_integrand</text>
</a>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie -->
<g id="edge42" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224.313,-142.088C264.974,-142.129 320.836,-142.142 370,-142"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M370,-142C485.968,-141.665 516.065,-98.38 630,-120"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_bashforth -->
<g id="edge4" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_bashforth</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M200.521,-155.045C235.049,-168.482 288.999,-189.477 326.728,-204.16"/>
<polygon fill="black" stroke="black" points="325.84,-207.57 336.429,-207.935 328.379,-201.047 325.84,-207.57"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_tvd_runge_kutta -->
<g id="edge8" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_tvd_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M178.253,-155.101C200.712,-181.113 249.818,-237.278 260,-243 263.772,-245.12 267.718,-247.038 271.78,-248.772"/>
<polygon fill="black" stroke="black" points="270.848,-252.164 281.438,-252.496 273.366,-245.633 270.848,-252.164"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_bashforth_moulton -->
<g id="edge16" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_bashforth_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M370,-142C414.414,-141.872 462.983,-144.634 505.994,-148.089"/>
<polygon fill="black" stroke="black" points="505.973,-151.599 516.227,-148.932 506.548,-144.623 505.973,-151.599"/>
</g>
<!-- module~foodie_integrator_euler_explicit -->
<g id="node11" class="node"><title>module~foodie_integrator_euler_explicit</title>
<a xlink:href="../module/foodie_integrator_euler_explicit.html" xlink:title="foodie_integrator_euler_explicit">
<polygon fill="#337ab7" stroke="#337ab7" points="451,-70 289,-70 289,-44 451,-44 451,-70"/>
<text text-anchor="middle" x="370" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_euler_explicit</text>
</a>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_euler_explicit -->
<g id="edge22" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_euler_explicit</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M182.329,-128.75C199.899,-114.278 230.137,-91.4992 260,-79 266.156,-76.4234 272.635,-74.1424 279.239,-72.124"/>
<polygon fill="black" stroke="black" points="280.323,-75.4546 288.984,-69.351 278.407,-68.7219 280.323,-75.4546"/>
</g>
<!-- module~foodie_integrator_adams_moulton -->
<g id="node12" class="node"><title>module~foodie_integrator_adams_moulton</title>
<a xlink:href="../module/foodie_integrator_adams_moulton.html" xlink:title="foodie_integrator_adams_moulton">
<polygon fill="#337ab7" stroke="#337ab7" points="458,-114 282,-114 282,-88 458,-88 458,-114"/>
<text text-anchor="middle" x="370" y="-98.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_adams_moulton</text>
</a>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_moulton -->
<g id="edge26" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224.087,-130.47C246.251,-125.994 271.935,-120.806 295.519,-116.043"/>
<polygon fill="black" stroke="black" points="296.373,-119.441 305.482,-114.031 294.987,-112.58 296.373,-119.441"/>
</g>
<!-- module~foodie_integrator_leapfrog -->
<g id="node13" class="node"><title>module~foodie_integrator_leapfrog</title>
<a xlink:href="../module/foodie_integrator_leapfrog.html" xlink:title="foodie_integrator_leapfrog">
<polygon fill="#337ab7" stroke="#337ab7" points="439,-322 301,-322 301,-296 439,-296 439,-322"/>
<text text-anchor="middle" x="370" y="-306.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_leapfrog</text>
</a>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_leapfrog -->
<g id="edge30" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_leapfrog</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M180.983,-155.474C193.412,-167.985 211.5,-187.558 224,-207 245.086,-239.796 229.504,-262.706 260,-287 268.954,-294.133 279.596,-299.15 290.678,-302.647"/>
<polygon fill="black" stroke="black" points="289.929,-306.071 300.499,-305.344 291.782,-299.321 289.929,-306.071"/>
</g>
<!-- module~foodie_integrator_low_storage_runge_kutta -->
<g id="node14" class="node"><title>module~foodie_integrator_low_storage_runge_kutta</title>
<a xlink:href="../module/foodie_integrator_low_storage_runge_kutta.html" xlink:title="foodie_integrator_low_storage_runge_kutta">
<polygon fill="#337ab7" stroke="#337ab7" points="480,-26 260,-26 260,-1.24345e-14 480,-3.55271e-15 480,-26"/>
<text text-anchor="middle" x="370" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_low_storage_runge_kutta</text>
</a>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_low_storage_runge_kutta -->
<g id="edge36" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_low_storage_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M184.961,-128.883C196.865,-119.658 212.372,-106.58 224,-93 243.733,-69.9542 235.069,-52.2897 260,-35 262.284,-33.4159 264.656,-31.94 267.098,-30.5652"/>
<polygon fill="black" stroke="black" points="268.831,-33.6122 276.217,-26.0169 265.706,-27.3481 268.831,-33.6122"/>
</g>
<!-- module~foodie_integrator_adams_bashforth_moulton&#45;&gt;module~foodie -->
<g id="edge44" class="edge"><title>module~foodie_integrator_adams_bashforth_moulton&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M743.629,-161C756.478,-161 768.794,-161 779.544,-161"/>
<polygon fill="black" stroke="black" points="779.734,-164.5 789.734,-161 779.734,-157.5 779.734,-164.5"/>
</g>
<!-- module~foodie_integrator_euler_explicit&#45;&gt;module~foodie -->
<g id="edge46" class="edge"><title>module~foodie_integrator_euler_explicit&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M439.107,-70.0586C452.7,-72.842 466.828,-75.8865 480,-79 547.259,-94.8977 562.099,-107.115 630,-120"/>
</g>
<!-- module~foodie_integrator_adams_moulton&#45;&gt;module~foodie -->
<g id="edge48" class="edge"><title>module~foodie_integrator_adams_moulton&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M458.207,-102.436C508.845,-104.506 573.417,-109.263 630,-120"/>
</g>
<!-- module~foodie_integrator_adams_moulton&#45;&gt;module~foodie_integrator_adams_bashforth_moulton -->
<g id="edge14" class="edge"><title>module~foodie_integrator_adams_moulton&#45;&gt;module~foodie_integrator_adams_bashforth_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M426.416,-114.019C466.652,-123.304 520.91,-135.825 563.294,-145.606"/>
<polygon fill="black" stroke="black" points="562.715,-149.065 573.246,-147.903 564.289,-142.244 562.715,-149.065"/>
</g>
<!-- module~foodie_integrator_leapfrog&#45;&gt;module~foodie -->
<g id="edge50" class="edge"><title>module~foodie_integrator_leapfrog&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M439.66,-300.532C492.414,-293.322 566.409,-281.494 630,-265"/>
</g>
<!-- module~foodie_integrator_low_storage_runge_kutta&#45;&gt;module~foodie -->
<g id="edge52" class="edge"><title>module~foodie_integrator_low_storage_runge_kutta&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450.736,-26.0605C460.727,-28.5756 470.692,-31.5339 480,-35 551.809,-61.7404 554.717,-105.715 630,-120"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M630,-120C680.465,-129.576 693.975,-127.343 744,-139 755.865,-141.765 768.634,-145.385 780.124,-148.889"/>
<polygon fill="black" stroke="black" points="779.249,-152.282 789.837,-151.913 781.33,-145.598 779.249,-152.282"/>
</g>
<!-- module~foodie_kinds -->
<g id="node15" class="node"><title>module~foodie_kinds</title>
<a xlink:href="../module/foodie_kinds.html" xlink:title="foodie_kinds">
<polygon fill="#337ab7" stroke="#337ab7" points="73,-155 1,-155 1,-129 73,-129 73,-155"/>
<text text-anchor="middle" x="37" y="-139.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_kinds</text>
</a>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth -->
<g id="edge2" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-221C198.89,-231.882 235.275,-234.635 268.349,-233.814"/>
<polygon fill="black" stroke="black" points="268.631,-237.306 278.499,-233.45 268.38,-230.311 268.631,-237.306"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_tvd_runge_kutta -->
<g id="edge6" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_tvd_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-221C203.032,-233.295 243.869,-242.932 279.421,-250.013"/>
<polygon fill="black" stroke="black" points="278.814,-253.46 289.3,-251.942 280.156,-246.59 278.814,-253.46"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_adt_integrand -->
<g id="edge10" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_adt_integrand</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M73.5582,-142C81.7428,-142 90.6769,-142 99.6705,-142"/>
<polygon fill="black" stroke="black" points="99.8131,-145.5 109.813,-142 99.8131,-138.5 99.8131,-145.5"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth_moulton -->
<g id="edge12" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53.4603,-155.305C77.0385,-173.556 122.509,-205.819 167,-221"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-221C207.198,-234.716 218.119,-206.074 260,-199 341.488,-185.237 433.972,-175.738 506.092,-169.679"/>
<polygon fill="black" stroke="black" points="506.454,-173.161 516.13,-168.847 505.875,-166.185 506.454,-173.161"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_euler_explicit -->
<g id="edge20" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_euler_explicit</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-79C202.663,-68.76 243.099,-63.2158 278.442,-60.2393"/>
<polygon fill="black" stroke="black" points="279.055,-63.7021 288.75,-59.4309 278.507,-56.7235 279.055,-63.7021"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_moulton -->
<g id="edge24" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-79C189.816,-72.4489 244.316,-78.7729 291.105,-86.2939"/>
<polygon fill="black" stroke="black" points="290.829,-89.7955 301.265,-87.9642 291.965,-82.8882 290.829,-89.7955"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_leapfrog -->
<g id="edge28" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_leapfrog</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-221C214.969,-237.368 213.462,-266.923 260,-287 269.554,-291.122 279.911,-294.481 290.32,-297.217"/>
<polygon fill="black" stroke="black" points="289.746,-300.68 300.291,-299.654 291.407,-293.88 289.746,-300.68"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_low_storage_runge_kutta -->
<g id="edge32" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_low_storage_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58.1668,-128.907C83.1712,-114.126 126.502,-90.6283 167,-79"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-79C210.95,-66.3806 216.59,-49.3688 260,-35 267.28,-32.5903 274.923,-30.4014 282.645,-28.4224"/>
<polygon fill="black" stroke="black" points="283.563,-31.801 292.446,-26.0271 281.901,-25.0011 283.563,-31.801"/>
</g>
<!-- iso_fortran_env -->
<g id="node31" class="node"><title>iso_fortran_env</title>
<a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="210,-26 124,-26 124,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="167" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
<!-- iso_fortran_env&#45;&gt;module~foodie_integrator_low_storage_runge_kutta -->
<g id="edge34" class="edge"><title>iso_fortran_env&#45;&gt;module~foodie_integrator_low_storage_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M210.549,-13C222.361,-13 235.747,-13 249.622,-13"/>
<polygon fill="black" stroke="black" points="249.795,-16.5001 259.795,-13 249.795,-9.5001 249.795,-16.5001"/>
</g>
</g>
</svg>
</div>
                <script>var panprogramintegrate_oscillationUsesGraph = svgPanZoom('#programintegrate_oscillationUsesGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
    <br><br>
    <p>Test FOODiE with the integration of Oscillation equations.</p>
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: program~~integrate_oscillation~~CallsGraph Pages: 1 -->
<svg id="programintegrate_oscillationCallsGraph" width="526pt" height="812pt"
 viewBox="0.00 0.00 526.00 811.69" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~integrate_oscillation~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 807.689)">
<title>program~~integrate_oscillation~~CallsGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-807.689 523,-807.689 523,5 -4,5"/>
<!-- program~integrate_oscillation -->
<g id="node1" class="node"><title>program~integrate_oscillation</title>
<polygon fill="none" stroke="black" points="107,-332 1,-332 1,-306 107,-306 107,-332"/>
<text text-anchor="middle" x="54" y="-316.55" font-family="Helvetica,sans-Serif" font-size="10.50">integrate_oscillation</text>
</g>
<!-- proc~perform_errors_analysis -->
<g id="node2" class="node"><title>proc~perform_errors_analysis</title>
<a xlink:href="../proc/perform_errors_analysis.html" xlink:title="perform_errors_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="273,-483 145,-483 145,-457 273,-457 273,-483"/>
<text text-anchor="middle" x="209" y="-467.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">perform_errors_analysis</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~perform_errors_analysis -->
<g id="edge92" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~perform_errors_analysis</title>
<path fill="none" stroke="black" d="M67.4002,-332.138C84.9679,-349.354 116.754,-380.476 144,-407 158.734,-421.343 175.387,-437.482 188.148,-449.834"/>
<polygon fill="black" stroke="black" points="185.918,-452.547 195.539,-456.986 190.786,-447.517 185.918,-452.547"/>
</g>
<!-- proc~test_tvd_rk~4 -->
<g id="node3" class="node"><title>proc~test_tvd_rk~4</title>
<a xlink:href="../proc/test_tvd_rk%7E4.html" xlink:title="test_tvd_rk">
<polygon fill="#d9534f" stroke="#d9534f" points="241,-310 177,-310 177,-284 241,-284 241,-310"/>
<text text-anchor="middle" x="209" y="-294.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_tvd_rk</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_tvd_rk~4 -->
<g id="edge94" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_tvd_rk~4</title>
<path fill="none" stroke="black" d="M107.776,-311.367C126.869,-308.657 148.088,-305.646 166.146,-303.082"/>
<polygon fill="black" stroke="black" points="166.687,-306.541 176.096,-301.67 165.703,-299.61 166.687,-306.541"/>
</g>
<!-- proc~test_leapfrog~4 -->
<g id="node4" class="node"><title>proc~test_leapfrog~4</title>
<a xlink:href="../proc/test_leapfrog%7E4.html" xlink:title="test_leapfrog">
<polygon fill="#d9534f" stroke="#d9534f" points="246,-266 172,-266 172,-240 246,-240 246,-266"/>
<text text-anchor="middle" x="209" y="-250.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_leapfrog</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_leapfrog~4 -->
<g id="edge96" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_leapfrog~4</title>
<path fill="none" stroke="black" d="M78.4398,-305.992C96.324,-296.735 121.323,-284.336 144,-275 149.575,-272.705 155.487,-270.457 161.383,-268.328"/>
<polygon fill="black" stroke="black" points="162.956,-271.486 171.231,-264.869 160.636,-264.881 162.956,-271.486"/>
</g>
<!-- proc~test_ls_rk~4 -->
<g id="node5" class="node"><title>proc~test_ls_rk~4</title>
<a xlink:href="../proc/test_ls_rk%7E4.html" xlink:title="test_ls_rk">
<polygon fill="#d9534f" stroke="#d9534f" points="238,-398 180,-398 180,-372 238,-372 238,-398"/>
<text text-anchor="middle" x="209" y="-382.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_ls_rk</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_ls_rk~4 -->
<g id="edge98" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_ls_rk~4</title>
<path fill="none" stroke="black" d="M78.4398,-332.008C96.324,-341.265 121.323,-353.664 144,-363 152.404,-366.46 161.572,-369.812 170.302,-372.812"/>
<polygon fill="black" stroke="black" points="169.314,-376.172 179.908,-376.037 171.542,-369.536 169.314,-376.172"/>
</g>
<!-- proc~test_am -->
<g id="node6" class="node"><title>proc~test_am</title>
<a xlink:href="../proc/test_am.html" xlink:title="test_am">
<polygon fill="#d9534f" stroke="#d9534f" points="236,-354 182,-354 182,-328 236,-328 236,-354"/>
<text text-anchor="middle" x="209" y="-338.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_am</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_am -->
<g id="edge100" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_am</title>
<path fill="none" stroke="black" d="M107.776,-326.633C128.876,-329.628 152.572,-332.991 171.73,-335.71"/>
<polygon fill="black" stroke="black" points="171.468,-339.208 181.861,-337.148 172.452,-332.277 171.468,-339.208"/>
</g>
<!-- proc~test_ab~4 -->
<g id="node7" class="node"><title>proc~test_ab~4</title>
<a xlink:href="../proc/test_ab%7E4.html" xlink:title="test_ab">
<polygon fill="#d9534f" stroke="#d9534f" points="236,-527 182,-527 182,-501 236,-501 236,-527"/>
<text text-anchor="middle" x="209" y="-511.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_ab</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_ab~4 -->
<g id="edge102" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_ab~4</title>
<path fill="none" stroke="black" d="M57.2662,-332.423C65.8034,-364.696 91.8226,-447.267 144,-492 151.937,-498.804 162.07,-503.529 171.96,-506.8"/>
<polygon fill="black" stroke="black" points="171.102,-510.195 181.68,-509.61 173.046,-503.47 171.102,-510.195"/>
</g>
<!-- proc~test_euler~4 -->
<g id="node8" class="node"><title>proc~test_euler~4</title>
<a xlink:href="../proc/test_euler%7E4.html" xlink:title="test_euler">
<polygon fill="#d9534f" stroke="#d9534f" points="239,-178 179,-178 179,-152 239,-152 239,-178"/>
<text text-anchor="middle" x="209" y="-162.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_euler</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_euler~4 -->
<g id="edge104" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_euler~4</title>
<path fill="none" stroke="black" d="M59.5572,-305.658C71.2513,-279.174 100.922,-219.705 144,-187 151.456,-181.339 160.459,-177.081 169.357,-173.897"/>
<polygon fill="black" stroke="black" points="170.433,-177.228 178.892,-170.849 168.301,-170.56 170.433,-177.228"/>
</g>
<!-- proc~test_abm -->
<g id="node9" class="node"><title>proc~test_abm</title>
<a xlink:href="../proc/test_abm.html" xlink:title="test_abm">
<polygon fill="#d9534f" stroke="#d9534f" points="237,-222 181,-222 181,-196 237,-196 237,-222"/>
<text text-anchor="middle" x="209" y="-206.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_abm</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_abm -->
<g id="edge106" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_abm</title>
<path fill="none" stroke="black" d="M64.2215,-305.776C79.5976,-286.719 110.471,-251.569 144,-231 152.129,-226.013 161.529,-221.994 170.611,-218.825"/>
<polygon fill="black" stroke="black" points="171.821,-222.112 180.266,-215.714 169.674,-215.45 171.821,-222.112"/>
</g>
<!-- proc~ab_solver -->
<g id="node10" class="node"><title>proc~ab_solver</title>
<a xlink:href="../proc/ab_solver.html" xlink:title="ab_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="384,-776 326,-776 326,-750 384,-750 384,-776"/>
<text text-anchor="middle" x="355" y="-760.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ab_solver</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~ab_solver -->
<g id="edge12" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~ab_solver</title>
<path fill="none" stroke="black" d="M263.829,-483.119C267.636,-485.588 271.104,-488.52 274,-492 345.521,-577.953 244.139,-650.637 310,-741 311.946,-743.67 314.306,-746.033 316.915,-748.12"/>
<polygon fill="black" stroke="black" points="315.026,-751.067 325.317,-753.587 318.844,-745.2 315.026,-751.067"/>
</g>
<!-- proc~init~14 -->
<g id="node11" class="node"><title>proc~init~14</title>
<a xlink:href="../proc/init%7E14.html" xlink:title="init">
<polygon fill="#d9534f" stroke="#d9534f" points="382,-184 328,-184 328,-158 382,-158 382,-184"/>
<text text-anchor="middle" x="355" y="-168.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~init~14 -->
<g id="edge14" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~init~14</title>
<path fill="none" stroke="black" d="M228.168,-456.816C243.146,-445.428 263.18,-427.589 274,-407 318.866,-321.623 252.296,-270.281 310,-193 312.447,-189.723 315.514,-186.907 318.89,-184.494"/>
<polygon fill="black" stroke="black" points="320.894,-187.376 327.743,-179.292 317.348,-181.341 320.894,-187.376"/>
</g>
<!-- proc~am_solver -->
<g id="node12" class="node"><title>proc~am_solver</title>
<a xlink:href="../proc/am_solver.html" xlink:title="am_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="386,-518 324,-518 324,-492 386,-492 386,-518"/>
<text text-anchor="middle" x="355" y="-502.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">am_solver</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~am_solver -->
<g id="edge16" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~am_solver</title>
<path fill="none" stroke="black" d="M263.365,-483.033C280.125,-487.05 298.288,-491.405 313.991,-495.169"/>
<polygon fill="black" stroke="black" points="313.374,-498.62 323.914,-497.548 315.006,-491.813 313.374,-498.62"/>
</g>
<!-- proc~abm_solver -->
<g id="node13" class="node"><title>proc~abm_solver</title>
<a xlink:href="../proc/abm_solver.html" xlink:title="abm_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="389,-228 321,-228 321,-202 389,-202 389,-228"/>
<text text-anchor="middle" x="355" y="-212.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">abm_solver</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~abm_solver -->
<g id="edge18" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~abm_solver</title>
<path fill="none" stroke="black" d="M226.237,-456.894C240.662,-445.165 260.928,-426.805 274,-407 298.643,-369.663 292.657,-354.238 310,-313 321.052,-286.721 334.877,-257.031 344.267,-237.286"/>
<polygon fill="black" stroke="black" points="347.458,-238.726 348.611,-228.194 341.142,-235.708 347.458,-238.726"/>
</g>
<!-- str -->
<g id="node14" class="node"><title>str</title>
<polygon fill="#777777" stroke="#777777" points="504,-288 450,-288 450,-262 504,-262 504,-288"/>
<text text-anchor="middle" x="477" y="-272.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">str</text>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;str -->
<g id="edge20" class="edge"><title>proc~perform_errors_analysis&#45;&gt;str</title>
<path fill="none" stroke="black" d="M262.377,-483.029C266.653,-485.515 270.619,-488.475 274,-492 313.43,-533.106 264.416,-580.845 310,-615 342.011,-638.985 368.748,-639.966 400,-615 425.244,-594.834 461.949,-371.746 473.431,-298.295"/>
<polygon fill="black" stroke="black" points="476.92,-298.632 474.995,-288.214 470.003,-297.559 476.92,-298.632"/>
</g>
<!-- proc~save_results~5 -->
<g id="node15" class="node"><title>proc~save_results~5</title>
<a xlink:href="../proc/save_results%7E5.html" xlink:title="save_results">
<polygon fill="#d9534f" stroke="#d9534f" points="391,-348 319,-348 319,-322 391,-322 391,-348"/>
<text text-anchor="middle" x="355" y="-332.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_results</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~save_results~5 -->
<g id="edge22" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M223.933,-456.926C237.606,-444.64 258.076,-425.433 274,-407 291.901,-386.279 289.07,-374.656 310,-357 311.496,-355.738 313.076,-354.529 314.714,-353.371"/>
<polygon fill="black" stroke="black" points="316.645,-356.292 323.27,-348.025 312.935,-350.356 316.645,-356.292"/>
</g>
<!-- proc~ls_rk_solver -->
<g id="node16" class="node"><title>proc~ls_rk_solver</title>
<a xlink:href="../proc/ls_rk_solver.html" xlink:title="ls_rk_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-562 320,-562 320,-536 390,-536 390,-562"/>
<text text-anchor="middle" x="355" y="-546.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ls_rk_solver</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~ls_rk_solver -->
<g id="edge24" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~ls_rk_solver</title>
<path fill="none" stroke="black" d="M255.95,-483.068C262.222,-485.617 268.41,-488.582 274,-492 293.038,-503.642 291.748,-514.161 310,-527 311.849,-528.301 313.787,-529.564 315.776,-530.785"/>
<polygon fill="black" stroke="black" points="314.286,-533.963 324.713,-535.841 317.733,-527.87 314.286,-533.963"/>
</g>
<!-- proc~print_analysis -->
<g id="node17" class="node"><title>proc~print_analysis</title>
<a xlink:href="../proc/print_analysis.html" xlink:title="print_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="394,-606 316,-606 316,-580 394,-580 394,-606"/>
<text text-anchor="middle" x="355" y="-590.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_analysis</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~print_analysis -->
<g id="edge26" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~print_analysis</title>
<path fill="none" stroke="black" d="M260.898,-483.043C265.638,-485.529 270.111,-488.486 274,-492 302.629,-517.868 283.089,-543.349 310,-571 310.921,-571.946 311.891,-572.858 312.902,-573.736"/>
<polygon fill="black" stroke="black" points="311.129,-576.774 321.28,-579.81 315.238,-571.106 311.129,-576.774"/>
</g>
<!-- proc~compute_errors -->
<g id="node18" class="node"><title>proc~compute_errors</title>
<a xlink:href="../proc/compute_errors.html" xlink:title="compute_errors">
<polygon fill="#d94e8f" stroke="#d94e8f" points="399,-732 311,-732 311,-706 399,-706 399,-732"/>
<text text-anchor="middle" x="355" y="-716.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_errors</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~compute_errors -->
<g id="edge28" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~compute_errors</title>
<path fill="none" stroke="black" d="M263.412,-483.023C267.362,-485.511 270.974,-488.474 274,-492 334.238,-562.204 254.389,-623.077 310,-697 310.572,-697.76 311.177,-698.495 311.811,-699.207"/>
<polygon fill="black" stroke="black" points="309.714,-702.021 319.557,-705.94 314.306,-696.738 309.714,-702.021"/>
</g>
<!-- proc~estimate_orders -->
<g id="node19" class="node"><title>proc~estimate_orders</title>
<a xlink:href="../proc/estimate_orders.html" xlink:title="estimate_orders">
<polygon fill="#d94e8f" stroke="#d94e8f" points="400,-688 310,-688 310,-662 400,-662 400,-688"/>
<text text-anchor="middle" x="355" y="-672.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">estimate_orders</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~estimate_orders -->
<g id="edge30" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~estimate_orders</title>
<path fill="none" stroke="black" d="M262.905,-483.011C267.017,-485.501 270.802,-488.467 274,-492 321.749,-544.756 268.16,-590.445 310,-648 311.982,-650.727 314.331,-653.229 316.9,-655.515"/>
<polygon fill="black" stroke="black" points="315.031,-658.49 325.118,-661.733 319.255,-652.908 315.031,-658.49"/>
</g>
<!-- proc~tvd_rk_solver -->
<g id="node20" class="node"><title>proc~tvd_rk_solver</title>
<a xlink:href="../proc/tvd_rk_solver.html" xlink:title="tvd_rk_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="393,-436 317,-436 317,-410 393,-410 393,-436"/>
<text text-anchor="middle" x="355" y="-420.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tvd_rk_solver</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~tvd_rk_solver -->
<g id="edge32" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~tvd_rk_solver</title>
<path fill="none" stroke="black" d="M249.669,-456.908C267.406,-451.198 288.335,-444.461 306.844,-438.502"/>
<polygon fill="black" stroke="black" points="308.11,-441.772 316.557,-435.376 305.965,-435.108 308.11,-441.772"/>
</g>
<!-- proc~leapfrog_solver -->
<g id="node21" class="node"><title>proc~leapfrog_solver</title>
<a xlink:href="../proc/leapfrog_solver.html" xlink:title="leapfrog_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="398,-392 312,-392 312,-366 398,-366 398,-392"/>
<text text-anchor="middle" x="355" y="-376.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">leapfrog_solver</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~leapfrog_solver -->
<g id="edge34" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~leapfrog_solver</title>
<path fill="none" stroke="black" d="M226.375,-456.986C246.109,-442.479 279.532,-418.731 310,-401 312.466,-399.565 315.04,-398.136 317.652,-396.736"/>
<polygon fill="black" stroke="black" points="319.311,-399.818 326.586,-392.116 316.096,-393.6 319.311,-399.818"/>
</g>
<!-- proc~test_tvd_rk~4&#45;&gt;proc~init~14 -->
<g id="edge40" class="edge"><title>proc~test_tvd_rk~4&#45;&gt;proc~init~14</title>
<path fill="none" stroke="black" d="M241.539,-291.607C252.902,-288.369 265.04,-283.209 274,-275 303.346,-248.111 282.439,-221.716 310,-193 312.623,-190.267 315.657,-187.827 318.885,-185.659"/>
<polygon fill="black" stroke="black" points="320.829,-188.578 327.737,-180.544 317.327,-182.517 320.829,-188.578"/>
</g>
<!-- proc~test_tvd_rk~4&#45;&gt;str -->
<g id="edge36" class="edge"><title>proc~test_tvd_rk~4&#45;&gt;str</title>
<path fill="none" stroke="black" d="M241.598,-290.349C261.31,-286.618 286.996,-282.27 310,-280 354.28,-275.631 405.456,-274.703 439.365,-274.66"/>
<polygon fill="black" stroke="black" points="439.732,-278.161 449.737,-274.675 439.741,-271.161 439.732,-278.161"/>
</g>
<!-- proc~test_tvd_rk~4&#45;&gt;proc~save_results~5 -->
<g id="edge38" class="edge"><title>proc~test_tvd_rk~4&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M241.765,-305.528C261.523,-310.67 287,-317.301 308.783,-322.971"/>
<polygon fill="black" stroke="black" points="307.938,-326.368 318.497,-325.499 309.701,-319.593 307.938,-326.368"/>
</g>
<!-- proc~test_tvd_rk~4&#45;&gt;proc~tvd_rk_solver -->
<g id="edge42" class="edge"><title>proc~test_tvd_rk~4&#45;&gt;proc~tvd_rk_solver</title>
<path fill="none" stroke="black" d="M241.539,-302.393C252.902,-305.631 265.04,-310.791 274,-319 303.346,-345.889 282.439,-372.284 310,-401 310.915,-401.953 311.879,-402.87 312.884,-403.753"/>
<polygon fill="black" stroke="black" points="311.096,-406.781 321.236,-409.852 315.224,-401.128 311.096,-406.781"/>
</g>
<!-- proc~test_leapfrog~4&#45;&gt;proc~init~14 -->
<g id="edge48" class="edge"><title>proc~test_leapfrog~4&#45;&gt;proc~init~14</title>
<path fill="none" stroke="black" d="M246.523,-243.742C255.911,-240.518 265.672,-236.331 274,-231 293.594,-218.458 291.251,-206.773 310,-193 312.819,-190.929 315.862,-188.966 318.991,-187.128"/>
<polygon fill="black" stroke="black" points="320.79,-190.134 327.916,-182.293 317.456,-183.979 320.79,-190.134"/>
</g>
<!-- proc~test_leapfrog~4&#45;&gt;str -->
<g id="edge44" class="edge"><title>proc~test_leapfrog~4&#45;&gt;str</title>
<path fill="none" stroke="black" d="M246.59,-246.05C256.403,-242.786 266.358,-238.002 274,-231 303.346,-204.111 276.676,-170.764 310,-149 343.49,-127.127 365.112,-129.434 400,-149 420.365,-160.421 450.734,-219.383 466.559,-252.448"/>
<polygon fill="black" stroke="black" points="463.54,-254.25 470.976,-261.797 469.869,-251.26 463.54,-254.25"/>
</g>
<!-- proc~test_leapfrog~4&#45;&gt;proc~save_results~5 -->
<g id="edge46" class="edge"><title>proc~test_leapfrog~4&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M246.609,-263.516C255.802,-266.682 265.449,-270.527 274,-275 295.196,-286.088 316.849,-302.44 332.429,-315.275"/>
<polygon fill="black" stroke="black" points="330.51,-318.234 340.418,-321.987 335.013,-312.875 330.51,-318.234"/>
</g>
<!-- proc~test_leapfrog~4&#45;&gt;proc~leapfrog_solver -->
<g id="edge50" class="edge"><title>proc~test_leapfrog~4&#45;&gt;proc~leapfrog_solver</title>
<path fill="none" stroke="black" d="M246.59,-259.95C256.403,-263.214 266.358,-267.998 274,-275 303.346,-301.889 282.439,-328.284 310,-357 310.915,-357.953 311.879,-358.87 312.884,-359.753"/>
<polygon fill="black" stroke="black" points="311.096,-362.781 321.236,-365.852 315.224,-357.128 311.096,-362.781"/>
</g>
<!-- proc~test_ls_rk~4&#45;&gt;proc~init~14 -->
<g id="edge56" class="edge"><title>proc~test_ls_rk~4&#45;&gt;proc~init~14</title>
<path fill="none" stroke="black" d="M238.151,-381.65C250.857,-378.72 264.899,-373.241 274,-363 325.305,-305.273 262.503,-253.899 310,-193 312.515,-189.775 315.625,-186.992 319.026,-184.599"/>
<polygon fill="black" stroke="black" points="321.033,-187.48 327.908,-179.418 317.506,-181.433 321.033,-187.48"/>
</g>
<!-- proc~test_ls_rk~4&#45;&gt;str -->
<g id="edge52" class="edge"><title>proc~test_ls_rk~4&#45;&gt;str</title>
<path fill="none" stroke="black" d="M224.545,-398.174C258.7,-425.437 341.871,-482.485 400,-445 450.806,-412.238 468.456,-336.928 474.292,-298.494"/>
<polygon fill="black" stroke="black" points="477.804,-298.65 475.696,-288.267 470.869,-297.698 477.804,-298.65"/>
</g>
<!-- proc~test_ls_rk~4&#45;&gt;proc~save_results~5 -->
<g id="edge54" class="edge"><title>proc~test_ls_rk~4&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M238.135,-375.184C249.351,-371.393 262.277,-367.01 274,-363 285.215,-359.164 297.294,-355.003 308.613,-351.093"/>
<polygon fill="black" stroke="black" points="310.017,-354.311 318.324,-347.734 307.729,-347.695 310.017,-354.311"/>
</g>
<!-- proc~test_ls_rk~4&#45;&gt;proc~ls_rk_solver -->
<g id="edge58" class="edge"><title>proc~test_ls_rk~4&#45;&gt;proc~ls_rk_solver</title>
<path fill="none" stroke="black" d="M225.65,-398.08C239.898,-409.93 260.232,-428.48 274,-448 296.24,-479.531 283.089,-499.349 310,-527 310.921,-527.946 311.891,-528.858 312.902,-529.736"/>
<polygon fill="black" stroke="black" points="311.129,-532.774 321.28,-535.81 315.238,-527.106 311.129,-532.774"/>
</g>
<!-- proc~test_am&#45;&gt;proc~init~14 -->
<g id="edge64" class="edge"><title>proc~test_am&#45;&gt;proc~init~14</title>
<path fill="none" stroke="black" d="M236.192,-337.732C249.238,-334.83 264.137,-329.349 274,-319 314.181,-276.84 272.606,-237.65 310,-193 312.565,-189.937 315.658,-187.266 319.008,-184.943"/>
<polygon fill="black" stroke="black" points="320.835,-187.929 327.707,-179.864 317.306,-181.883 320.835,-187.929"/>
</g>
<!-- proc~test_am&#45;&gt;proc~am_solver -->
<g id="edge66" class="edge"><title>proc~test_am&#45;&gt;proc~am_solver</title>
<path fill="none" stroke="black" d="M236.265,-345.007C249.015,-348.087 263.635,-353.503 274,-363 303.346,-389.889 289.927,-410.63 310,-445 317.954,-458.619 328.455,-472.782 337.312,-483.926"/>
<polygon fill="black" stroke="black" points="334.68,-486.236 343.696,-491.8 340.117,-481.828 334.68,-486.236"/>
</g>
<!-- proc~test_am&#45;&gt;str -->
<g id="edge60" class="edge"><title>proc~test_am&#45;&gt;str</title>
<path fill="none" stroke="black" d="M236.343,-333.047C256.611,-327.243 284.946,-319.32 310,-313 354.418,-301.796 405.856,-290.315 439.779,-282.948"/>
<polygon fill="black" stroke="black" points="440.682,-286.333 449.717,-280.798 439.203,-279.491 440.682,-286.333"/>
</g>
<!-- proc~test_am&#45;&gt;proc~save_results~5 -->
<g id="edge62" class="edge"><title>proc~test_am&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M236.119,-339.886C256.305,-339.056 284.361,-337.903 308.149,-336.925"/>
<polygon fill="black" stroke="black" points="308.542,-340.412 318.39,-336.505 308.255,-333.418 308.542,-340.412"/>
</g>
<!-- proc~test_ab~4&#45;&gt;proc~ab_solver -->
<g id="edge74" class="edge"><title>proc~test_ab~4&#45;&gt;proc~ab_solver</title>
<path fill="none" stroke="black" d="M211.52,-527.039C219.436,-564.819 247.114,-675.803 310,-741 312.038,-743.112 314.32,-745.05 316.747,-746.823"/>
<polygon fill="black" stroke="black" points="315.076,-749.905 325.413,-752.226 318.779,-743.965 315.076,-749.905"/>
</g>
<!-- proc~test_ab~4&#45;&gt;proc~init~14 -->
<g id="edge72" class="edge"><title>proc~test_ab~4&#45;&gt;proc~init~14</title>
<path fill="none" stroke="black" d="M236.252,-511.501C249.645,-508.807 264.837,-503.282 274,-492 358.385,-388.103 232.453,-302.096 310,-193 312.37,-189.666 315.387,-186.815 318.735,-184.382"/>
<polygon fill="black" stroke="black" points="320.736,-187.264 327.555,-179.156 317.168,-181.242 320.736,-187.264"/>
</g>
<!-- proc~test_ab~4&#45;&gt;str -->
<g id="edge68" class="edge"><title>proc~test_ab~4&#45;&gt;str</title>
<path fill="none" stroke="black" d="M211.814,-527.039C222.841,-576.805 264.739,-753.566 310,-785 342.854,-807.817 369.966,-811.419 400,-785 447.104,-743.565 426.492,-567.01 436,-505 447.652,-429.002 464.528,-339.444 472.503,-298.078"/>
<polygon fill="black" stroke="black" points="475.954,-298.669 474.418,-288.186 469.081,-297.339 475.954,-298.669"/>
</g>
<!-- proc~test_ab~4&#45;&gt;proc~save_results~5 -->
<g id="edge70" class="edge"><title>proc~test_ab~4&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M236.27,-510.806C249.336,-507.922 264.229,-502.436 274,-492 316.442,-446.671 270.553,-404.957 310,-357 310.604,-356.265 311.239,-355.553 311.9,-354.864"/>
<polygon fill="black" stroke="black" points="314.374,-357.36 319.845,-348.287 309.91,-351.968 314.374,-357.36"/>
</g>
<!-- proc~test_euler~4&#45;&gt;proc~init~14 -->
<g id="edge80" class="edge"><title>proc~test_euler~4&#45;&gt;proc~init~14</title>
<path fill="none" stroke="black" d="M239.251,-166.243C261.952,-167.176 293.167,-168.459 317.461,-169.457"/>
<polygon fill="black" stroke="black" points="317.607,-172.966 327.742,-169.88 317.894,-165.972 317.607,-172.966"/>
</g>
<!-- proc~test_euler~4&#45;&gt;str -->
<g id="edge76" class="edge"><title>proc~test_euler~4&#45;&gt;str</title>
<path fill="none" stroke="black" d="M225.701,-151.966C260.692,-126.358 343.156,-75.0587 400,-112 433.033,-133.467 419.187,-157.373 436,-193 445.563,-213.264 457.007,-236.039 465.372,-252.435"/>
<polygon fill="black" stroke="black" points="462.464,-254.435 470.137,-261.74 468.694,-251.244 462.464,-254.435"/>
</g>
<!-- proc~test_euler~4&#45;&gt;proc~save_results~5 -->
<g id="edge78" class="edge"><title>proc~test_euler~4&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M239.173,-170.264C251.036,-173.521 264.144,-178.729 274,-187 294.919,-204.555 328.339,-275.059 344.949,-312.062"/>
<polygon fill="black" stroke="black" points="341.902,-313.824 349.164,-321.539 348.298,-310.979 341.902,-313.824"/>
</g>
<!-- proc~euler_solver -->
<g id="node61" class="node"><title>proc~euler_solver</title>
<a xlink:href="../proc/euler_solver.html" xlink:title="euler_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-26 320,-26 320,-1.24345e-14 390,-3.55271e-15 390,-26"/>
<text text-anchor="middle" x="355" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">euler_solver</text>
</a>
</g>
<!-- proc~test_euler~4&#45;&gt;proc~euler_solver -->
<g id="edge82" class="edge"><title>proc~test_euler~4&#45;&gt;proc~euler_solver</title>
<path fill="none" stroke="black" d="M217.451,-151.68C233.359,-127.34 269.79,-74.9698 310,-40 313.418,-37.0274 317.206,-34.1911 321.091,-31.5501"/>
<polygon fill="black" stroke="black" points="323.089,-34.427 329.645,-26.1038 319.33,-28.5222 323.089,-34.427"/>
</g>
<!-- proc~test_abm&#45;&gt;proc~init~14 -->
<g id="edge88" class="edge"><title>proc~test_abm&#45;&gt;proc~init~14</title>
<path fill="none" stroke="black" d="M237.845,-201.492C260.779,-195.523 293.028,-187.13 317.886,-180.66"/>
<polygon fill="black" stroke="black" points="318.9,-184.012 327.696,-178.106 317.137,-177.238 318.9,-184.012"/>
</g>
<!-- proc~test_abm&#45;&gt;proc~abm_solver -->
<g id="edge90" class="edge"><title>proc~test_abm&#45;&gt;proc~abm_solver</title>
<path fill="none" stroke="black" d="M237.845,-210.185C258.621,-211.039 287.04,-212.207 310.685,-213.179"/>
<polygon fill="black" stroke="black" points="310.693,-216.682 320.829,-213.596 310.981,-209.688 310.693,-216.682"/>
</g>
<!-- proc~test_abm&#45;&gt;str -->
<g id="edge84" class="edge"><title>proc~test_abm&#45;&gt;str</title>
<path fill="none" stroke="black" d="M237.61,-203.783C249.764,-200.496 263.516,-195.254 274,-187 297.543,-168.466 283.759,-144.463 310,-130 345.031,-110.692 365.719,-109.389 400,-130 405.841,-133.512 445.945,-212.735 465.847,-252.562"/>
<polygon fill="black" stroke="black" points="462.843,-254.382 470.438,-261.769 469.108,-251.258 462.843,-254.382"/>
</g>
<!-- proc~test_abm&#45;&gt;proc~save_results~5 -->
<g id="edge86" class="edge"><title>proc~test_abm&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M237.561,-214.807C249.568,-218.188 263.22,-223.341 274,-231 304.663,-252.785 329.34,-289.465 343.079,-312.934"/>
<polygon fill="black" stroke="black" points="340.139,-314.844 348.122,-321.809 346.225,-311.385 340.139,-314.844"/>
</g>
<!-- proc~init~14&#45;&gt;str -->
<g id="edge2" class="edge"><title>proc~init~14&#45;&gt;str</title>
<path fill="none" stroke="black" d="M382.097,-182.276C388.233,-185.357 394.542,-188.972 400,-193 423.766,-210.539 446.327,-235.977 460.812,-253.858"/>
<polygon fill="black" stroke="black" points="458.285,-256.304 467.243,-261.961 463.768,-251.952 458.285,-256.304"/>
</g>
<!-- strz -->
<g id="node22" class="node"><title>strz</title>
<polygon fill="#777777" stroke="#777777" points="504,-184 450,-184 450,-158 504,-158 504,-184"/>
<text text-anchor="middle" x="477" y="-168.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">strz</text>
</g>
<!-- proc~init~14&#45;&gt;strz -->
<g id="edge4" class="edge"><title>proc~init~14&#45;&gt;strz</title>
<path fill="none" stroke="black" d="M382.076,-171C399.055,-171 421.177,-171 439.792,-171"/>
<polygon fill="black" stroke="black" points="440,-174.5 450,-171 440,-167.5 440,-174.5"/>
</g>
<!-- proc~exact_solution -->
<g id="node25" class="node"><title>proc~exact_solution</title>
<a xlink:href="../proc/exact_solution.html" xlink:title="exact_solution">
<polygon fill="#d94e8f" stroke="#d94e8f" points="517,-540 437,-540 437,-514 517,-514 517,-540"/>
<text text-anchor="middle" x="477" y="-524.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_solution</text>
</a>
</g>
<!-- proc~save_results~5&#45;&gt;proc~exact_solution -->
<g id="edge6" class="edge"><title>proc~save_results~5&#45;&gt;proc~exact_solution</title>
<path fill="none" stroke="black" d="M388.728,-348.183C392.835,-350.704 396.729,-353.631 400,-357 441.319,-399.553 462.919,-468.177 471.872,-503.827"/>
<polygon fill="black" stroke="black" points="468.52,-504.857 474.253,-513.767 475.328,-503.226 468.52,-504.857"/>
</g>
<!-- proc~print_analysis&#45;&gt;str -->
<g id="edge8" class="edge"><title>proc~print_analysis&#45;&gt;str</title>
<path fill="none" stroke="black" d="M390.175,-579.729C393.855,-577.257 397.248,-574.366 400,-571 434.873,-528.339 463.81,-360.307 473.516,-298.219"/>
<polygon fill="black" stroke="black" points="476.991,-298.647 475.053,-288.231 470.073,-297.582 476.991,-298.647"/>
</g>
<!-- proc~compute_errors&#45;&gt;proc~exact_solution -->
<g id="edge10" class="edge"><title>proc~compute_errors&#45;&gt;proc~exact_solution</title>
<path fill="none" stroke="black" d="M388.728,-705.817C392.835,-703.296 396.729,-700.369 400,-697 441.319,-654.447 462.919,-585.823 471.872,-550.173"/>
<polygon fill="black" stroke="black" points="475.328,-550.774 474.253,-540.233 468.52,-549.143 475.328,-550.774"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>

    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cli%7E5"></span>type(Type_Command_Line_Interface)</td>
  
  
  <td></td><td>::</td>
  <td><strong>cli</strong></td><td></td><td></td><td><p>Command line interface handler.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-space_dimension%7E2"></span>integer,</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>space_dimension</strong></td><td> =</td><td>2</td><td><p>Space dimensions.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-initial_state%7E10"></span>real(kind=R_P),</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>initial_state</strong>(1:space_dimension)</td><td> =</td><td>[0._R_P,1._R_P]</td><td><p>Initial state.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f%7E5"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>f</strong></td><td></td><td></td><td><p>Oscillation frequency.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t_final%7E4"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>t_final</strong></td><td></td><td></td><td><p>Final time.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E10"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>Dt</strong></td><td></td><td></td><td><p>Time step.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-error%7E5"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>error</strong></td><td></td><td></td><td><p>Error handler.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-stages_steps%7E2"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>stages_steps</strong></td><td></td><td></td><td><p>Number of stages/steps used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-implicit_iterations"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>implicit_iterations</strong></td><td></td><td></td><td><p>Number of iterations for implicit solvers.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-solver%7E5"></span>character(len=99)</td>
  
  
  <td></td><td>::</td>
  <td><strong>solver</strong></td><td></td><td></td><td><p>Solver used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-plots%7E5"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>plots</strong></td><td></td><td></td><td><p>Flag for activating plots saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-results%7E5"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>results</strong></td><td></td><td></td><td><p>Flag for activating results saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-output_cli%7E2"></span>character(len=99)</td>
  
  
  <td></td><td>::</td>
  <td><strong>output_cli</strong></td><td></td><td></td><td><p>Output files basename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-errors_analysis"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>errors_analysis</strong></td><td></td><td></td><td><p>Flag for activating errors analysis.</p></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    
    
    

    
    
     
    <section>
    <h2>Functions</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-exact_solution"></span><h3>
function <a href='../proc/exact_solution.html'>exact_solution</a>(t) result(ex_sol)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t</strong></td><td><p>Time.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:space_dimension)</small></h4>
  <p>Exact solution.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Compute the exact solution.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-compute_errors"></span><h3>
function <a href='../proc/compute_errors.html'>compute_errors</a>(solution) result(error_L2)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:space_dimension)</small></h4>
  <p>L2 norm of the numerical error.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Compute the L2 norm of numerical error with respect the exact solution.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-estimate_orders"></span><h3>
function <a href='../proc/estimate_orders.html'>estimate_orders</a>(solver_error, Dt_used) result(order)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solver_error</strong>(1:space_dimension,1:2)</td><td><p>Computed errors.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dt_used</strong>(1:2)</td><td><p>Time steps used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:space_dimension)</small></h4>
  <p>Estimation of the order of accuracy.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Estimate the order of accuracy using 2 subsequent refined numerical solutions.</p>
        

  </div>
  </div>

    
    </section>
    <br>
    


    
    <section>
    <h2>Subroutines</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-init%7E14"></span><h3>
subroutine <a href='../proc/init%7E14.html'>init</a>(output, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=:),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>output</strong></td><td><p>Output files basename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>solution</strong>(:,:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Initialize solver local variable from global variables.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-save_results%7E5"></span><h3>
subroutine <a href='../proc/save_results%7E5.html'>save_results</a>(title, basename, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>title</strong></td><td><p>Plot title.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>basename</strong></td><td><p>Output files basename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Save plots of results.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_ab%7E4"></span><h3>
subroutine <a href='../proc/test_ab%7E4.html'>test_ab</a>(steps)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit Adams-Bashforth class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_abm"></span><h3>
subroutine <a href='../proc/test_abm.html'>test_abm</a>(steps)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test predictor-corrector Adams-Bashforth-Moulton class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_am"></span><h3>
subroutine <a href='../proc/test_am.html'>test_am</a>(steps)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test implicit Adams-Moulton class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_euler%7E4"></span><h3>
subroutine <a href='../proc/test_euler%7E4.html'>test_euler</a>()
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit forward Euler ODE solver.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_leapfrog%7E4"></span><h3>
subroutine <a href='../proc/test_leapfrog%7E4.html'>test_leapfrog</a>(raw)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>raw</strong></td><td><p>Activate RAW filter.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit leapfrog class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_ls_rk%7E4"></span><h3>
subroutine <a href='../proc/test_ls_rk%7E4.html'>test_ls_rk</a>(stages)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit low storage Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_tvd_rk%7E4"></span><h3>
subroutine <a href='../proc/test_tvd_rk%7E4.html'>test_tvd_rk</a>(stages)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit TVD/SSP Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-ab_solver"></span><h3>
subroutine <a href='../proc/ab_solver.html'>ab_solver</a>(steps, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit Adams-Bashforth class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-abm_solver"></span><h3>
subroutine <a href='../proc/abm_solver.html'>abm_solver</a>(steps, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all ABM solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with predictor-corrector Adams-Bashforth-Moulton class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-am_solver"></span><h3>
subroutine <a href='../proc/am_solver.html'>am_solver</a>(steps, iterations, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AM solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>iterations</strong></td><td><p>Number of fixed point iterations.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with implicit Adams-Moulton class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-euler_solver"></span><h3>
subroutine <a href='../proc/euler_solver.html'>euler_solver</a>(solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit forward Euler ODE solver.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-leapfrog_solver"></span><h3>
subroutine <a href='../proc/leapfrog_solver.html'>leapfrog_solver</a>(solution, raw)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>raw</strong></td><td><p>Activate RAW filter.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit leapfrog class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-ls_rk_solver"></span><h3>
subroutine <a href='../proc/ls_rk_solver.html'>ls_rk_solver</a>(stages, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit low storage Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-tvd_rk_solver"></span><h3>
subroutine <a href='../proc/tvd_rk_solver.html'>tvd_rk_solver</a>(stages, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit TVD/SSP Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-perform_errors_analysis"></span><h3>
subroutine <a href='../proc/perform_errors_analysis.html'>perform_errors_analysis</a>()
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Peform errors analysis.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-print_analysis"></span><h3>
subroutine <a href='../proc/print_analysis.html'>print_analysis</a>(solver, time_steps, errors, orders)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solver</strong></td><td><p>Solver name.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>time_steps</strong>(:)</td><td><p>Time steps exercised.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>errors</strong>(:,:,:)</td><td><p>Errors of the solver.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>orders</strong>(:,:,:)</td><td><p>Observed orders of the solver.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Print summary of the error analysis.</p>
        

  </div>
  </div>

    
    </section>    
    
    
    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span class="k">program </span><span class="n">integrate_oscillation</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c">!&lt; Test FOODiE with the integration of Oscillation equations.</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">use </span><span class="n">IR_Precision</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">R_P</span><span class="p">,</span> <span class="n">I_P</span><span class="p">,</span> <span class="n">FR_P</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">strz</span>
<span class="k">use </span><span class="n">type_oscillation</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">oscillation</span>
<span class="k">use </span><span class="n">Data_Type_Command_Line_Interface</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Type_Command_Line_Interface</span>
<span class="k">use </span><span class="n">foodie</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">adams_bashforth_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">adams_bashforth_moulton_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">adams_moulton_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">euler_explicit_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">leapfrog_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">ls_runge_kutta_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">tvd_runge_kutta_integrator</span>
<span class="k">use </span><span class="n">pyplot_module</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span>  <span class="n">pyplot</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">implicit none</span>
<span class="k">type</span><span class="p">(</span><span class="n">Type_Command_Line_Interface</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cli</span>                                               <span class="c">!&lt; Command line interface handler.</span>
<span class="kt">integer</span><span class="p">,</span>   <span class="k">parameter</span>              <span class="kd">::</span> <span class="n">space_dimension</span><span class="o">=</span><span class="mi">2</span>                                 <span class="c">!&lt; Space dimensions.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">parameter</span>              <span class="kd">::</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="mf">1._R_P</span><span class="p">]</span> <span class="c">!&lt; Initial state.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">f</span>                                                 <span class="c">!&lt; Oscillation frequency.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">t_final</span>                                           <span class="c">!&lt; Final time.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">Dt</span>                                                <span class="c">!&lt; Time step.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">error</span>                                             <span class="c">!&lt; Error handler.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">stages_steps</span>                                      <span class="c">!&lt; Number of stages/steps used.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">implicit_iterations</span>                               <span class="c">!&lt; Number of iterations for implicit solvers.</span>
<span class="kt">character</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">solver</span>                                            <span class="c">!&lt; Solver used.</span>
<span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">plots</span>                                             <span class="c">!&lt; Flag for activating plots saving.</span>
<span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">results</span>                                           <span class="c">!&lt; Flag for activating results saving.</span>
<span class="kt">character</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">output_cli</span>                                        <span class="c">!&lt; Output files basename.</span>
<span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">errors_analysis</span>                                   <span class="c">!&lt; Flag for activating errors analysis.</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c">! setting Command Line Interface</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">progname</span>    <span class="o">=</span> <span class="s1">&#39;oscillation&#39;</span><span class="p">,</span>                                              <span class="p">&amp;</span>
              <span class="n">authors</span>     <span class="o">=</span> <span class="s1">&#39;Fortran-FOSS-Programmers&#39;</span><span class="p">,</span>                                 <span class="p">&amp;</span>
              <span class="n">license</span>     <span class="o">=</span> <span class="s1">&#39;GNU GPLv3&#39;</span><span class="p">,</span>                                                <span class="p">&amp;</span>
              <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Test FOODiE library on Oscillation equations integration&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">examples</span>    <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;oscillation --solver euler --results  &quot;</span><span class="p">,</span>                  <span class="p">&amp;</span>
                             <span class="s2">&quot;oscillation --solver ls-runge-kutta -r&quot;</span><span class="p">,</span>                  <span class="p">&amp;</span>
                             <span class="s2">&quot;oscillation --solver adams-bashforth  &quot;</span><span class="p">,</span>                  <span class="p">&amp;</span>
                             <span class="s2">&quot;oscillation --solver all --plots -r   &quot;</span><span class="p">])</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--solver&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;ODE solver used&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--ss&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Stages/steps used&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--iterations&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Number of iterations for implicit solvers&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;5&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--frequency&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Oscillation frequency&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;1e-4&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--time_step&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-Dt&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Integration time step&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;100.d0&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--t_final&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-tf&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Final integration time&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;1e6&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--results&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Save results&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--plots&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Save plots of results&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Output files basename&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;unset&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--errors_analysis&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Peform errors analysis&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">)</span>
<span class="c">! parsing Command Line Interface</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">parse</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--ss&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--iterations&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">implicit_iterations</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-Dt&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-tf&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">t_final</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">plots</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">output_cli</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--errors_analysis&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">errors_analysis</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">if</span> <span class="p">(</span><span class="n">errors_analysis</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  call </span><span class="n">perform_errors_analysis</span>
<span class="k">else</span>
<span class="k">  select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">)))</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;adams-bashforth&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_ab</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;adams-bashforth-moulton&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_abm</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;adams-moulton&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_am</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;euler&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_euler</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;leapfrog&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_leapfrog</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;leapfrog-raw&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_leapfrog</span><span class="p">(</span><span class="n">raw</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;ls-runge-kutta&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_ls_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;tvd-runge-kutta&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_tvd_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_ab</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_abm</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_am</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_euler</span>
    <span class="k">call </span><span class="n">test_leapfrog</span>
    <span class="k">call </span><span class="n">test_ls_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_tvd_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case </span><span class="n">default</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Error: unknown solver &quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Valid solver names are:&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + adams-bashforth&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + adams-bashforth-moulton&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + adams-moulton&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + euler&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + leapfrog&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + leapfrog-raw&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + ls-runge-kutta&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + tvd-runge-kutta&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + all&#39;</span>
  <span class="n">endselect</span>
<span class="n">endif</span>
<span class="k">stop</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">contains</span>
<span class="k">  subroutine </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Initialize solver local variable from global variables.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">output</span>        <span class="c">!&lt; Output files basename.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>        <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span> <span class="c">!&lt; Solution at each time step.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">t_final</span><span class="p">,</span> <span class="n">Dt</span><span class="p">)</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Error: the final integration time must be an exact multiple of the time step used!&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Final integration time: &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">t_final</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Time step: &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">Dt</span><span class="p">)</span>
    <span class="k">stop</span>
<span class="k">  </span><span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">output_cli</span><span class="p">))</span><span class="o">/=</span><span class="s1">&#39;unset&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">output</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">output_cli</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span><span class="o">//</span><span class="s1">&#39;-time_steps&#39;</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
  <span class="k">else</span>
<span class="k">    </span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;oscillation_integration-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span><span class="o">//</span><span class="s1">&#39;-time_steps&#39;</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
  <span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">solution</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="p">;</span> <span class="k">allocate</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">init</span>

  <span class="k">function </span><span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ex_sol</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the exact solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">t</span>                         <span class="c">!&lt; Time.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span> <span class="c">!&lt; Exact solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
  <span class="n">ex_sol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">exact_solution</span>

  <span class="k">subroutine </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Save plots of results.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">title</span>                     <span class="c">!&lt; Plot title.</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">basename</span>                  <span class="c">!&lt; Output files basename.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>           <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">rawfile</span>                   <span class="c">!&lt; Raw file unit for saving results.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span> <span class="c">!&lt; Exact solution.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">pyplot</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">plt</span>                       <span class="c">!&lt; Plot file handler.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">i</span>                         <span class="c">!&lt; Counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">s</span>                         <span class="c">!&lt; Counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">rawfile</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">basename</span><span class="o">//</span><span class="s1">&#39;.dat&#39;</span><span class="p">)</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;TITLE=&quot;&#39;</span><span class="o">//</span><span class="n">title</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;VARIABLES=&quot;t&quot; &quot;x&quot; &quot;y&quot;&#39;</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;ZONE T=&quot;FOODiE time serie&quot;&#39;</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ubound</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(3(&#39;</span><span class="o">//</span><span class="n">FR_P</span><span class="o">//</span><span class="s1">&#39;,1X))&#39;</span><span class="p">)(</span><span class="n">solution</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">space_dimension</span><span class="p">)</span>
    <span class="n">enddo</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;ZONE T=&quot;Exact solution&quot;&#39;</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ubound</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">ex_sol</span> <span class="o">=</span> <span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(3(&#39;</span><span class="o">//</span><span class="n">FR_P</span><span class="o">//</span><span class="s1">&#39;,1X))&#39;</span><span class="p">)</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="p">(</span><span class="n">ex_sol</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_dimension</span><span class="p">)</span>
    <span class="n">enddo</span>
    <span class="k">close</span><span class="p">(</span><span class="n">rawfile</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">plots</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    call </span><span class="n">plt</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">:),</span> <span class="n">y</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">:),</span> <span class="n">y</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">savefig</span><span class="p">(</span><span class="n">basename</span><span class="o">//</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>

    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="o">//</span><span class="s1">&#39;-path&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">:),</span> <span class="n">y</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;path-&#39;</span><span class="o">//</span><span class="n">basename</span><span class="o">//</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">save_results</span>

  <span class="k">subroutine </span><span class="n">test_ab</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit Adams-Bashforth class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">steps</span>            <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">ab_steps</span><span class="o">=</span><span class="mi">4</span>       <span class="c">!&lt; Adams-Bashforth steps number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                <span class="c">!&lt; AB steps counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Steps used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>           <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>            <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of Adams-Bashforth class of solvers&#39;</span>
  <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">steps</span><span class="p">,</span> <span class="n">steps</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; AB-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit Adams-Bashforth, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">ab_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_ab</span>

  <span class="k">subroutine </span><span class="n">test_abm</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test predictor-corrector Adams-Bashforth-Moulton class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">steps</span>            <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">abm_steps</span><span class="o">=</span><span class="mi">4</span>      <span class="c">!&lt; Adams-Bashforth-Moulton steps number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                <span class="c">!&lt; ABM steps counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Steps used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>           <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>            <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth-moulton&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of Adams-Bashforth-Moulton class of solvers&#39;</span>
  <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">abm_steps</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">steps</span><span class="p">,</span> <span class="n">steps</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; ABM-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, predictor/corrector Adams-Bashforth-Moulton, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
            <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">abm_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_abm</span>

  <span class="k">subroutine </span><span class="n">test_am</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test implicit Adams-Moulton class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">steps</span>            <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">am_steps</span><span class="o">=</span><span class="mi">3</span>       <span class="c">!&lt; Adams-Moulton steps number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                <span class="c">!&lt; AM steps counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Steps used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>           <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>            <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-moulton&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of Adams-Moulton class of solvers&#39;</span>
  <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">am_steps</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">steps</span><span class="p">,</span> <span class="n">steps</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; AM-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, implicit Adams-Moulton, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
            <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">implicit_iterations</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      call </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">implicit_iterations</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">endif</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_am</span>

  <span class="k">subroutine </span><span class="n">test_euler</span><span class="p">()</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit forward Euler ODE solver.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span> <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>        <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>         <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;euler&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of explicit Euler solver&#39;</span>
  <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit Euler, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
  <span class="k">call </span><span class="n">euler_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_euler</span>

  <span class="k">subroutine </span><span class="n">test_leapfrog</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit leapfrog class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">logical</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">raw</span>           <span class="c">!&lt; Activate RAW filter.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span> <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>        <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>         <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;leapfrog&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of leapfrog (RAW filtered) class of solvers&#39;</span>
  <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, leapfrog (RAW filtered), t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
  <span class="k">call </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span>
  <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_leapfrog</span>

  <span class="k">subroutine </span><span class="n">test_ls_rk</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit low storage Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">stages</span>            <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">14</span>      <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>     <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                 <span class="c">!&lt; RK stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Stages used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>            <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>             <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;ls-runge-kutta&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of low storage (2N) Runge-Kutta class of solvers&#39;</span>
  <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">stages</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">stages</span><span class="p">,</span> <span class="n">stages</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 8 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">9</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 9 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 10 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">11</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 11 stages not yet implemented</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; RK-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit low storage Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
      <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">ls_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_ls_rk</span>

  <span class="k">subroutine </span><span class="n">test_tvd_rk</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit TVD/SSP Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">stages</span>            <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>       <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>     <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                 <span class="c">!&lt; RK stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Stages used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>            <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>             <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;tvd-runge-kutta&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of TVD/SSP Runge-Kutta class of solvers&#39;</span>
  <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">stages</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">stages</span><span class="p">,</span> <span class="n">stages</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; RK-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit TVD/SSP Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">tvd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_tvd_rk</span>

  <span class="k">subroutine </span><span class="n">ab_solver</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit Adams-Bashforth class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">steps</span>                 <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>               <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">adams_bashforth_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_integrator</span>         <span class="c">!&lt; Adams-Bashforth integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">steps</span><span class="p">)</span>     <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                          <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">ab_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">endselect</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to s - 1 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">ab_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">-</span><span class="n">steps</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">ab_solver</span>

  <span class="k">subroutine </span><span class="n">abm_solver</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with predictor-corrector Adams-Bashforth-Moulton class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">steps</span>                 <span class="c">!&lt; Number of steps used: if negative all ABM solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>                       <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">adams_bashforth_moulton_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">abm_integrator</span>        <span class="c">!&lt; Adams-Bashforth-Moulton integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">steps</span><span class="p">)</span>     <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                                  <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">abm_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">endselect</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to s - 1 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">abm_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">-</span><span class="n">steps</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">abm_solver</span>

  <span class="k">subroutine </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with implicit Adams-Moulton class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">steps</span>                 <span class="c">!&lt; Number of steps used: if negative all AM solvers are used.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iterations</span>            <span class="c">!&lt; Number of fixed point iterations.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>                  <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">adams_moulton_integrator</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">am_integrator</span>         <span class="c">!&lt; Adams-Moulton integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">steps</span><span class="p">)</span>     <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">am_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">steps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">endselect</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to s - 1 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">am_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">-</span><span class="n">steps</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">)</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">am_solver</span>

  <span class="k">subroutine </span><span class="n">euler_solver</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit forward Euler ODE solver.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>  <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">euler_explicit_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">euler_integrator</span> <span class="c">!&lt; Euler integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">oscillator</span>       <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">step</span>             <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">euler_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">euler_solver</span>

  <span class="k">subroutine </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit leapfrog class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">logical</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">raw</span>                   <span class="c">!&lt; Activate RAW filter.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>               <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">leapfrog_integrator</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">lf_integrator</span>         <span class="c">!&lt; Leapfrog integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>         <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">filter</span>                <span class="c">!&lt; Filter displacement.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                          <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="kt">logical</span>                          <span class="kd">::</span> <span class="n">filtered</span>              <span class="c">!&lt; Activate RAW filter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">filtered</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">raw</span><span class="p">))</span> <span class="n">filtered</span> <span class="o">=</span> <span class="n">raw</span>
  <span class="k">call </span><span class="n">lf_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">()</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">rk_stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">2</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to 2 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">filtered</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">lf_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span> <span class="n">filter</span><span class="o">=</span><span class="n">filter</span><span class="p">)</span>
      <span class="k">else</span>
<span class="k">        call </span><span class="n">lf_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">endif</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">leapfrog_solver</span>

  <span class="k">subroutine </span><span class="n">ls_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit low storage Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">stages</span>                <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">ls_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>              <span class="kd">::</span> <span class="n">registers</span><span class="o">=</span><span class="mi">2</span>           <span class="c">!&lt; Runge-Kutta stages registers number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">registers</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta registers.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">ls_rk_solver</span>

  <span class="k">subroutine </span><span class="n">tvd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit TVD/SSP Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">stages</span>             <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>      <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>         <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">step</span>               <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">tvd_rk_solver</span>

  <span class="k">subroutine </span><span class="n">perform_errors_analysis</span><span class="p">()</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Peform errors analysis.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The analysis is based on the integration of the Oscillation equations with different, decreasing time steps in the range</span>
  <span class="c">!&lt; *[5000, 2500, 1250, 625, 320, 100]*. The error is estimated by the L2 norm of the difference between the exact (\(U_e\)) and</span>
  <span class="c">!&lt; the numerical (\(U_{\Delta t}\)) solutions for each time step:</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;\varepsilon (\Delta t) = || U_e - U_{\Delta t} ||_2 = \sqrt{ \sum_{s=1}^{N_s} { \left(U_e(t_0 + s * \Delta t) -</span>
  <span class="c">!&lt;U_{\Delta t}(t_0 + s * \Delta t) \right)^2 }}</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; Using two pairs of subsequent-decreasing time steps solution is possible to estimate the order of accuracy of the solver</span>
  <span class="c">!&lt; employed computing the \emph{observed order} of accuracy:</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;p = \frac{log10 \left( \frac{\varepsilon (\Delta t_1)}{\varepsilon (\Delta t_2)} \right)}</span>
  <span class="c">!&lt;{log10 \left( \frac{\Delta t_1}{\Delta t_2} \right)}</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt;where \(\frac{\Delta t_1}{\Delta t_2}&gt;1\).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">parameter</span>       <span class="kd">::</span> <span class="n">NDt</span><span class="o">=</span><span class="mi">6</span>                        <span class="c">!&lt; Number of time steps exercised.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">parameter</span>       <span class="kd">::</span> <span class="n">time_steps</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="mi">250</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="mi">125</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="mi">62</span><span class="mf">5._R_P</span><span class="p">,</span>  <span class="p">&amp;</span>
                                                      <span class="mi">32</span><span class="mf">0._R_P</span><span class="p">,</span>  <span class="p">&amp;</span>
                                                      <span class="mi">10</span><span class="mf">0._R_P</span><span class="p">]</span> <span class="c">!&lt; Time steps exercised.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">ab_steps</span><span class="o">=</span><span class="mi">4</span>                   <span class="c">!&lt; Adams-Bashforth steps number.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">tvd_rk_stages</span><span class="o">=</span><span class="mi">5</span>              <span class="c">!&lt; TVD/SSP Runge-Kutta stages number.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">ls_rk_stages</span><span class="o">=</span><span class="mi">14</span>              <span class="c">!&lt; Low storage Runge-Kutta stages number.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                            <span class="c">!&lt; Steps/stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">d</span>                            <span class="c">!&lt; Time steps-exercised counter.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>                       <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>                        <span class="c">!&lt; Output files title.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>                <span class="c">!&lt; Solution at each time step.</span>
  <span class="c">! errors and orders</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>            <span class="c">!&lt; Adams-Bashforth errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">abm_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>           <span class="c">!&lt; Adams-Bashforth-Moulton errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">am_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>            <span class="c">!&lt; Adams-Moulton errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lf_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>                   <span class="c">!&lt; Leapfrog errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ls_rk_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ls_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>     <span class="c">!&lt; Low storage Runge-Kutta errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tvd_rk_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">tvd_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>   <span class="c">!&lt; TVD/SSP Runge-Kutta errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>          <span class="c">!&lt; Adams-Bashforth orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">abm_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>         <span class="c">!&lt; Adams-Bashforth-Moulton orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">am_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>          <span class="c">!&lt; Adams-Moulton orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lf_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                 <span class="c">!&lt; Leapfrog orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ls_rk_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ls_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>   <span class="c">!&lt; Low storage Runge-Kutta orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tvd_rk_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">tvd_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">!&lt; TVD/SSP Runge-Kutta orders.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">ab_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span>     <span class="p">;</span> <span class="n">ab_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">abm_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span>    <span class="p">;</span> <span class="n">abm_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">am_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span>     <span class="p">;</span> <span class="n">am_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">lf_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span>     <span class="p">;</span> <span class="n">lf_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">ls_rk_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span>  <span class="p">;</span> <span class="n">ls_rk_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">tvd_rk_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span> <span class="p">;</span> <span class="n">tvd_rk_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">solution</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="p">;</span> <span class="k">allocate</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span>
  <span class="n">results</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">! activate results saving</span>
  <span class="c">! Analyze errors of Adams-Bashforth solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit Adams-Bashforth, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">ab_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">ab_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">ab_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">ab_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of Adams-Bashforth-Moulton solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth-moulton&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, predictor-corrector Adams-Bashforth-Moulton, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
              <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">abm_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">abm_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">abm_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">abm_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of Adams-Moulton solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-moulton&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ab_steps</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, implicit Adams-Moulton, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
              <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">implicit_iterations</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">implicit_iterations</span><span class="p">)</span>
      <span class="k">else</span>
<span class="k">        call </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">am_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ab_steps</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">am_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">am_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of leapfrog solver</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;leapfrog&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, leapfrog (unfiltered), t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
    <span class="k">call </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">lf_errors</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;leapfrog&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, leapfrog (RAW filtered), t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
    <span class="k">call </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-raw&#39;</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">lf_errors</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">lf_orders</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">lf_errors</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">lf_orders</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">lf_errors</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of low storage Runge-Kutta solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;ls-runge-kutta&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls_rk_stages</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 8 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">9</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 9 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 10 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">11</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 11 stages not yet implemented</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit low storage Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
        <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">ls_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">ls_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls_rk_stages</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 8 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">9</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 9 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 10 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">11</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 11 stages not yet implemented</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">ls_rk_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">ls_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of TVD/SSP Runge-Kutta solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;tvd-runge-kutta&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tvd_rk_stages</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit TVD/SSP Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">tvd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">tvd_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tvd_rk_stages</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">tvd_rk_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">tvd_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s2">&quot;Solver &amp; Time Step &amp; f*Dt &amp; Error X &amp; Error Y &amp; Observed Order of Accuracy X &amp; Observed Order of Accuracy Y&quot;</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adams-bashforth&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">ab_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">ab_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adams-bashforth-moulton&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">abm_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">abm_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adams-moulton&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">am_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">am_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;leapfrog&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">lf_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">lf_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;ls-runge-kutta&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">ls_rk_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">ls_rk_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;tvd-runge-kutta&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">tvd_rk_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">tvd_rk_orders</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">perform_errors_analysis</span>

  <span class="k">function </span><span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">error_L2</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the L2 norm of numerical error with respect the exact solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>             <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">error_L2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span> <span class="c">!&lt; L2 norm of the numerical error.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span>   <span class="c">!&lt; Exact solution.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">s</span>                           <span class="c">!&lt; Steps/stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">v</span>                           <span class="c">!&lt; Variables counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">error_L2</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ubound</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ex_sol</span> <span class="o">=</span> <span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">do </span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_dimension</span>
      <span class="n">error_L2</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">error_L2</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="n">ex_sol</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="n">error_L2</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">error_L2</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">compute_errors</span>

  <span class="k">function </span><span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="p">,</span> <span class="n">Dt_used</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Estimate the order of accuracy using 2 subsequent refined numerical solutions.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solver_error</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Computed errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Dt_used</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>                         <span class="c">!&lt; Time steps used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">order</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span>             <span class="c">!&lt; Estimation of the order of accuracy.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">v</span>                                    <span class="c">!&lt; Variables counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">do </span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_dimension</span>
    <span class="n">order</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">log</span><span class="p">(</span><span class="n">solver_error</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">solver_error</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="nb">log</span><span class="p">(</span><span class="n">Dt_used</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">Dt_used</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">estimate_orders</span>

  <span class="k">subroutine </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">orders</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Print summary of the error analysis.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solver</span>        <span class="c">!&lt; Solver name.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">time_steps</span><span class="p">(:)</span> <span class="c">!&lt; Time steps exercised.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">errors</span><span class="p">(:,:,:)</span> <span class="c">!&lt; Errors of the solver.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">orders</span><span class="p">(:,:,:)</span> <span class="c">!&lt; Observed orders of the solver.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">s</span>             <span class="c">!&lt; Solver index.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">d</span>             <span class="c">!&lt; Time steps-exercised counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">solver</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A)&quot;</span><span class="p">,</span> <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                 <span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; / &amp; /&quot;</span>
      <span class="k">else</span>
<span class="k">        print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A,F9.2,A,F9.2)&quot;</span><span class="p">,</span> <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                             <span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                             <span class="n">orders</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">orders</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">endif</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">print_analysis</span>
<span class="n">endprogram</span> <span class="n">integrate_oscillation</span>
</pre></div>

    </section>
    
    
    </div>
  </div>

    <hr>
    <footer>
        <div class="row">
        <div class="col-md-6">&copy; 2015 FOODiE was written by Fortran-FOSS-Programmers Group. </div>
        <div class="col-md-6"><span class="pull-right">Documentation generated by <a href="https://github.com/cmacmackin/ford">FORD</a>.</span></div>
        </div>
        <br>
    </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>