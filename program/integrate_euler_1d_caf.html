<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Fortran Object oriented Ordinary Differential Equations integration library">
    
    <meta name="author" content="Fortran-FOSS-Programmers Group" >
    <link rel="icon" href="../favicon.png">

    <title>integrate_euler_1D_caf &ndash; FOODIE</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FOODIE </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>integrate_euler_1D_caf
    <small>Program</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title="13.4% of total for programs.">232 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/euler-1D-caf_no_foodie.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/euler-1d-caf_no_foodie.f90.html'>euler-1D-caf_no_foodie.f90</a></li>
  
     <li class="active">integrate_euler_1D_caf</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-bc_l%7E11">BC_L</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-bc_r%7E11">BC_R</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-cfl%7E7">CFL</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-dt%7E29">Dt</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-dt%7E30">Dt</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-dx%7E11">Dx</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-nc%7E6">Nc</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-ni%7E13">Ni</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-ni%7E14">Ni</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-ni_image">Ni_image</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-np%7E6">Np</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-ns%7E11">Ns</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-cli%7E2">cli</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-count_rate">count_rate</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-cp0%7E11">cp0</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-cv0%7E11">cv0</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-domain">domain</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-error%7E14">error</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-final_state">final_state</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-id">id</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-initial_state%7E10">initial_state</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-me%7E5">me</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-ord%7E11">ord</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-plots%7E3">plots</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-plots%7E4">plots</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-profiling">profiling</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-results%7E3">results</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-results%7E4">results</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-rk_integrator">rk_integrator</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-rk_stage">rk_stage</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-rk_stages">rk_stages</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-steps%7E27">steps</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-steps_max">steps_max</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-steps_max%7E2">steps_max</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-system_clocks">system_clocks</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-t%7E44">t</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-time_serie">time_serie</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-time_serie%7E2">time_serie</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-verbose">verbose</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-verbose%7E2">verbose</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-we%7E5">we</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-x%7E2">x</a>
      
    </div>
  </div>
</div>












<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#proc-init%7E13">init</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#proc-save_results%7E2">save_results</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#proc-save_time_serie">save_time_serie</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#proc-synchronize">synchronize</a>
      
    </div>
  </div>
</div>








<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#src">integrate_euler_1D_caf</a>
  </div>
</div>


  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprogs-0">All Programs</a></h3></div>
  <div id="allprogs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_burgers.html">integrate_burgers</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d.html">integrate_euler_1D</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html">integrate_euler_1D_caf</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf%7E2.html">integrate_euler_1D_caf</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_openmp.html">integrate_euler_1D_openmp</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_openmp_no_foodie.html">integrate_euler_1D_openmp_no_foodie</a>
      
      <a class="list-group-item" href="../program/integrate_lorenz.html">integrate_lorenz</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html">integrate_oscillation</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    
    <div class="col-md-9" id='text'>
    
  
    <ul class="list-inline">
      <li><h4>Uses:</h4></li>
      
      <li>flap</li>
      
      <li>IR_Precision</li>
      
      <li>pyplot_module</li>
      
      <li><a href='../module/type_euler_1d_caf_no_foodie.html'>type_euler_1D_caf_no_foodie</a></li>
      
    </ul>
    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: program~~integrate_euler_1d_caf~~UsesGraph Pages: 1 -->
<svg id="programintegrate_euler_1d_cafUsesGraph" width="434pt" height="163pt"
 viewBox="0.00 0.00 434.00 163.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~integrate_euler_1d_caf~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 159)">
<title>program~~integrate_euler_1d_caf~~UsesGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-159 431,-159 431,5 -4,5"/>
<!-- program~integrate_euler_1d_caf -->
<g id="node1" class="node"><title>program~integrate_euler_1d_caf</title>
<polygon fill="none" stroke="black" points="426,-90 302,-90 302,-64 426,-64 426,-90"/>
<text text-anchor="middle" x="364" y="-74.55" font-family="Helvetica,sans-Serif" font-size="10.50">integrate_euler_1D_caf</text>
</g>
<!-- flap -->
<g id="node2" class="node"><title>flap</title>
<polygon fill="#337ab7" stroke="#337ab7" points="215,-155 161,-155 161,-129 215,-129 215,-155"/>
<text text-anchor="middle" x="188" y="-139.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">flap</text>
</g>
<!-- flap&#45;&gt;program~integrate_euler_1d_caf -->
<g id="edge6" class="edge"><title>flap&#45;&gt;program~integrate_euler_1d_caf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M215.004,-135.37C230.155,-131.405 249.312,-125.982 266,-120 286.851,-112.526 309.535,-102.687 327.823,-94.3076"/>
<polygon fill="#000000" stroke="#000000" points="329.35,-97.4577 336.953,-90.0789 326.408,-91.106 329.35,-97.4577"/>
</g>
<!-- pyplot_module -->
<g id="node3" class="node"><title>pyplot_module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="229,-111 147,-111 147,-85 229,-85 229,-111"/>
<text text-anchor="middle" x="188" y="-95.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pyplot_module</text>
</g>
<!-- pyplot_module&#45;&gt;program~integrate_euler_1d_caf -->
<g id="edge8" class="edge"><title>pyplot_module&#45;&gt;program~integrate_euler_1d_caf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M229.264,-93.0764C247.947,-90.8473 270.588,-88.1457 291.936,-85.5986"/>
<polygon fill="#000000" stroke="#000000" points="292.445,-89.0628 301.96,-84.4025 291.615,-82.1121 292.445,-89.0628"/>
</g>
<!-- module~type_euler_1d_caf_no_foodie -->
<g id="node4" class="node"><title>module~type_euler_1d_caf_no_foodie</title>
<a xlink:href="../module/type_euler_1d_caf_no_foodie.html" xlink:title="type_euler_1D_caf_no_foodie">
<polygon fill="#337ab7" stroke="#337ab7" points="266,-29 110,-29 110,-3 266,-3 266,-29"/>
<text text-anchor="middle" x="188" y="-13.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">type_euler_1D_caf_no_foodie</text>
</a>
</g>
<!-- module~type_euler_1d_caf_no_foodie&#45;&gt;program~integrate_euler_1d_caf -->
<g id="edge10" class="edge"><title>module~type_euler_1d_caf_no_foodie&#45;&gt;program~integrate_euler_1d_caf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M225.692,-29.0411C238.487,-33.4698 252.866,-38.4485 266,-43 282.487,-48.7135 300.532,-54.9724 316.594,-60.5456"/>
<polygon fill="#000000" stroke="#000000" points="315.712,-63.9443 326.307,-63.916 318.007,-57.3311 315.712,-63.9443"/>
</g>
<!-- IR_Precision -->
<g id="node5" class="node"><title>IR_Precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="73,-70 1,-70 1,-44 73,-44 73,-70"/>
<text text-anchor="middle" x="37" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">IR_Precision</text>
</g>
<!-- IR_Precision&#45;&gt;program~integrate_euler_1d_caf -->
<g id="edge12" class="edge"><title>IR_Precision&#45;&gt;program~integrate_euler_1d_caf</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M73.5592,-59.236C126.109,-62.4501 224.088,-68.4427 291.611,-72.5726"/>
<polygon fill="#000000" stroke="#000000" points="291.564,-76.0761 301.759,-73.1932 291.991,-69.0892 291.564,-76.0761"/>
</g>
<!-- IR_Precision&#45;&gt;module~type_euler_1d_caf_no_foodie -->
<g id="edge2" class="edge"><title>IR_Precision&#45;&gt;module~type_euler_1d_caf_no_foodie</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M73.5529,-47.075C90.5737,-42.4535 111.231,-36.8445 130.286,-31.6706"/>
<polygon fill="#000000" stroke="#000000" points="131.343,-35.0104 140.077,-29.0123 129.509,-28.255 131.343,-35.0104"/>
</g>
<!-- wenoof -->
<g id="node6" class="node"><title>wenoof</title>
<polygon fill="#337ab7" stroke="#337ab7" points="64,-26 10,-26 10,-1.24345e-14 64,-3.55271e-15 64,-26"/>
<text text-anchor="middle" x="37" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wenoof</text>
</g>
<!-- wenoof&#45;&gt;module~type_euler_1d_caf_no_foodie -->
<g id="edge4" class="edge"><title>wenoof&#45;&gt;module~type_euler_1d_caf_no_foodie</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M64.345,-13.5433C74.5383,-13.7458 86.7414,-13.9882 99.4535,-14.2408"/>
<polygon fill="#000000" stroke="#000000" points="99.6612,-17.7455 109.729,-14.4449 99.8003,-10.7469 99.6612,-17.7455"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="486pt" height="34pt"
 viewBox="0.00 0.00 486.00 34.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 483,-30 483,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="220,-26 156,-26 156,-1.24345e-14 220,-3.55271e-15 220,-26"/>
<text text-anchor="middle" x="188" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="292,-26 238,-26 238,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="265" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="478,-26 382,-26 382,-1.24345e-14 478,-3.55271e-15 478,-26"/>
<text text-anchor="middle" x="430" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a parent (sub)module to the submodule which is
    descended from it. Dashed arrows point from a module being used to the
    module or program unit using it.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
    

    <br><br>
    <p>Test without FOODIE with the integration of Euler 1D PDEs system by CAF paradigm.</p>
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: program~~integrate_euler_1d_caf~~CallsGraph Pages: 1 -->
<svg id="programintegrate_euler_1d_cafCallsGraph" width="456pt" height="239pt"
 viewBox="0.00 0.00 456.00 239.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~integrate_euler_1d_caf~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 235)">
<title>program~~integrate_euler_1d_caf~~CallsGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-235 453,-235 453,5 -4,5"/>
<!-- program~integrate_euler_1d_caf -->
<g id="node1" class="node"><title>program~integrate_euler_1d_caf</title>
<polygon fill="none" stroke="black" points="124,-128 4.9738e-14,-128 0,-102 124,-102 124,-128"/>
<text text-anchor="middle" x="62" y="-112.55" font-family="Helvetica,sans-Serif" font-size="10.50">integrate_euler_1D_caf</text>
</g>
<!-- str -->
<g id="node2" class="node"><title>str</title>
<polygon fill="#777777" stroke="#777777" points="448,-128 394,-128 394,-102 448,-102 448,-128"/>
<text text-anchor="middle" x="421" y="-112.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">str</text>
</g>
<!-- program~integrate_euler_1d_caf&#45;&gt;str -->
<g id="edge12" class="edge"><title>program~integrate_euler_1d_caf&#45;&gt;str</title>
<path fill="none" stroke="#000000" d="M84.4624,-128.069C103.766,-138.5 132.724,-152.279 160,-158 239.427,-174.659 333.569,-147.828 384.261,-129.611"/>
<polygon fill="#000000" stroke="#000000" points="385.628,-132.838 393.803,-126.098 383.209,-126.269 385.628,-132.838"/>
</g>
<!-- proc~save_time_serie -->
<g id="node3" class="node"><title>proc~save_time_serie</title>
<a xlink:href="../proc/save_time_serie.html" xlink:title="save_time_serie">
<polygon fill="#d9534f" stroke="#d9534f" points="357,-26 267,-26 267,-1.24345e-14 357,-3.55271e-15 357,-26"/>
<text text-anchor="middle" x="312" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_time_serie</text>
</a>
</g>
<!-- program~integrate_euler_1d_caf&#45;&gt;proc~save_time_serie -->
<g id="edge14" class="edge"><title>program~integrate_euler_1d_caf&#45;&gt;proc~save_time_serie</title>
<path fill="none" stroke="#000000" d="M72.7903,-101.978C89.3577,-82.9932 123.046,-48.2169 160,-32 190.062,-18.8076 226.476,-13.9202 256.125,-12.3959"/>
<polygon fill="#000000" stroke="#000000" points="256.456,-15.8855 266.309,-11.9888 256.177,-8.89108 256.456,-15.8855"/>
</g>
<!-- proc~synchronize -->
<g id="node4" class="node"><title>proc~synchronize</title>
<a xlink:href="../proc/synchronize.html" xlink:title="synchronize">
<polygon fill="#d9534f" stroke="#d9534f" points="230,-149 160,-149 160,-123 230,-123 230,-149"/>
<text text-anchor="middle" x="195" y="-133.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">synchronize</text>
</a>
</g>
<!-- program~integrate_euler_1d_caf&#45;&gt;proc~synchronize -->
<g id="edge16" class="edge"><title>program~integrate_euler_1d_caf&#45;&gt;proc~synchronize</title>
<path fill="none" stroke="#000000" d="M124.217,-124.824C132.773,-126.175 141.424,-127.541 149.601,-128.832"/>
<polygon fill="#000000" stroke="#000000" points="149.238,-132.318 159.661,-130.42 150.33,-125.403 149.238,-132.318"/>
</g>
<!-- strz -->
<g id="node5" class="node"><title>strz</title>
<polygon fill="#777777" stroke="#777777" points="339,-108 285,-108 285,-82 339,-82 339,-108"/>
<text text-anchor="middle" x="312" y="-92.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">strz</text>
</g>
<!-- program~integrate_euler_1d_caf&#45;&gt;strz -->
<g id="edge18" class="edge"><title>program~integrate_euler_1d_caf&#45;&gt;strz</title>
<path fill="none" stroke="#000000" d="M124.119,-110.03C171.51,-106.239 235.207,-101.143 274.92,-97.9664"/>
<polygon fill="#000000" stroke="#000000" points="275.274,-101.449 284.963,-97.163 274.716,-94.4717 275.274,-101.449"/>
</g>
<!-- proc~save_results~2 -->
<g id="node6" class="node"><title>proc~save_results~2</title>
<a xlink:href="../proc/save_results%7E2.html" xlink:title="save_results">
<polygon fill="#d9534f" stroke="#d9534f" points="348,-231 276,-231 276,-205 348,-205 348,-231"/>
<text text-anchor="middle" x="312" y="-215.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_results</text>
</a>
</g>
<!-- program~integrate_euler_1d_caf&#45;&gt;proc~save_results~2 -->
<g id="edge20" class="edge"><title>program~integrate_euler_1d_caf&#45;&gt;proc~save_results~2</title>
<path fill="none" stroke="#000000" d="M74.5823,-128.123C92.0324,-145.47 125.364,-175.628 160,-191 193.344,-205.799 234.201,-212.494 265.155,-215.519"/>
<polygon fill="#000000" stroke="#000000" points="264.978,-219.017 275.247,-216.41 265.594,-212.044 264.978,-219.017"/>
</g>
<!-- proc~init~13 -->
<g id="node7" class="node"><title>proc~init~13</title>
<a xlink:href="../proc/init%7E13.html" xlink:title="init">
<polygon fill="#d9534f" stroke="#d9534f" points="222,-67 168,-67 168,-41 222,-41 222,-67"/>
<text text-anchor="middle" x="195" y="-51.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init</text>
</a>
</g>
<!-- program~integrate_euler_1d_caf&#45;&gt;proc~init~13 -->
<g id="edge22" class="edge"><title>program~integrate_euler_1d_caf&#45;&gt;proc~init~13</title>
<path fill="none" stroke="#000000" d="M90.5318,-101.914C110.478,-92.7655 137.279,-80.4737 158.74,-70.6305"/>
<polygon fill="#000000" stroke="#000000" points="160.247,-73.79 167.878,-66.4396 157.329,-67.4272 160.247,-73.79"/>
</g>
<!-- proc~save_time_serie&#45;&gt;str -->
<g id="edge2" class="edge"><title>proc~save_time_serie&#45;&gt;str</title>
<path fill="none" stroke="#000000" d="M337.866,-26.1072C344.729,-30.1274 351.916,-34.8608 358,-40 376.742,-55.8332 394.37,-77.6425 406.186,-93.6624"/>
<polygon fill="#000000" stroke="#000000" points="403.434,-95.8296 412.123,-101.892 409.111,-91.7343 403.434,-95.8296"/>
</g>
<!-- proc~save_results~2&#45;&gt;str -->
<g id="edge4" class="edge"><title>proc~save_results~2&#45;&gt;str</title>
<path fill="none" stroke="#000000" d="M337.888,-204.919C344.751,-200.899 351.933,-196.159 358,-191 376.947,-174.888 394.659,-152.619 406.446,-136.352"/>
<polygon fill="#000000" stroke="#000000" points="409.431,-138.193 412.356,-128.01 403.719,-134.147 409.431,-138.193"/>
</g>
<!-- proc~init~13&#45;&gt;str -->
<g id="edge10" class="edge"><title>proc~init~13&#45;&gt;str</title>
<path fill="none" stroke="#000000" d="M222.142,-53.3377C255.24,-53.3844 312.403,-56.2512 358,-73 372.159,-78.201 386.283,-87.178 397.558,-95.501"/>
<polygon fill="#000000" stroke="#000000" points="395.517,-98.3463 405.578,-101.665 399.782,-92.796 395.517,-98.3463"/>
</g>
<!-- proc~init~13&#45;&gt;proc~save_time_serie -->
<g id="edge8" class="edge"><title>proc~init~13&#45;&gt;proc~save_time_serie</title>
<path fill="none" stroke="#000000" d="M222.136,-44.4907C234.983,-39.9887 250.696,-34.4826 265.368,-29.341"/>
<polygon fill="#000000" stroke="#000000" points="266.54,-32.6392 274.82,-26.029 264.225,-26.0331 266.54,-32.6392"/>
</g>
<!-- proc~init~13&#45;&gt;strz -->
<g id="edge6" class="edge"><title>proc~init~13&#45;&gt;strz</title>
<path fill="none" stroke="#000000" d="M222.136,-63.5093C237.824,-69.0067 257.784,-76.0012 274.906,-82.0013"/>
<polygon fill="#000000" stroke="#000000" points="274.011,-85.3962 284.606,-85.4003 276.326,-78.79 274.011,-85.3962"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="556pt" height="34pt"
 viewBox="0.00 0.00 556.00 34.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 553,-30 553,5 -4,5"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-26 3.19744e-14,-26 0,-1.24345e-14 64,-3.55271e-15 64,-26"/>
<text text-anchor="middle" x="32" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-26 82,-26 82,-1.24345e-14 136,-3.55271e-15 136,-26"/>
<text text-anchor="middle" x="109" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="208,-26 154,-26 154,-1.24345e-14 208,-3.55271e-15 208,-26"/>
<text text-anchor="middle" x="181" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="362,-26 226,-26 226,-1.24345e-14 362,-3.55271e-15 362,-26"/>
<text text-anchor="middle" x="294" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="434,-26 380,-26 380,-1.24345e-14 434,-3.55271e-15 434,-26"/>
<text text-anchor="middle" x="407" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="548,-26 452,-26 452,-1.24345e-14 548,-3.55271e-15 548,-26"/>
<text text-anchor="middle" x="500" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>

     <section class="visible-xs visible-sm hidden-md">
       


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-bc_l%7E11">BC_L</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-bc_r%7E11">BC_R</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-cfl%7E7">CFL</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-dt%7E29">Dt</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-dt%7E30">Dt</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-dx%7E11">Dx</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-nc%7E6">Nc</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-ni%7E13">Ni</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-ni%7E14">Ni</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-ni_image">Ni_image</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-np%7E6">Np</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-ns%7E11">Ns</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-cli%7E2">cli</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-count_rate">count_rate</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-cp0%7E11">cp0</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-cv0%7E11">cv0</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-domain">domain</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-error%7E14">error</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-final_state">final_state</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-id">id</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-initial_state%7E10">initial_state</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-me%7E5">me</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-ord%7E11">ord</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-plots%7E3">plots</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-plots%7E4">plots</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-profiling">profiling</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-results%7E3">results</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-results%7E4">results</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-rk_integrator">rk_integrator</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-rk_stage">rk_stage</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-rk_stages">rk_stages</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-steps%7E27">steps</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-steps_max">steps_max</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-steps_max%7E2">steps_max</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-system_clocks">system_clocks</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-t%7E44">t</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-time_serie">time_serie</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-time_serie%7E2">time_serie</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-verbose">verbose</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-verbose%7E2">verbose</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-we%7E5">we</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#variable-x%7E2">x</a>
      
    </div>
  </div>
</div>












<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#proc-init%7E13">init</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#proc-save_results%7E2">save_results</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#proc-save_time_serie">save_time_serie</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#proc-synchronize">synchronize</a>
      
    </div>
  </div>
</div>








<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../program/integrate_euler_1d_caf.html#src">integrate_euler_1D_caf</a>
  </div>
</div>


     </section>
     <br class="visible-xs visible-sm hidden-md">

     

    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-bc_l%7E11"></span>character(len=:),</td>
  
  
  <td>allocatable</td><td>::</td>
  <td><strong>BC_L</strong></td><td></td><td></td><td><p>Left boundary condition type.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-bc_r%7E11"></span>character(len=:),</td>
  
  
  <td>allocatable</td><td>::</td>
  <td><strong>BC_R</strong></td><td></td><td></td><td><p>Right boundary condition type.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cfl%7E7"></span>real(kind=R_P),</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>CFL</strong></td><td> =</td><td>0.7_R_P</td><td><p>CFL value.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E29"></span>real(kind=R_P),</td>
  
  
  <td>allocatable</td><td>::</td>
  <td><strong>Dt</strong>(:)[:]</td><td></td><td></td><td><p>Time step.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E30"></span>real(kind=R_P),</td>
  
  
  <td>allocatable</td><td>::</td>
  <td><strong>Dt</strong>(:)</td><td></td><td></td><td><p>Time step.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dx%7E11"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>Dx</strong></td><td></td><td></td><td><p>Space step discretization.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nc%7E6"></span>integer(kind=I_P),</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>Nc</strong></td><td> =</td><td>Ns+2</td><td><p>Number of conservative variables.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ni%7E13"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>Ni</strong>[*]</td><td></td><td></td><td><p>Number of grid cells.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ni%7E14"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>Ni</strong></td><td></td><td></td><td><p>Number of grid cells.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ni_image"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>Ni_image</strong></td><td></td><td></td><td><p>Space dimension of local image.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-np%7E6"></span>integer(kind=I_P),</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>Np</strong></td><td> =</td><td>Ns+4</td><td><p>Number of primitive variables.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ns%7E11"></span>integer(kind=I_P),</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>Ns</strong></td><td> =</td><td>1</td><td><p>Number of differnt initial gas species.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cli%7E2"></span>type(command_line_interface)</td>
  
  
  <td></td><td>::</td>
  <td><strong>cli</strong></td><td></td><td></td><td><p>Command line interface handler.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-count_rate"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>count_rate</strong></td><td></td><td></td><td><p>Counting rate of system clock.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cp0%7E11"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>cp0</strong>(1:Ns)</td><td></td><td></td><td><p>Specific heat at constant pressure.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cv0%7E11"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>cv0</strong>(1:Ns)</td><td></td><td></td><td><p>Specific heat at constant volume.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-domain"></span>type(euler_1D_caf_nf)</td>
  
  
  <td></td><td>::</td>
  <td><strong>domain</strong></td><td></td><td></td><td><p>Domain of Euler equations.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-error%7E14"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>error</strong></td><td></td><td></td><td><p>Error handler.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-final_state"></span>real(kind=R_P),</td>
  
  
  <td>allocatable</td><td>::</td>
  <td><strong>final_state</strong>(:,:)</td><td></td><td></td><td><p>Final state.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-id"></span>character(len=:),</td>
  
  
  <td>allocatable</td><td>::</td>
  <td><strong>id</strong></td><td></td><td></td><td><p>My ID.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-initial_state%7E10"></span>real(kind=R_P),</td>
  
  
  <td>allocatable</td><td>::</td>
  <td><strong>initial_state</strong>(:,:)</td><td></td><td></td><td><p>Initial state of primitive variables.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-me%7E5"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>me</strong></td><td></td><td></td><td><p>ID of this_image()</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ord%7E11"></span>integer,</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>ord</strong></td><td> =</td><td>7</td><td><p>Space reconstruciton order,</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-plots%7E3"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>plots</strong>[*]</td><td></td><td></td><td><p>Flag for activating plots saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-plots%7E4"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>plots</strong></td><td></td><td></td><td><p>Flag for activating plots saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-profiling"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>profiling</strong>(1:2)</td><td></td><td></td><td><p>Tic-toc profiling counters.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-results%7E3"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>results</strong>[*]</td><td></td><td></td><td><p>Flag for activating results saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-results%7E4"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>results</strong></td><td></td><td></td><td><p>Flag for activating results saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rk_integrator"></span>type(<a href='../type/tvd_runge_kutta_integrator.html'>tvd_runge_kutta_integrator</a>)</td>
  
  
  <td></td><td>::</td>
  <td><strong>rk_integrator</strong></td><td></td><td></td><td><p>Runge-Kutta integrator.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rk_stage"></span>type(euler_1D_caf_nf)</td>
  
  
  <td></td><td>::</td>
  <td><strong>rk_stage</strong>(1:rk_stages)</td><td></td><td></td><td><p>Runge-Kutta stages.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rk_stages"></span>integer,</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>rk_stages</strong></td><td> =</td><td>5</td><td><p>Runge-Kutta stages number.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-steps%7E27"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td></td><td></td><td><p>Time steps counter.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-steps_max"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>steps_max</strong>[*]</td><td></td><td></td><td><p>Maximum number of time steps.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-steps_max%7E2"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>steps_max</strong></td><td></td><td></td><td><p>Maximum number of time steps.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-system_clocks"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>system_clocks</strong></td><td></td><td></td><td><p>Profiling result.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t%7E44"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>t</strong></td><td></td><td></td><td><p>Time.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-time_serie"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>time_serie</strong>[*]</td><td></td><td></td><td><p>Flag for activating time serie-results saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-time_serie%7E2"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>time_serie</strong></td><td></td><td></td><td><p>Flag for activating time serie-results saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-verbose"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>verbose</strong>[*]</td><td></td><td></td><td><p>Flag for activating more verbose output.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-verbose%7E2"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>verbose</strong></td><td></td><td></td><td><p>Flag for activating more verbose output.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-we%7E5"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>we</strong></td><td></td><td></td><td><p>Number of CAF images used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x%7E2"></span>real(kind=R_P),</td>
  
  
  <td>allocatable</td><td>::</td>
  <td><strong>x</strong>(:)</td><td></td><td></td><td><p>Cell center x-abscissa values.</p></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    
    
    

    
    
    


    
    <section>
    <h2>Subroutines</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-init%7E13"></span><h3>
subroutine <a href='../proc/init%7E13.html'>init</a>()
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>Initialize the simulation.</p>
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-save_results%7E2"></span><h3>
subroutine <a href='../proc/save_results%7E2.html'>save_results</a>(title, filename)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>Save results.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>title</strong></td><td><p>Plot title.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>filename</strong></td><td><p>Output filename.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-save_time_serie"></span><h3>
subroutine <a href='../proc/save_time_serie.html'>save_time_serie</a>(title, filename, finish, t)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>Save time-serie results.</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>title</strong></td><td><p>Plot title.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>filename</strong></td><td><p>Output filename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>finish</strong></td><td><p>Flag for triggering the file closing.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t</strong></td><td><p>Current integration time.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-synchronize"></span><h3>
subroutine <a href='../proc/synchronize.html'>synchronize</a>()
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>Synchronize CAF images.</p>
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    

  </div>
  </div>

    
    </section>    
    
    
    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">program </span><span class="n">integrate_euler_1D_caf</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c">!&lt; Test without FOODIE with the integration of Euler 1D PDEs system by CAF paradigm.</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">use </span><span class="n">flap</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">command_line_interface</span>
<span class="k">use </span><span class="n">IR_Precision</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">R_P</span><span class="p">,</span> <span class="n">I_P</span><span class="p">,</span> <span class="n">FR_P</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">strz</span>
<span class="k">use </span><span class="n">pyplot_module</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">pyplot</span>
<span class="k">use </span><span class="n">type_euler_1D_caf_no_foodie</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">euler_1D_caf_nf</span><span class="p">,</span> <span class="n">tvd_runge_kutta_integrator</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">implicit none</span>
<span class="k">type</span><span class="p">(</span><span class="n">command_line_interface</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">cli</span>                   <span class="c">!&lt; Command line interface handler.</span>
<span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
<span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>               <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
<span class="k">type</span><span class="p">(</span><span class="n">euler_1D_caf_nf</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
<span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>               <span class="kd">::</span> <span class="n">ord</span><span class="o">=</span><span class="mi">7</span>                 <span class="c">!&lt; Space reconstruciton order,</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">t</span>                     <span class="c">!&lt; Time.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">parameter</span>          <span class="kd">::</span> <span class="n">CFL</span><span class="o">=</span><span class="mf">0.7_R_P</span>           <span class="c">!&lt; CFL value.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">parameter</span>          <span class="kd">::</span> <span class="n">Ns</span><span class="o">=</span><span class="mi">1</span>                  <span class="c">!&lt; Number of differnt initial gas species.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">parameter</span>          <span class="kd">::</span> <span class="n">Nc</span><span class="o">=</span><span class="n">Ns</span><span class="o">+</span><span class="mi">2</span>               <span class="c">!&lt; Number of conservative variables.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">parameter</span>          <span class="kd">::</span> <span class="n">Np</span><span class="o">=</span><span class="n">Ns</span><span class="o">+</span><span class="mi">4</span>               <span class="c">!&lt; Number of primitive variables.</span>
<span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">BC_L</span>                  <span class="c">!&lt; Left boundary condition type.</span>
<span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">BC_R</span>                  <span class="c">!&lt; Right boundary condition type.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">Dx</span>                    <span class="c">!&lt; Space step discretization.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">cp0</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Ns</span><span class="p">)</span>             <span class="c">!&lt; Specific heat at constant pressure.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">cv0</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Ns</span><span class="p">)</span>             <span class="c">!&lt; Specific heat at constant volume.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>           <span class="kd">::</span> <span class="n">initial_state</span><span class="p">(:,:)</span>    <span class="c">!&lt; Initial state of primitive variables.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>           <span class="kd">::</span> <span class="n">x</span><span class="p">(:)</span>                  <span class="c">!&lt; Cell center x-abscissa values.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>           <span class="kd">::</span> <span class="n">final_state</span><span class="p">(:,:)</span>      <span class="c">!&lt; Final state.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">error</span>                 <span class="c">!&lt; Error handler.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">profiling</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>        <span class="c">!&lt; Tic-toc profiling counters.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">count_rate</span>            <span class="c">!&lt; Counting rate of system clock.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">system_clocks</span>         <span class="c">!&lt; Profiling result.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">steps</span>                 <span class="c">!&lt; Time steps counter.</span>
<span class="k">type</span><span class="p">(</span><span class="n">euler_1D_caf_nf</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">domain</span>                <span class="c">!&lt; Domain of Euler equations.</span>
<span class="c">! coarrays-related variables</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">Ni_image</span>              <span class="c">!&lt; Space dimension of local image.</span>
<span class="cp">#ifdef CAF</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">Ni</span><span class="p">[</span><span class="o">*</span><span class="p">]</span>                 <span class="c">!&lt; Number of grid cells.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">steps_max</span><span class="p">[</span><span class="o">*</span><span class="p">]</span>          <span class="c">!&lt; Maximum number of time steps.</span>
<span class="kt">logical</span>                          <span class="kd">::</span> <span class="n">results</span><span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="c">!&lt; Flag for activating results saving.</span>
<span class="kt">logical</span>                          <span class="kd">::</span> <span class="n">plots</span><span class="p">[</span><span class="o">*</span><span class="p">]</span>              <span class="c">!&lt; Flag for activating plots saving.</span>
<span class="kt">logical</span>                          <span class="kd">::</span> <span class="n">time_serie</span><span class="p">[</span><span class="o">*</span><span class="p">]</span>         <span class="c">!&lt; Flag for activating time serie-results saving.</span>
<span class="kt">logical</span>                          <span class="kd">::</span> <span class="n">verbose</span><span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="c">!&lt; Flag for activating more verbose output.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>           <span class="kd">::</span> <span class="n">Dt</span><span class="p">(:)[:]</span>              <span class="c">!&lt; Time step.</span>
<span class="cp">#else</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">Ni</span>                    <span class="c">!&lt; Number of grid cells.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">steps_max</span>             <span class="c">!&lt; Maximum number of time steps.</span>
<span class="kt">logical</span>                          <span class="kd">::</span> <span class="n">results</span>               <span class="c">!&lt; Flag for activating results saving.</span>
<span class="kt">logical</span>                          <span class="kd">::</span> <span class="n">plots</span>                 <span class="c">!&lt; Flag for activating plots saving.</span>
<span class="kt">logical</span>                          <span class="kd">::</span> <span class="n">time_serie</span>            <span class="c">!&lt; Flag for activating time serie-results saving.</span>
<span class="kt">logical</span>                          <span class="kd">::</span> <span class="n">verbose</span>               <span class="c">!&lt; Flag for activating more verbose output.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>           <span class="kd">::</span> <span class="n">Dt</span><span class="p">(:)</span>                 <span class="c">!&lt; Time step.</span>
<span class="cp">#endif</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">me</span>                    <span class="c">!&lt; ID of this_image()</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">we</span>                    <span class="c">!&lt; Number of CAF images used.</span>
<span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">id</span>                    <span class="c">!&lt; My ID.</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="cp">#ifdef CAF</span>
<span class="n">me</span> <span class="o">=</span> <span class="nb">this_image</span><span class="p">()</span>
<span class="n">we</span> <span class="o">=</span> <span class="nb">num_images</span><span class="p">()</span>
<span class="cp">#else</span>
<span class="n">me</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">we</span> <span class="o">=</span> <span class="mi">1</span>
<span class="cp">#endif</span>
<span class="n">id</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">me</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&gt; &#39;</span>
<span class="c">! setting Command Line Interface</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">progname</span>    <span class="o">=</span> <span class="s1">&#39;euler-1D-caf-no-foodie&#39;</span><span class="p">,</span>                                          <span class="p">&amp;</span>
              <span class="n">authors</span>     <span class="o">=</span> <span class="s1">&#39;Fortran-FOSS-Programmers&#39;</span><span class="p">,</span>                                        <span class="p">&amp;</span>
              <span class="n">license</span>     <span class="o">=</span> <span class="s1">&#39;GNU GPLv3&#39;</span><span class="p">,</span>                                                       <span class="p">&amp;</span>
              <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Test 1D Euler equations integration without FOODIE, CAF enabled&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">examples</span>    <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;euler-1D-caf-no-foodie --results  &quot;</span><span class="p">,</span>                             <span class="p">&amp;</span>
                             <span class="s2">&quot;euler-1D-caf-no-foodie -r -t -v -p&quot;</span><span class="p">,</span>                             <span class="p">&amp;</span>
                             <span class="s2">&quot;euler-1D-caf-no-foodie            &quot;</span><span class="p">,</span>                             <span class="p">&amp;</span>
                             <span class="s2">&quot;euler-1D-caf-no-foodie --plots -r &quot;</span><span class="p">])</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--Ni&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Number finite volumes used&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--steps&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Number time steps performed&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;30&#39;</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--results&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Save results&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--plots&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Save plots of results&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--tserie&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Save time-serie-results&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--verbose&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Verbose output&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
<span class="c">! parsing Command Line Interface</span>
<span class="k">if</span> <span class="p">(</span><span class="n">me</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span> <span class="c">! only master image do CLI stuffs</span>
  <span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">parse</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
  <span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--Ni&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">Ni</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">  call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--steps&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">steps_max</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">  call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">  call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">plots</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">  call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">time_serie</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">  call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--verbose&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="n">endif</span>
<span class="k">call </span><span class="n">init</span><span class="p">()</span>
<span class="n">system_clocks</span> <span class="o">=</span> <span class="mf">0._R_P</span>
<span class="k">do </span><span class="n">steps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps_max</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">verbose</span><span class="p">)</span> <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;    Time step: &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">Dt</span><span class="p">(</span><span class="n">me</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Time: &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
  <span class="n">Dt</span><span class="p">(</span><span class="n">me</span><span class="p">)</span> <span class="o">=</span> <span class="n">domain</span><span class="p">%</span><span class="n">dt</span><span class="p">(</span><span class="n">Nmax</span><span class="o">=</span><span class="n">steps_max</span><span class="p">,</span> <span class="n">Tmax</span><span class="o">=</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">CFL</span><span class="o">=</span><span class="n">CFL</span><span class="p">)</span>
  <span class="k">call </span><span class="n">synchronize</span>
  <span class="k">call </span><span class="nb">system_clock</span><span class="p">(</span><span class="n">profiling</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">count_rate</span><span class="p">)</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">(</span><span class="n">me</span><span class="p">),</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
  <span class="k">call </span><span class="nb">system_clock</span><span class="p">(</span><span class="n">profiling</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">count_rate</span><span class="p">)</span>
  <span class="n">system_clocks</span> <span class="o">=</span> <span class="n">system_clocks</span> <span class="o">+</span> <span class="kt">real</span><span class="p">(</span><span class="n">profiling</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">profiling</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nb">kind</span><span class="o">=</span><span class="n">R_P</span><span class="p">)</span><span class="o">/</span><span class="n">count_rate</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">Dt</span><span class="p">(</span><span class="n">me</span><span class="p">)</span>
  <span class="k">call </span><span class="n">save_time_serie</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">enddo</span>
<span class="n">system_clocks</span> <span class="o">=</span> <span class="n">system_clocks</span> <span class="o">/</span> <span class="n">steps_max</span>
<span class="k">if</span> <span class="p">(</span><span class="n">verbose</span><span class="p">)</span> <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;    Time step: &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">Dt</span><span class="p">(</span><span class="n">me</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Time: &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="k">call </span><span class="n">save_time_serie</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">finish</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;FOODIE test: 1D Euler equations integration, explicit TVD Runge-Kutta&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
                        <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">rk_stages</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; stages&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;euler_1D_caf_nf_integration-tvdrk-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">rk_stages</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;-image-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">me</span><span class="p">)))</span>

<span class="k">print</span> <span class="s2">&quot;(A,I5,A,F23.15)&quot;</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span> <span class="n">we</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">system_clocks</span>
<span class="k">stop</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">contains</span>
<span class="k">  subroutine </span><span class="n">init</span><span class="p">()</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Initialize the simulation.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>   <span class="c">!&lt; Space counter.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">x_L</span> <span class="c">!&lt; Left abscissa of local image.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<span class="cp">#ifdef CAF</span>
  <span class="c">! CAF images comunications</span>
  <span class="k">sync all</span>
<span class="k">  if</span> <span class="p">(</span><span class="n">me</span><span class="o">/=</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">Ni</span> <span class="o">=</span> <span class="n">Ni</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">steps_max</span> <span class="o">=</span> <span class="n">steps_max</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">plots</span> <span class="o">=</span> <span class="n">plots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">time_serie</span> <span class="o">=</span> <span class="n">time_serie</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">endif</span>
<span class="cp">#endif</span>
  <span class="c">! init simulation</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">Ni</span><span class="p">,</span> <span class="n">we</span><span class="p">)</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="n">error</span> <span class="k">stop</span> <span class="s1">&#39;error: the number of cells Ni must be a multiple of the number of CAF images used!&#39;</span>
  <span class="n">Ni_image</span> <span class="o">=</span> <span class="n">Ni</span> <span class="o">/</span> <span class="n">we</span>
  <span class="k">allocate</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Ni_image</span><span class="p">))</span>
  <span class="k">allocate</span><span class="p">(</span><span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Np</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">Ni_image</span><span class="p">))</span>
  <span class="n">Dx</span> <span class="o">=</span> <span class="mf">1._R_P</span> <span class="o">/</span> <span class="n">Ni</span>
  <span class="c">! Sod&#39;s problem</span>
  <span class="n">cp0</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">104</span><span class="mf">0._R_P</span>
  <span class="n">cv0</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">74</span><span class="mf">3._R_P</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">we</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      </span><span class="n">BC_L</span> <span class="o">=</span> <span class="s1">&#39;TRA&#39;</span>
      <span class="n">BC_R</span> <span class="o">=</span> <span class="s1">&#39;TRA&#39;</span>
  <span class="k">else</span>
<span class="k">    if</span> <span class="p">(</span><span class="n">me</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      </span><span class="n">BC_L</span> <span class="o">=</span> <span class="s1">&#39;TRA&#39;</span>
      <span class="n">BC_R</span> <span class="o">=</span> <span class="s1">&#39;CON-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">me</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">elseif</span> <span class="p">(</span><span class="n">me</span><span class="o">==</span><span class="n">we</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      </span><span class="n">BC_L</span> <span class="o">=</span> <span class="s1">&#39;CON-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">me</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">BC_R</span> <span class="o">=</span> <span class="s1">&#39;TRA&#39;</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">BC_L</span> <span class="o">=</span> <span class="s1">&#39;CON-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">me</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">BC_R</span> <span class="o">=</span> <span class="s1">&#39;CON-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">me</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">endif</span>
  <span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">me</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">x_L</span> <span class="o">=</span> <span class="n">Ni_image</span> <span class="o">*</span> <span class="n">Dx</span> <span class="o">*</span> <span class="p">(</span><span class="n">me</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
  <span class="k">else</span>
<span class="k">    </span><span class="n">x_L</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">endif</span>
  <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Ni_image</span>
    <span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">x_L</span> <span class="o">+</span> <span class="n">Dx</span> <span class="o">*</span> <span class="n">i</span> <span class="o">-</span> <span class="mf">0.5_R_P</span> <span class="o">*</span> <span class="n">Dx</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">&lt;=</span><span class="mf">0.5_R_P</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      </span><span class="n">initial_state</span><span class="p">(:,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1._R_P</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! rho(s)</span>
                             <span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! u</span>
                             <span class="mf">1._R_P</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! p</span>
                             <span class="mf">1._R_P</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! sum(rho(s))</span>
                             <span class="n">cp0</span><span class="o">/</span><span class="n">cv0</span><span class="p">]</span>  <span class="c">! gamma = cp/cv</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">initial_state</span><span class="p">(:,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.125_R_P</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! rho(s)</span>
                             <span class="mf">0._R_P</span><span class="p">,</span>    <span class="p">&amp;</span> <span class="c">! u</span>
                             <span class="mf">0.1_R_P</span><span class="p">,</span>   <span class="p">&amp;</span> <span class="c">! p</span>
                             <span class="mf">0.125_R_P</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! sum(rho(s))</span>
                             <span class="n">cp0</span><span class="o">/</span><span class="n">cv0</span><span class="p">]</span>     <span class="c">! gamma = cp/cv</span>
    <span class="n">endif</span>
  <span class="n">enddo</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">verbose</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    print</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;image &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">me</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; of &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">we</span><span class="p">))</span>
    <span class="k">print</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;Number of total cells: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">Ni</span><span class="p">))</span>
    <span class="k">print</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;Number of time steps: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">steps_max</span><span class="p">))</span>
    <span class="k">print</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;Save final results: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
    <span class="k">print</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;Save plots of results: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">plots</span><span class="p">))</span>
    <span class="k">print</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;Save time serie of results: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">time_serie</span><span class="p">))</span>
    <span class="k">print</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;Left BC: &#39;</span><span class="o">//</span><span class="n">BC_L</span>
    <span class="k">print</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;Right BC: &#39;</span><span class="o">//</span><span class="n">BC_R</span>
    <span class="k">print</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;Space resolution: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">Dx</span><span class="p">))</span>
    <span class="k">print</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;X(1) X(N): &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">x</span><span class="p">(</span><span class="n">Ni_image</span><span class="p">)))</span>
    <span class="k">print</span> <span class="s1">&#39;(A)&#39;</span><span class="p">,</span> <span class="n">id</span><span class="o">//</span><span class="s1">&#39;Density value: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Ni_image</span><span class="p">)))</span>
  <span class="n">endif</span>
  <span class="c">! initialize integrator and domain</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">rk_stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">domain</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">Ni</span><span class="o">=</span><span class="n">Ni_image</span><span class="p">,</span> <span class="n">Ns</span><span class="o">=</span><span class="n">Ns</span><span class="p">,</span> <span class="n">Dx</span><span class="o">=</span><span class="n">Dx</span><span class="p">,</span> <span class="n">BC_L</span><span class="o">=</span><span class="n">BC_L</span><span class="p">,</span> <span class="n">BC_R</span><span class="o">=</span><span class="n">BC_R</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">cp0</span><span class="o">=</span><span class="n">cp0</span><span class="p">,</span> <span class="n">cv0</span><span class="o">=</span><span class="n">cv0</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">me</span><span class="o">=</span><span class="n">me</span><span class="p">,</span> <span class="n">we</span><span class="o">=</span><span class="n">we</span><span class="p">,</span> <span class="n">ord</span><span class="o">=</span><span class="n">ord</span><span class="p">)</span>
<span class="cp">#ifdef CAF</span>
  <span class="k">allocate</span><span class="p">(</span><span class="n">Dt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">we</span><span class="p">)[</span><span class="o">*</span><span class="p">])</span>
<span class="cp">#else</span>
  <span class="k">allocate</span><span class="p">(</span><span class="n">Dt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">we</span><span class="p">))</span>
<span class="cp">#endif</span>
  <span class="c">! initialize time serie file</span>
  <span class="k">call </span><span class="n">save_time_serie</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;FOODIE test: 1D Euler equations integration, explicit TVD Runge-Kutta&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
                             <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">rk_stages</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; stages&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;euler_1D_caf_integration-tvdrk-&#39;</span><span class="o">//</span><span class="p">&amp;</span>
                                <span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">rk_stages</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;-image-&#39;</span><span class="o">//</span><span class="p">&amp;</span>
                                <span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">me</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
                                <span class="s1">&#39;-time_serie.dat&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
  <span class="c">! initialize time variables</span>
  <span class="n">t</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">Dt</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">init</span>

  <span class="k">subroutine </span><span class="n">synchronize</span><span class="p">()</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Synchronize CAF images.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span> <span class="c">!&lt; Images counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
<span class="cp">#ifdef CAF</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">we</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    sync all</span>
    <span class="c">! reduction on minumum value of Dt</span>
    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">we</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">/=</span><span class="n">me</span><span class="p">)</span> <span class="n">Dt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">Dt</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span>
      <span class="n">Dt</span><span class="p">(</span><span class="n">me</span><span class="p">)</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Dt</span><span class="p">(</span><span class="n">me</span><span class="p">),</span> <span class="n">Dt</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">endif</span>
<span class="cp">#endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">synchronize</span>

  <span class="k">subroutine </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Save results.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">title</span>    <span class="c">!&lt; Plot title.</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">filename</span> <span class="c">!&lt; Output filename.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">rawfile</span>  <span class="c">!&lt; Raw file unit for saving results.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">pyplot</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">plt</span>      <span class="c">!&lt; Plot file handler.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">i</span>        <span class="c">!&lt; Counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">v</span>        <span class="c">!&lt; Counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">results</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">plots</span><span class="p">)</span> <span class="n">final_state</span> <span class="o">=</span> <span class="n">domain</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">rawfile</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">filename</span><span class="o">//</span><span class="s1">&#39;.dat&#39;</span><span class="p">)</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;# &#39;</span><span class="o">//</span><span class="n">title</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;VARIABLES=&quot;x&quot; &quot;rho(1)&quot; &quot;u&quot; &quot;p&quot; &quot;rho&quot; &quot;gamma&quot;&#39;</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;ZONE T=&quot;&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span>
    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Ni_image</span>
      <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">Np</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="n">FR_P</span><span class="o">//</span><span class="s1">&#39;,1X))&#39;</span><span class="p">)</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">final_state</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Np</span><span class="p">)</span>
    <span class="n">enddo</span>
    <span class="k">close</span><span class="p">(</span><span class="n">rawfile</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">plots</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    call </span><span class="n">plt</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    <span class="k">do </span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Ns</span>
      <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">final_state</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;rho(&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">v</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">enddo</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">final_state</span><span class="p">(</span><span class="n">Ns</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">final_state</span><span class="p">(</span><span class="n">Ns</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">final_state</span><span class="p">(</span><span class="n">Ns</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">final_state</span><span class="p">(</span><span class="n">Ns</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;c-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="o">//</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">save_results</span>

  <span class="k">subroutine </span><span class="n">save_time_serie</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">finish</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Save time-serie results.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">title</span>    <span class="c">!&lt; Plot title.</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">filename</span> <span class="c">!&lt; Output filename.</span>
  <span class="kt">logical</span><span class="p">,</span>      <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">finish</span>   <span class="c">!&lt; Flag for triggering the file closing.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">t</span>        <span class="c">!&lt; Current integration time.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">save</span>                 <span class="kd">::</span> <span class="n">tsfile</span>   <span class="c">!&lt; File unit for saving time serie results.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">i</span>        <span class="c">!&lt; Counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">v</span>        <span class="c">!&lt; Counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">time_serie</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">final_state</span> <span class="o">=</span> <span class="n">domain</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">filename</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span><span class="nb">present</span><span class="p">(</span><span class="n">title</span><span class="p">))</span> <span class="k">then</span>
<span class="k">      open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">tsfile</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
      <span class="k">write</span><span class="p">(</span><span class="n">tsfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;# &#39;</span><span class="o">//</span><span class="n">title</span>
    <span class="n">endif</span>
    <span class="k">write</span><span class="p">(</span><span class="n">tsfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;VARIABLES=&quot;x&quot; &quot;rho(1)&quot; &quot;u&quot; &quot;p&quot; &quot;rho&quot; &quot;gamma&quot;&#39;</span>
    <span class="k">write</span><span class="p">(</span><span class="n">tsfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;ZONE T=&quot;&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span>
    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Ni_image</span>
      <span class="k">write</span><span class="p">(</span><span class="n">tsfile</span><span class="p">,</span> <span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">Np</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;(&#39;</span><span class="o">//</span><span class="n">FR_P</span><span class="o">//</span><span class="s1">&#39;,1X))&#39;</span><span class="p">)</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">final_state</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Np</span><span class="p">)</span>
    <span class="n">enddo</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">finish</span><span class="p">))</span> <span class="k">then</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">finish</span><span class="p">)</span> <span class="k">close</span><span class="p">(</span><span class="n">tsfile</span><span class="p">)</span>
    <span class="n">endif</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">save_time_serie</span>
<span class="n">endprogram</span> <span class="n">integrate_euler_1D_caf</span>
</pre></div>

    </section>
    
    
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprogs-1">All Programs</a></h3></div>
  <div id="allprogs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_burgers.html">integrate_burgers</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d.html">integrate_euler_1D</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf.html">integrate_euler_1D_caf</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_caf%7E2.html">integrate_euler_1D_caf</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_openmp.html">integrate_euler_1D_openmp</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_openmp_no_foodie.html">integrate_euler_1D_openmp_no_foodie</a>
      
      <a class="list-group-item" href="../program/integrate_lorenz.html">integrate_lorenz</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html">integrate_oscillation</a>
      
    </div>
  </div>
</div>


  </section>
  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2017-03-31 15:32  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> FOODIE was developed by Fortran-FOSS-Programmers Group</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>