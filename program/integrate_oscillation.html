<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Fortran Object oriented Ordinary Differential Equations integration library">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>integrate_oscillation &ndash; FOODIE</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FOODIE </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
                
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
				
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>integrate_oscillation 
    <small>Program</small>
    
    </h1>
	 
<div class="row">
<div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
    <li><i class="fa fa-code"></i><a href="../src/oscillation.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/oscillation.f90.html'>oscillation.f90</a></li>
  
     <li class="active">integrate_oscillation</li>
  </ol>
</div>
</div>
</div>
    
  </div>
  
  <div class="row">
    <div class="col-lg-3">
    
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Variables</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-cli">cli</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-space_dimension">space_dimension</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-initial_state%7E7">initial_state</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-f%7E6">f</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-t_final">t_final</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-dt%7E14">Dt</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-tolerance%7E3">tolerance</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-error%7E5">error</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-stages_steps">stages_steps</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-implicit_iterations">implicit_iterations</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-solver%7E2">solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-plots">plots</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-results">results</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-output_cli">output_cli</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-errors_analysis">errors_analysis</a>
      
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Functions</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-exact_solution">exact_solution</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-compute_errors">compute_errors</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-estimate_orders">estimate_orders</a>
      
    </div>
  </div>
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Subroutines</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-init%7E8">init</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-save_results">save_results</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_ab">test_ab</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_abm">test_abm</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_am">test_am</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_emd_rk">test_emd_rk</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_euler">test_euler</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_leapfrog">test_leapfrog</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_ls_rk">test_ls_rk</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_tvd_rk">test_tvd_rk</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-ab_solver">ab_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-abm_solver">abm_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-am_solver">am_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-emd_rk_solver">emd_rk_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-euler_solver">euler_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-leapfrog_solver">leapfrog_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-ls_rk_solver">ls_rk_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-tvd_rk_solver">tvd_rk_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-perform_errors_analysis">perform_errors_analysis</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-print_analysis">print_analysis</a>
      
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
    <div class="list-group">
      <a class="list-group-item" href="../program/integrate_oscillation.html#src">integrate_oscillation</a>
    </div>
  </div>
  
  <hr>
  
  <div class="panel panel-default">
    <div class="panel-heading text-left"><h3 class="panel-title">All Programs</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_burgers.html">integrate_burgers</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d.html">integrate_euler_1D</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_openmp.html">integrate_euler_1D_openmp</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_openmp_no_foodie.html">integrate_euler_1D_openmp_no_foodie</a>
      
      <a class="list-group-item" href="../program/integrate_lorenz.html">integrate_lorenz</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html">integrate_oscillation</a>
      
    </div>
  </div>
  
  
    </div>
    
    <div class="col-lg-9" id='text'>
    
  
    <ul class="list-inline">
      <li><h4>Uses:</h4></li>
      
      <li>IR_Precision</li>
      
      <li><a href='../module/type_oscillation.html'>type_oscillation</a></li>
      
      <li>Data_Type_Command_Line_Interface</li>
      
      <li><a href='../module/foodie.html'>foodie</a></li>
      
      <li>pyplot_module</li>
      
    </ul>
  

    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: program~~integrate_oscillation~~UsesGraph Pages: 1 -->
<svg id="programintegrate_oscillationUsesGraph" width="641pt" height="198pt"
 viewBox="0.00 0.00 641.00 197.79" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~integrate_oscillation~~UsesGraph" class="graph" transform="scale(0.517771 0.517771) rotate(0) translate(4 378)">
<title>program~~integrate_oscillation~~UsesGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-378 1235,-378 1235,5 -4,5"/>
<!-- program~integrate_oscillation -->
<g id="node1" class="node"><title>program~integrate_oscillation</title>
<polygon fill="none" stroke="black" points="1229,-108 1123,-108 1123,-82 1229,-82 1229,-108"/>
<text text-anchor="middle" x="1176" y="-92.55" font-family="Helvetica,sans-Serif" font-size="10.50">integrate_oscillation</text>
</g>
<!-- pyplot_module -->
<g id="node2" class="node"><title>pyplot_module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="1029,-190 947,-190 947,-164 1029,-164 1029,-190"/>
<text text-anchor="middle" x="988" y="-174.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pyplot_module</text>
</g>
<!-- pyplot_module&#45;&gt;program~integrate_oscillation -->
<g id="edge64" class="edge"><title>pyplot_module&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1029.4,-168.319C1047.21,-163.895 1068.02,-157.785 1086,-150 1108.47,-140.271 1132.01,-125.703 1149.38,-114.004"/>
<polygon fill="black" stroke="black" points="1151.6,-116.729 1157.87,-108.188 1147.64,-110.956 1151.6,-116.729"/>
</g>
<!-- module~type_oscillation -->
<g id="node3" class="node"><title>module~type_oscillation</title>
<a xlink:href="../module/type_oscillation.html" xlink:title="type_oscillation">
<polygon fill="#337ab7" stroke="#337ab7" points="1030,-108 946,-108 946,-82 1030,-82 1030,-108"/>
<text text-anchor="middle" x="988" y="-92.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">type_oscillation</text>
</a>
</g>
<!-- module~type_oscillation&#45;&gt;program~integrate_oscillation -->
<g id="edge66" class="edge"><title>module~type_oscillation&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1030.66,-95C1054.77,-95 1085.39,-95 1112.29,-95"/>
<polygon fill="black" stroke="black" points="1112.4,-98.5001 1122.4,-95 1112.4,-91.5001 1112.4,-98.5001"/>
</g>
<!-- module~foodie -->
<g id="node4" class="node"><title>module~foodie</title>
<a xlink:href="../module/foodie.html" xlink:title="foodie">
<polygon fill="#337ab7" stroke="#337ab7" points="844,-139 790,-139 790,-113 844,-113 844,-139"/>
<text text-anchor="middle" x="817" y="-123.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie</text>
</a>
</g>
<!-- module~foodie&#45;&gt;program~integrate_oscillation -->
<g id="edge68" class="edge"><title>module~foodie&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M844.266,-126.934C893.027,-128.196 998.276,-129.058 1086,-117 1097.34,-115.441 1109.33,-113.05 1120.73,-110.408"/>
<polygon fill="black" stroke="black" points="1121.66,-113.783 1130.57,-108.037 1120.02,-106.978 1121.66,-113.783"/>
</g>
<!-- module~foodie&#45;&gt;module~type_oscillation -->
<g id="edge2" class="edge"><title>module~foodie&#45;&gt;module~type_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M844.095,-121.088C868.548,-116.655 905.208,-110.009 935.406,-104.535"/>
<polygon fill="black" stroke="black" points="936.157,-107.956 945.372,-102.728 934.908,-101.068 936.157,-107.956"/>
</g>
<!-- IR_Precision -->
<g id="node5" class="node"><title>IR_Precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="853,-76 781,-76 781,-50 853,-50 853,-76"/>
<text text-anchor="middle" x="817" y="-60.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">IR_Precision</text>
</g>
<!-- IR_Precision&#45;&gt;program~integrate_oscillation -->
<g id="edge70" class="edge"><title>IR_Precision&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M853.754,-62.022C905.743,-61.1696 1003.61,-61.5196 1086,-73 1097.34,-74.5796 1109.32,-76.9807 1120.72,-79.6247"/>
<polygon fill="black" stroke="black" points="1120.02,-83.055 1130.56,-81.9962 1121.66,-76.25 1120.02,-83.055"/>
</g>
<!-- IR_Precision&#45;&gt;module~type_oscillation -->
<g id="edge4" class="edge"><title>IR_Precision&#45;&gt;module~type_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M853.684,-69.8648C877.527,-74.3267 908.987,-80.2139 935.466,-85.169"/>
<polygon fill="black" stroke="black" points="934.871,-88.6184 945.344,-87.0176 936.158,-81.7378 934.871,-88.6184"/>
</g>
<!-- Data_Type_Command_Line_Interface -->
<g id="node6" class="node"><title>Data_Type_Command_Line_Interface</title>
<polygon fill="#337ab7" stroke="#337ab7" points="1085,-26 891,-26 891,-1.24345e-14 1085,-3.55271e-15 1085,-26"/>
<text text-anchor="middle" x="988" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Data_Type_Command_Line_Interface</text>
</g>
<!-- Data_Type_Command_Line_Interface&#45;&gt;program~integrate_oscillation -->
<g id="edge72" class="edge"><title>Data_Type_Command_Line_Interface&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1045.67,-26.0003C1059.16,-29.8266 1073.29,-34.4944 1086,-40 1108.47,-49.7294 1132.01,-64.2973 1149.38,-75.9963"/>
<polygon fill="black" stroke="black" points="1147.64,-79.0442 1157.87,-81.8118 1151.6,-73.2706 1147.64,-79.0442"/>
</g>
<!-- module~foodie_integrator_euler_explicit -->
<g id="node9" class="node"><title>module~foodie_integrator_euler_explicit</title>
<a xlink:href="../module/foodie_integrator_euler_explicit.html" xlink:title="foodie_integrator_euler_explicit">
<polygon fill="#337ab7" stroke="#337ab7" points="451,-330 289,-330 289,-304 451,-304 451,-330"/>
<text text-anchor="middle" x="370" y="-314.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_euler_explicit</text>
</a>
</g>
<!-- module~foodie_integrator_euler_explicit&#45;&gt;module~foodie -->
<g id="edge46" class="edge"><title>module~foodie_integrator_euler_explicit&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451.063,-303.955C460.95,-301.44 470.801,-298.478 480,-295 552.088,-267.743 556.18,-230.14 630,-208"/>
</g>
<!-- module~foodie_integrator_leapfrog -->
<g id="node10" class="node"><title>module~foodie_integrator_leapfrog</title>
<a xlink:href="../module/foodie_integrator_leapfrog.html" xlink:title="foodie_integrator_leapfrog">
<polygon fill="#337ab7" stroke="#337ab7" points="439,-286 301,-286 301,-260 439,-260 439,-286"/>
<text text-anchor="middle" x="370" y="-270.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_leapfrog</text>
</a>
</g>
<!-- module~foodie_integrator_leapfrog&#45;&gt;module~foodie -->
<g id="edge48" class="edge"><title>module~foodie_integrator_leapfrog&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M439.725,-259.95C453.134,-257.188 467.036,-254.149 480,-251 547.392,-234.63 563.571,-227.923 630,-208"/>
</g>
<!-- module~foodie_integrator_adams_bashforth -->
<g id="node11" class="node"><title>module~foodie_integrator_adams_bashforth</title>
<a xlink:href="../module/foodie_integrator_adams_bashforth.html" xlink:title="foodie_integrator_adams_bashforth">
<polygon fill="#337ab7" stroke="#337ab7" points="461,-160 279,-160 279,-134 461,-134 461,-160"/>
<text text-anchor="middle" x="370" y="-144.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_adams_bashforth</text>
</a>
</g>
<!-- module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie -->
<g id="edge50" class="edge"><title>module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M424.165,-160.059C499.622,-178.203 627.498,-208.75 630,-208"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M630,-208C685.482,-191.36 746.321,-162.555 783.076,-143.894"/>
<polygon fill="black" stroke="black" points="785.029,-146.826 792.331,-139.15 781.836,-140.597 785.029,-146.826"/>
</g>
<!-- module~foodie_integrator_adams_bashforth_moulton -->
<g id="node14" class="node"><title>module~foodie_integrator_adams_bashforth_moulton</title>
<a xlink:href="../module/foodie_integrator_adams_bashforth_moulton.html" xlink:title="foodie_integrator_adams_bashforth_moulton">
<polygon fill="#337ab7" stroke="#337ab7" points="743,-139 517,-139 517,-113 743,-113 743,-139"/>
<text text-anchor="middle" x="630" y="-123.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_adams_bashforth_moulton</text>
</a>
</g>
<!-- module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie_integrator_adams_bashforth_moulton -->
<g id="edge24" class="edge"><title>module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie_integrator_adams_bashforth_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M461.666,-139.596C476.04,-138.435 491.1,-137.219 506.053,-136.011"/>
<polygon fill="black" stroke="black" points="506.693,-139.471 516.378,-135.177 506.129,-132.494 506.693,-139.471"/>
</g>
<!-- module~foodie_integrator_tvd_runge_kutta -->
<g id="node12" class="node"><title>module~foodie_integrator_tvd_runge_kutta</title>
<a xlink:href="../module/foodie_integrator_tvd_runge_kutta.html" xlink:title="foodie_integrator_tvd_runge_kutta">
<polygon fill="#337ab7" stroke="#337ab7" points="458,-242 282,-242 282,-216 458,-216 458,-242"/>
<text text-anchor="middle" x="370" y="-226.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_tvd_runge_kutta</text>
</a>
</g>
<!-- module~foodie_integrator_tvd_runge_kutta&#45;&gt;module~foodie -->
<g id="edge52" class="edge"><title>module~foodie_integrator_tvd_runge_kutta&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M458.658,-230.983C509.731,-229.882 574.586,-224.62 630,-208"/>
</g>
<!-- module~foodie_adt_integrand -->
<g id="node13" class="node"><title>module~foodie_adt_integrand</title>
<a xlink:href="../module/foodie_adt_integrand.html" xlink:title="foodie_adt_integrand">
<polygon fill="#337ab7" stroke="#337ab7" points="224,-201 110,-201 110,-175 224,-175 224,-201"/>
<text text-anchor="middle" x="167" y="-185.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_adt_integrand</text>
</a>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie -->
<g id="edge54" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M370,-188C485.803,-183.331 518.988,-241.294 630,-208"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_euler_explicit -->
<g id="edge8" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_euler_explicit</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M174.511,-201.349C188.256,-224.446 219.779,-271.631 260,-295 265.94,-298.451 272.331,-301.369 278.937,-303.835"/>
<polygon fill="black" stroke="black" points="278.147,-307.262 288.741,-307.134 280.379,-300.627 278.147,-307.262"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_leapfrog -->
<g id="edge12" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_leapfrog</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M182.329,-201.25C199.899,-215.722 230.137,-238.501 260,-251 269.598,-255.017 279.981,-258.316 290.403,-261.021"/>
<polygon fill="black" stroke="black" points="289.84,-264.486 300.383,-263.437 291.487,-257.682 289.84,-264.486"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_bashforth -->
<g id="edge16" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_bashforth</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224.087,-176.47C246.251,-171.994 271.935,-166.806 295.519,-162.043"/>
<polygon fill="black" stroke="black" points="296.373,-165.441 305.482,-160.031 294.987,-158.58 296.373,-165.441"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_tvd_runge_kutta -->
<g id="edge20" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_tvd_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224.087,-199.53C246.251,-204.006 271.935,-209.194 295.519,-213.957"/>
<polygon fill="black" stroke="black" points="294.987,-217.42 305.482,-215.969 296.373,-210.559 294.987,-217.42"/>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_bashforth_moulton -->
<g id="edge30" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_bashforth_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224.338,-189.231C265.011,-189.803 320.876,-189.981 370,-188"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M370,-188C446.94,-184.898 533.376,-159.768 584.671,-142.47"/>
<polygon fill="black" stroke="black" points="586.121,-145.673 594.448,-139.123 583.854,-139.05 586.121,-145.673"/>
</g>
<!-- module~foodie_integrator_low_storage_runge_kutta -->
<g id="node15" class="node"><title>module~foodie_integrator_low_storage_runge_kutta</title>
<a xlink:href="../module/foodie_integrator_low_storage_runge_kutta.html" xlink:title="foodie_integrator_low_storage_runge_kutta">
<polygon fill="#337ab7" stroke="#337ab7" points="480,-34 260,-34 260,-8 480,-8 480,-34"/>
<text text-anchor="middle" x="370" y="-18.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_low_storage_runge_kutta</text>
</a>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_low_storage_runge_kutta -->
<g id="edge36" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_low_storage_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M179.912,-174.757C192.271,-161.616 210.917,-140.524 224,-120 244.306,-88.1436 230.282,-66.3238 260,-43 261.637,-41.7149 263.33,-40.4988 265.07,-39.3481"/>
<polygon fill="black" stroke="black" points="267.216,-42.1507 274.131,-34.1238 263.72,-36.0864 267.216,-42.1507"/>
</g>
<!-- module~foodie_integrator_emd_runge_kutta -->
<g id="node16" class="node"><title>module~foodie_integrator_emd_runge_kutta</title>
<a xlink:href="../module/foodie_integrator_emd_runge_kutta.html" xlink:title="foodie_integrator_emd_runge_kutta">
<polygon fill="#337ab7" stroke="#337ab7" points="462,-374 278,-374 278,-348 462,-348 462,-374"/>
<text text-anchor="middle" x="370" y="-358.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_emd_runge_kutta</text>
</a>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_emd_runge_kutta -->
<g id="edge40" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_emd_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M175.009,-201.079C197.416,-237.664 259.173,-338.424 260,-339 262.757,-340.919 265.642,-342.68 268.626,-344.294"/>
<polygon fill="black" stroke="black" points="267.31,-347.545 277.84,-348.712 270.336,-341.233 267.31,-347.545"/>
</g>
<!-- module~foodie_integrator_adams_moulton -->
<g id="node17" class="node"><title>module~foodie_integrator_adams_moulton</title>
<a xlink:href="../module/foodie_integrator_adams_moulton.html" xlink:title="foodie_integrator_adams_moulton">
<polygon fill="#337ab7" stroke="#337ab7" points="458,-78 282,-78 282,-52 458,-52 458,-78"/>
<text text-anchor="middle" x="370" y="-62.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_adams_moulton</text>
</a>
</g>
<!-- module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_moulton -->
<g id="edge44" class="edge"><title>module~foodie_adt_integrand&#45;&gt;module~foodie_integrator_adams_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185.185,-174.917C203.689,-161.789 233.356,-141.239 260,-125 284.705,-109.942 313.43,-94.3357 335.33,-82.8149"/>
<polygon fill="black" stroke="black" points="337.028,-85.8771 344.267,-78.141 333.783,-79.6742 337.028,-85.8771"/>
</g>
<!-- module~foodie_integrator_adams_bashforth_moulton&#45;&gt;module~foodie -->
<g id="edge56" class="edge"><title>module~foodie_integrator_adams_bashforth_moulton&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M743.629,-126C756.478,-126 768.794,-126 779.544,-126"/>
<polygon fill="black" stroke="black" points="779.734,-129.5 789.734,-126 779.734,-122.5 779.734,-129.5"/>
</g>
<!-- module~foodie_integrator_low_storage_runge_kutta&#45;&gt;module~foodie -->
<g id="edge58" class="edge"><title>module~foodie_integrator_low_storage_runge_kutta&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M455.446,-34.0381C506.297,-42.151 572.006,-53.2521 630,-65"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M630,-65C683.613,-75.8604 743.348,-97.013 780.553,-111.325"/>
<polygon fill="black" stroke="black" points="779.378,-114.624 789.967,-114.986 781.915,-108.1 779.378,-114.624"/>
</g>
<!-- module~foodie_integrator_emd_runge_kutta&#45;&gt;module~foodie -->
<g id="edge60" class="edge"><title>module~foodie_integrator_emd_runge_kutta&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M457.282,-347.977C465.146,-345.49 472.837,-342.528 480,-339 559.403,-299.893 545.22,-233.427 630,-208"/>
</g>
<!-- module~foodie_integrator_adams_moulton&#45;&gt;module~foodie -->
<g id="edge62" class="edge"><title>module~foodie_integrator_adams_moulton&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M458.126,-56.3632C508.88,-53.529 573.594,-53.5737 630,-65"/>
</g>
<!-- module~foodie_integrator_adams_moulton&#45;&gt;module~foodie_integrator_adams_bashforth_moulton -->
<g id="edge26" class="edge"><title>module~foodie_integrator_adams_moulton&#45;&gt;module~foodie_integrator_adams_bashforth_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M425.458,-78.0112C466.136,-87.555 521.521,-100.549 564.4,-110.609"/>
<polygon fill="black" stroke="black" points="563.645,-114.027 574.18,-112.904 565.244,-107.212 563.645,-114.027"/>
</g>
<!-- module~foodie_kinds -->
<g id="node18" class="node"><title>module~foodie_kinds</title>
<a xlink:href="../module/foodie_kinds.html" xlink:title="foodie_kinds">
<polygon fill="#337ab7" stroke="#337ab7" points="73,-160 1,-160 1,-134 73,-134 73,-160"/>
<text text-anchor="middle" x="37" y="-144.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_kinds</text>
</a>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_euler_explicit -->
<g id="edge6" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_euler_explicit</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-295C201.538,-310.633 242.647,-317.044 278.809,-319.209"/>
<polygon fill="black" stroke="black" points="278.705,-322.708 288.868,-319.712 279.055,-315.717 278.705,-322.708"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_leapfrog -->
<g id="edge10" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_leapfrog</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-295C190.265,-305.53 251.64,-297.24 300.86,-287.977"/>
<polygon fill="black" stroke="black" points="301.686,-291.383 310.844,-286.055 300.362,-284.509 301.686,-291.383"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth -->
<g id="edge14" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-106C180.695,-103.892 251.506,-119.189 305.68,-131.695"/>
<polygon fill="black" stroke="black" points="305.052,-135.142 315.584,-133.993 306.634,-128.323 305.052,-135.142"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_tvd_runge_kutta -->
<g id="edge18" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_tvd_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43.5117,-160.175C59.5084,-190.835 104.064,-266.514 167,-295"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-295C208.658,-313.855 216.59,-265.369 260,-251 267.28,-248.59 274.923,-246.401 282.645,-244.422"/>
<polygon fill="black" stroke="black" points="283.563,-247.801 292.446,-242.027 281.901,-241.001 283.563,-247.801"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_adt_integrand -->
<g id="edge22" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_adt_integrand</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M73.5582,-158.53C86.7381,-162.687 101.861,-167.456 116.047,-171.93"/>
<polygon fill="black" stroke="black" points="115.093,-175.299 125.683,-174.969 117.199,-168.623 115.093,-175.299"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth_moulton -->
<g id="edge28" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-106C294.938,-86.3034 444.938,-99.2635 538.738,-111.613"/>
<polygon fill="black" stroke="black" points="538.387,-115.097 548.763,-112.959 539.318,-108.159 538.387,-115.097"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_low_storage_runge_kutta -->
<g id="edge34" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_low_storage_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41.5301,-133.954C50.4631,-110.447 72.7795,-61.4356 110,-40 151.563,-16.0634 203.27,-8.68852 249.6,-8.26543"/>
<polygon fill="black" stroke="black" points="249.7,-11.7655 259.705,-8.28079 249.71,-4.7655 249.7,-11.7655"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_emd_runge_kutta -->
<g id="edge38" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_emd_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-295C208.658,-313.855 216.59,-324.631 260,-339 267.28,-341.41 274.923,-343.599 282.645,-345.578"/>
<polygon fill="black" stroke="black" points="281.901,-348.999 292.446,-347.973 283.563,-342.199 281.901,-348.999"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_moulton -->
<g id="edge42" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_moulton</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M68.9338,-133.91C94.8563,-124.026 132.617,-111.293 167,-106"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167,-106C212.7,-98.9643 263.713,-88.6508 303.169,-80.1282"/>
<polygon fill="black" stroke="black" points="303.913,-83.5483 312.941,-78.0031 302.425,-76.7081 303.913,-83.5483"/>
</g>
<!-- iso_fortran_env -->
<g id="node32" class="node"><title>iso_fortran_env</title>
<a xlink:href="https://gcc.gnu.org/onlinedocs/gfortran/ISO_005fFORTRAN_005fENV.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="210,-75 124,-75 124,-49 210,-49 210,-75"/>
<text text-anchor="middle" x="167" y="-59.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
<!-- iso_fortran_env&#45;&gt;module~foodie_integrator_low_storage_runge_kutta -->
<g id="edge32" class="edge"><title>iso_fortran_env&#45;&gt;module~foodie_integrator_low_storage_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M210.52,-53.0701C226.123,-49.8787 243.847,-46.2652 260,-43 271.147,-40.7466 282.932,-38.3766 294.484,-36.0603"/>
<polygon fill="black" stroke="black" points="295.437,-39.4391 304.554,-34.0429 294.062,-32.5755 295.437,-39.4391"/>
</g>
</g>
</svg>
</div>
                <script>var panprogramintegrate_oscillationUsesGraph = svgPanZoom('#programintegrate_oscillationUsesGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
    <br><br>
    <p>Test FOODIE with the integration of Oscillation equations.</p>
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: program~~integrate_oscillation~~CallsGraph Pages: 1 -->
<svg id="programintegrate_oscillationCallsGraph" width="526pt" height="904pt"
 viewBox="0.00 0.00 526.00 904.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~integrate_oscillation~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 900)">
<title>program~~integrate_oscillation~~CallsGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-900 523,-900 523,5 -4,5"/>
<!-- program~integrate_oscillation -->
<g id="node1" class="node"><title>program~integrate_oscillation</title>
<polygon fill="none" stroke="black" points="107,-574 1,-574 1,-548 107,-548 107,-574"/>
<text text-anchor="middle" x="54" y="-558.55" font-family="Helvetica,sans-Serif" font-size="10.50">integrate_oscillation</text>
</g>
<!-- proc~test_leapfrog -->
<g id="node2" class="node"><title>proc~test_leapfrog</title>
<a xlink:href="../proc/test_leapfrog.html" xlink:title="test_leapfrog">
<polygon fill="#d9534f" stroke="#d9534f" points="246,-706 172,-706 172,-680 246,-680 246,-706"/>
<text text-anchor="middle" x="209" y="-690.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_leapfrog</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_leapfrog -->
<g id="edge102" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_leapfrog</title>
<path fill="none" stroke="black" d="M61.389,-574.204C74.8767,-597.145 105.661,-644.448 144,-671 149.335,-674.695 155.342,-677.813 161.494,-680.433"/>
<polygon fill="black" stroke="black" points="160.614,-683.844 171.205,-684.151 163.117,-677.307 160.614,-683.844"/>
</g>
<!-- proc~test_tvd_rk -->
<g id="node3" class="node"><title>proc~test_tvd_rk</title>
<a xlink:href="../proc/test_tvd_rk.html" xlink:title="test_tvd_rk">
<polygon fill="#d9534f" stroke="#d9534f" points="241,-662 177,-662 177,-636 241,-636 241,-662"/>
<text text-anchor="middle" x="209" y="-646.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_tvd_rk</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_tvd_rk -->
<g id="edge104" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_tvd_rk</title>
<path fill="none" stroke="black" d="M68.9687,-574.234C86.093,-588.814 115.464,-612.16 144,-627 151.135,-630.71 159.026,-633.993 166.779,-636.817"/>
<polygon fill="black" stroke="black" points="165.863,-640.203 176.457,-640.145 168.139,-633.583 165.863,-640.203"/>
</g>
<!-- proc~test_euler -->
<g id="node4" class="node"><title>proc~test_euler</title>
<a xlink:href="../proc/test_euler.html" xlink:title="test_euler">
<polygon fill="#d9534f" stroke="#d9534f" points="239,-750 179,-750 179,-724 239,-724 239,-750"/>
<text text-anchor="middle" x="209" y="-734.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_euler</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_euler -->
<g id="edge106" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_euler</title>
<path fill="none" stroke="black" d="M58.1456,-574.264C68.0698,-603.881 96.0032,-675.857 144,-715 151.323,-720.972 160.347,-725.355 169.316,-728.561"/>
<polygon fill="black" stroke="black" points="168.353,-731.927 178.943,-731.596 170.458,-725.251 168.353,-731.927"/>
</g>
<!-- proc~test_am -->
<g id="node5" class="node"><title>proc~test_am</title>
<a xlink:href="../proc/test_am.html" xlink:title="test_am">
<polygon fill="#d9534f" stroke="#d9534f" points="236,-574 182,-574 182,-548 236,-548 236,-574"/>
<text text-anchor="middle" x="209" y="-558.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_am</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_am -->
<g id="edge108" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_am</title>
<path fill="none" stroke="black" d="M107.776,-561C128.876,-561 152.572,-561 171.73,-561"/>
<polygon fill="black" stroke="black" points="171.861,-564.5 181.861,-561 171.861,-557.5 171.861,-564.5"/>
</g>
<!-- proc~perform_errors_analysis -->
<g id="node6" class="node"><title>proc~perform_errors_analysis</title>
<a xlink:href="../proc/perform_errors_analysis.html" xlink:title="perform_errors_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="273,-360 145,-360 145,-334 273,-334 273,-360"/>
<text text-anchor="middle" x="209" y="-344.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">perform_errors_analysis</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~perform_errors_analysis -->
<g id="edge110" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~perform_errors_analysis</title>
<path fill="none" stroke="black" d="M60.047,-547.807C73.0854,-520.111 105.777,-454.546 144,-407 155.84,-392.272 171.315,-377.841 184.195,-366.823"/>
<polygon fill="black" stroke="black" points="186.797,-369.209 192.22,-360.107 182.305,-363.841 186.797,-369.209"/>
</g>
<!-- proc~test_ab -->
<g id="node7" class="node"><title>proc~test_ab</title>
<a xlink:href="../proc/test_ab.html" xlink:title="test_ab">
<polygon fill="#d9534f" stroke="#d9534f" points="236,-530 182,-530 182,-504 236,-504 236,-530"/>
<text text-anchor="middle" x="209" y="-514.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_ab</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_ab -->
<g id="edge112" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_ab</title>
<path fill="none" stroke="black" d="M100.085,-547.918C123.043,-541.401 150.427,-533.627 171.993,-527.505"/>
<polygon fill="black" stroke="black" points="173.097,-530.83 181.761,-524.732 171.186,-524.096 173.097,-530.83"/>
</g>
<!-- proc~test_abm -->
<g id="node8" class="node"><title>proc~test_abm</title>
<a xlink:href="../proc/test_abm.html" xlink:title="test_abm">
<polygon fill="#d9534f" stroke="#d9534f" points="237,-486 181,-486 181,-460 237,-460 237,-486"/>
<text text-anchor="middle" x="209" y="-470.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_abm</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_abm -->
<g id="edge114" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_abm</title>
<path fill="none" stroke="black" d="M68.9687,-547.766C86.093,-533.186 115.464,-509.84 144,-495 152.383,-490.64 161.811,-486.87 170.831,-483.743"/>
<polygon fill="black" stroke="black" points="171.982,-487.05 180.391,-480.605 169.798,-480.399 171.982,-487.05"/>
</g>
<!-- proc~test_emd_rk -->
<g id="node9" class="node"><title>proc~test_emd_rk</title>
<a xlink:href="../proc/test_emd_rk.html" xlink:title="test_emd_rk">
<polygon fill="#d9534f" stroke="#d9534f" points="245,-618 173,-618 173,-592 245,-592 245,-618"/>
<text text-anchor="middle" x="209" y="-602.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_emd_rk</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_emd_rk -->
<g id="edge116" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_emd_rk</title>
<path fill="none" stroke="black" d="M100.085,-574.082C119.934,-579.717 143.092,-586.29 162.937,-591.924"/>
<polygon fill="black" stroke="black" points="162.105,-595.326 172.681,-594.69 164.017,-588.592 162.105,-595.326"/>
</g>
<!-- proc~test_ls_rk -->
<g id="node10" class="node"><title>proc~test_ls_rk</title>
<a xlink:href="../proc/test_ls_rk.html" xlink:title="test_ls_rk">
<polygon fill="#d9534f" stroke="#d9534f" points="238,-442 180,-442 180,-416 238,-416 238,-442"/>
<text text-anchor="middle" x="209" y="-426.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_ls_rk</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_ls_rk -->
<g id="edge118" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_ls_rk</title>
<path fill="none" stroke="black" d="M61.389,-547.796C74.8767,-524.855 105.661,-477.552 144,-451 151.84,-445.57 161.132,-441.385 170.202,-438.197"/>
<polygon fill="black" stroke="black" points="171.41,-441.486 179.877,-435.118 169.286,-434.816 171.41,-441.486"/>
</g>
<!-- proc~leapfrog_solver -->
<g id="node11" class="node"><title>proc~leapfrog_solver</title>
<a xlink:href="../proc/leapfrog_solver.html" xlink:title="leapfrog_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="398,-574 312,-574 312,-548 398,-548 398,-574"/>
<text text-anchor="middle" x="355" y="-558.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">leapfrog_solver</text>
</a>
</g>
<!-- proc~test_leapfrog&#45;&gt;proc~leapfrog_solver -->
<g id="edge8" class="edge"><title>proc~test_leapfrog&#45;&gt;proc~leapfrog_solver</title>
<path fill="none" stroke="black" d="M246.707,-686.176C256.521,-682.913 266.447,-678.098 274,-671 304.792,-642.059 281.128,-613.856 310,-583 310.902,-582.036 311.856,-581.108 312.852,-580.217"/>
<polygon fill="black" stroke="black" points="315.199,-582.834 321.155,-574.072 311.035,-577.207 315.199,-582.834"/>
</g>
<!-- proc~save_results -->
<g id="node12" class="node"><title>proc~save_results</title>
<a xlink:href="../proc/save_results.html" xlink:title="save_results">
<polygon fill="#d9534f" stroke="#d9534f" points="391,-618 319,-618 319,-592 391,-592 391,-618"/>
<text text-anchor="middle" x="355" y="-602.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_results</text>
</a>
</g>
<!-- proc~test_leapfrog&#45;&gt;proc~save_results -->
<g id="edge10" class="edge"><title>proc~test_leapfrog&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M246.756,-682.759C255.946,-679.586 265.555,-675.669 274,-671 296.576,-658.519 319.066,-639.537 334.598,-625.129"/>
<polygon fill="black" stroke="black" points="337.197,-627.488 342.05,-618.07 332.383,-622.406 337.197,-627.488"/>
</g>
<!-- proc~init~8 -->
<g id="node13" class="node"><title>proc~init~8</title>
<a xlink:href="../proc/init%7E8.html" xlink:title="init">
<polygon fill="#d9534f" stroke="#d9534f" points="382,-700 328,-700 328,-674 382,-674 382,-700"/>
<text text-anchor="middle" x="355" y="-684.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init</text>
</a>
</g>
<!-- proc~test_leapfrog&#45;&gt;proc~init~8 -->
<g id="edge12" class="edge"><title>proc~test_leapfrog&#45;&gt;proc~init~8</title>
<path fill="none" stroke="black" d="M246.599,-691.455C268.381,-690.56 295.712,-689.436 317.481,-688.542"/>
<polygon fill="black" stroke="black" points="317.825,-692.031 327.672,-688.123 317.537,-685.037 317.825,-692.031"/>
</g>
<!-- str -->
<g id="node14" class="node"><title>str</title>
<polygon fill="#777777" stroke="#777777" points="504,-657 450,-657 450,-631 504,-631 504,-657"/>
<text text-anchor="middle" x="477" y="-641.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">str</text>
</g>
<!-- proc~test_leapfrog&#45;&gt;str -->
<g id="edge14" class="edge"><title>proc~test_leapfrog&#45;&gt;str</title>
<path fill="none" stroke="black" d="M246.622,-701.499C256.111,-704.743 265.895,-709.13 274,-715 295.597,-730.642 286.149,-751.074 310,-763 345.777,-780.889 367.162,-785.84 400,-763 437.751,-736.743 405.788,-700.667 436,-666 437.672,-664.082 439.553,-662.302 441.567,-660.657"/>
<polygon fill="black" stroke="black" points="443.58,-663.52 449.827,-654.963 439.608,-657.756 443.58,-663.52"/>
</g>
<!-- proc~test_tvd_rk&#45;&gt;proc~save_results -->
<g id="edge18" class="edge"><title>proc~test_tvd_rk&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M241.765,-639.126C261.523,-633.171 287,-625.493 308.783,-618.929"/>
<polygon fill="black" stroke="black" points="309.932,-622.238 318.497,-616.001 307.913,-615.535 309.932,-622.238"/>
</g>
<!-- proc~test_tvd_rk&#45;&gt;proc~init~8 -->
<g id="edge20" class="edge"><title>proc~test_tvd_rk&#45;&gt;proc~init~8</title>
<path fill="none" stroke="black" d="M241.765,-657.528C264.322,-663.399 294.332,-671.21 317.79,-677.315"/>
<polygon fill="black" stroke="black" points="317.169,-680.77 327.728,-679.902 318.933,-673.996 317.169,-680.77"/>
</g>
<!-- proc~test_tvd_rk&#45;&gt;str -->
<g id="edge22" class="edge"><title>proc~test_tvd_rk&#45;&gt;str</title>
<path fill="none" stroke="black" d="M241.629,-654.763C252.87,-658.034 264.906,-663.121 274,-671 300.74,-694.168 279.852,-723.484 310,-742 344.085,-762.934 366.2,-763.39 400,-742 431.583,-722.013 410.242,-693.082 436,-666 437.583,-664.335 439.321,-662.769 441.158,-661.3"/>
<polygon fill="black" stroke="black" points="443.405,-664.004 449.692,-655.476 439.459,-658.222 443.405,-664.004"/>
</g>
<!-- proc~tvd_rk_solver -->
<g id="node24" class="node"><title>proc~tvd_rk_solver</title>
<a xlink:href="../proc/tvd_rk_solver.html" xlink:title="tvd_rk_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="393,-530 317,-530 317,-504 393,-504 393,-530"/>
<text text-anchor="middle" x="355" y="-514.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tvd_rk_solver</text>
</a>
</g>
<!-- proc~test_tvd_rk&#45;&gt;proc~tvd_rk_solver -->
<g id="edge16" class="edge"><title>proc~test_tvd_rk&#45;&gt;proc~tvd_rk_solver</title>
<path fill="none" stroke="black" d="M241.653,-643.73C253.028,-640.505 265.145,-635.322 274,-627 304.792,-598.059 281.128,-569.856 310,-539 310.902,-538.036 311.856,-537.108 312.852,-536.217"/>
<polygon fill="black" stroke="black" points="315.199,-538.834 321.155,-530.072 311.035,-533.207 315.199,-538.834"/>
</g>
<!-- proc~test_euler&#45;&gt;proc~save_results -->
<g id="edge24" class="edge"><title>proc~test_euler&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M239.009,-731.018C250.712,-727.664 263.749,-722.578 274,-715 296.02,-698.723 293.784,-687.065 310,-665 319.462,-652.124 330.194,-637.805 338.803,-626.385"/>
<polygon fill="black" stroke="black" points="341.683,-628.379 344.916,-618.29 336.097,-624.161 341.683,-628.379"/>
</g>
<!-- proc~test_euler&#45;&gt;proc~init~8 -->
<g id="edge28" class="edge"><title>proc~test_euler&#45;&gt;proc~init~8</title>
<path fill="none" stroke="black" d="M239.11,-726.854C250.096,-723.14 262.615,-718.894 274,-715 288.387,-710.079 304.196,-704.624 317.998,-699.847"/>
<polygon fill="black" stroke="black" points="319.342,-703.086 327.645,-696.505 317.05,-696.471 319.342,-703.086"/>
</g>
<!-- proc~test_euler&#45;&gt;str -->
<g id="edge30" class="edge"><title>proc~test_euler&#45;&gt;str</title>
<path fill="none" stroke="black" d="M226.693,-750.099C262.824,-775.119 346.208,-823.828 400,-784 444.067,-751.372 401.216,-708.385 436,-666 437.614,-664.033 439.452,-662.217 441.434,-660.545"/>
<polygon fill="black" stroke="black" points="443.453,-663.403 449.624,-654.79 439.429,-657.676 443.453,-663.403"/>
</g>
<!-- proc~euler_solver -->
<g id="node29" class="node"><title>proc~euler_solver</title>
<a xlink:href="../proc/euler_solver.html" xlink:title="euler_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-896 320,-896 320,-870 390,-870 390,-896"/>
<text text-anchor="middle" x="355" y="-880.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">euler_solver</text>
</a>
</g>
<!-- proc~test_euler&#45;&gt;proc~euler_solver -->
<g id="edge26" class="edge"><title>proc~test_euler&#45;&gt;proc~euler_solver</title>
<path fill="none" stroke="black" d="M217.851,-750.007C234.124,-773.272 270.745,-822.685 310,-856 313.454,-858.931 317.263,-861.742 321.16,-864.369"/>
<polygon fill="black" stroke="black" points="319.407,-867.402 329.726,-869.801 323.156,-861.49 319.407,-867.402"/>
</g>
<!-- proc~test_am&#45;&gt;proc~save_results -->
<g id="edge32" class="edge"><title>proc~test_am&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M236.119,-569.173C256.486,-575.311 284.865,-583.863 308.788,-591.073"/>
<polygon fill="black" stroke="black" points="307.805,-594.432 318.39,-593.967 309.825,-587.73 307.805,-594.432"/>
</g>
<!-- proc~test_am&#45;&gt;proc~init~8 -->
<g id="edge36" class="edge"><title>proc~test_am&#45;&gt;proc~init~8</title>
<path fill="none" stroke="black" d="M236.168,-565.115C248.895,-568.22 263.523,-573.626 274,-583 302.153,-608.19 284.699,-631.946 310,-660 312.815,-663.121 316.076,-665.993 319.531,-668.606"/>
<polygon fill="black" stroke="black" points="317.585,-671.515 327.828,-674.225 321.511,-665.719 317.585,-671.515"/>
</g>
<!-- proc~test_am&#45;&gt;str -->
<g id="edge38" class="edge"><title>proc~test_am&#45;&gt;str</title>
<path fill="none" stroke="black" d="M236.184,-566.571C248.476,-569.968 262.737,-575.2 274,-583 294.772,-597.386 287.745,-615.036 310,-627 350.244,-648.634 403.831,-650.146 439.324,-648.068"/>
<polygon fill="black" stroke="black" points="439.997,-651.529 449.723,-647.326 439.499,-644.547 439.997,-651.529"/>
</g>
<!-- proc~am_solver -->
<g id="node34" class="node"><title>proc~am_solver</title>
<a xlink:href="../proc/am_solver.html" xlink:title="am_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="386,-442 324,-442 324,-416 386,-416 386,-442"/>
<text text-anchor="middle" x="355" y="-426.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">am_solver</text>
</a>
</g>
<!-- proc~test_am&#45;&gt;proc~am_solver -->
<g id="edge34" class="edge"><title>proc~test_am&#45;&gt;proc~am_solver</title>
<path fill="none" stroke="black" d="M236.046,-557.184C248.898,-554.146 263.67,-548.709 274,-539 304.792,-510.059 281.128,-481.856 310,-451 311.593,-449.297 313.346,-447.71 315.208,-446.233"/>
<polygon fill="black" stroke="black" points="317.525,-448.895 323.911,-440.442 313.647,-443.068 317.525,-448.895"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~leapfrog_solver -->
<g id="edge68" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~leapfrog_solver</title>
<path fill="none" stroke="black" d="M228.243,-360.099C242.856,-371.015 262.36,-387.836 274,-407 305.567,-458.974 271.238,-492.146 310,-539 310.721,-539.871 311.484,-540.71 312.284,-541.519"/>
<polygon fill="black" stroke="black" points="310.327,-544.437 320.307,-547.992 314.722,-538.989 310.327,-544.437"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~save_results -->
<g id="edge60" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M228.893,-360.119C243.66,-370.931 263.06,-387.604 274,-407 313.225,-476.542 261.116,-519.873 310,-583 310.582,-583.752 311.197,-584.48 311.84,-585.184"/>
<polygon fill="black" stroke="black" points="309.777,-588.026 319.651,-591.868 314.328,-582.707 309.777,-588.026"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~init~8 -->
<g id="edge56" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~init~8</title>
<path fill="none" stroke="black" d="M229.419,-360.223C244.262,-370.977 263.518,-387.527 274,-407 320.96,-494.243 271.157,-535.853 310,-627 316.102,-641.318 326.316,-655.346 335.472,-666.234"/>
<polygon fill="black" stroke="black" points="332.962,-668.68 342.182,-673.9 338.23,-664.07 332.962,-668.68"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;str -->
<g id="edge44" class="edge"><title>proc~perform_errors_analysis&#45;&gt;str</title>
<path fill="none" stroke="black" d="M211.393,-333.956C218.692,-298.443 244.315,-200.077 310,-161 344.377,-140.549 369.571,-135.037 400,-161 408.951,-168.637 460.157,-525.356 473.709,-620.75"/>
<polygon fill="black" stroke="black" points="470.267,-621.405 475.137,-630.814 477.198,-620.422 470.267,-621.405"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~tvd_rk_solver -->
<g id="edge46" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~tvd_rk_solver</title>
<path fill="none" stroke="black" d="M227.024,-360.057C241.339,-371.193 261.038,-388.329 274,-407 298.099,-441.712 281.128,-464.144 310,-495 310.902,-495.964 311.856,-496.892 312.852,-497.783"/>
<polygon fill="black" stroke="black" points="311.035,-500.793 321.155,-503.928 315.199,-495.166 311.035,-500.793"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~am_solver -->
<g id="edge62" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~am_solver</title>
<path fill="none" stroke="black" d="M232.457,-360.175C256.936,-373.923 295.485,-395.574 322.803,-410.917"/>
<polygon fill="black" stroke="black" points="321.168,-414.013 331.601,-415.858 324.596,-407.909 321.168,-414.013"/>
</g>
<!-- proc~emd_rk_solver -->
<g id="node39" class="node"><title>proc~emd_rk_solver</title>
<a xlink:href="../proc/emd_rk_solver.html" xlink:title="emd_rk_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="396,-486 314,-486 314,-460 396,-460 396,-486"/>
<text text-anchor="middle" x="355" y="-470.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">emd_rk_solver</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~emd_rk_solver -->
<g id="edge48" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~emd_rk_solver</title>
<path fill="none" stroke="black" d="M224.275,-360.017C237.818,-371.806 257.888,-389.897 274,-407 291.325,-425.392 290.194,-435.312 310,-451 311.534,-452.215 313.146,-453.386 314.81,-454.512"/>
<polygon fill="black" stroke="black" points="313.085,-457.559 323.45,-459.756 316.717,-451.575 313.085,-457.559"/>
</g>
<!-- proc~compute_errors -->
<g id="node40" class="node"><title>proc~compute_errors</title>
<a xlink:href="../proc/compute_errors.html" xlink:title="compute_errors">
<polygon fill="#d94e8f" stroke="#d94e8f" points="399,-70 311,-70 311,-44 399,-44 399,-70"/>
<text text-anchor="middle" x="355" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_errors</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~compute_errors -->
<g id="edge50" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~compute_errors</title>
<path fill="none" stroke="black" d="M210.52,-333.786C216.03,-291.473 238.558,-157.519 310,-79 310.761,-78.1638 311.56,-77.3558 312.393,-76.5753"/>
<polygon fill="black" stroke="black" points="314.806,-79.1354 320.613,-70.2738 310.547,-73.5799 314.806,-79.1354"/>
</g>
<!-- proc~abm_solver -->
<g id="node41" class="node"><title>proc~abm_solver</title>
<a xlink:href="../proc/abm_solver.html" xlink:title="abm_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="389,-278 321,-278 321,-252 389,-252 389,-278"/>
<text text-anchor="middle" x="355" y="-262.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">abm_solver</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~abm_solver -->
<g id="edge52" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~abm_solver</title>
<path fill="none" stroke="black" d="M229.992,-333.85C250.224,-321.34 281.828,-302.222 310,-287 312.668,-285.558 315.445,-284.101 318.25,-282.659"/>
<polygon fill="black" stroke="black" points="319.857,-285.769 327.214,-278.145 316.708,-279.517 319.857,-285.769"/>
</g>
<!-- proc~ab_solver -->
<g id="node42" class="node"><title>proc~ab_solver</title>
<a xlink:href="../proc/ab_solver.html" xlink:title="ab_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="384,-322 326,-322 326,-296 384,-296 384,-322"/>
<text text-anchor="middle" x="355" y="-306.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ab_solver</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~ab_solver -->
<g id="edge54" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~ab_solver</title>
<path fill="none" stroke="black" d="M259.245,-333.923C277.586,-329.149 298.057,-323.821 315.348,-319.32"/>
<polygon fill="black" stroke="black" points="316.326,-322.683 325.122,-316.777 314.563,-315.908 316.326,-322.683"/>
</g>
<!-- proc~print_analysis -->
<g id="node43" class="node"><title>proc~print_analysis</title>
<a xlink:href="../proc/print_analysis.html" xlink:title="print_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="394,-114 316,-114 316,-88 394,-88 394,-114"/>
<text text-anchor="middle" x="355" y="-98.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_analysis</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~print_analysis -->
<g id="edge58" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~print_analysis</title>
<path fill="none" stroke="black" d="M212.12,-333.89C221.369,-297.384 251.703,-192.979 310,-128 312.662,-125.033 315.728,-122.292 318.983,-119.785"/>
<polygon fill="black" stroke="black" points="321.078,-122.592 327.339,-114.045 317.115,-116.823 321.078,-122.592"/>
</g>
<!-- proc~estimate_orders -->
<g id="node44" class="node"><title>proc~estimate_orders</title>
<a xlink:href="../proc/estimate_orders.html" xlink:title="estimate_orders">
<polygon fill="#d94e8f" stroke="#d94e8f" points="400,-26 310,-26 310,-1.24345e-14 400,-3.55271e-15 400,-26"/>
<text text-anchor="middle" x="355" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">estimate_orders</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~estimate_orders -->
<g id="edge64" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~estimate_orders</title>
<path fill="none" stroke="black" d="M209.681,-333.981C212.762,-287.613 229.04,-128.324 310,-35 310.741,-34.1461 311.522,-33.3221 312.339,-32.5273"/>
<polygon fill="black" stroke="black" points="314.765,-35.0719 320.461,-26.1384 310.437,-29.5701 314.765,-35.0719"/>
</g>
<!-- proc~ls_rk_solver -->
<g id="node45" class="node"><title>proc~ls_rk_solver</title>
<a xlink:href="../proc/ls_rk_solver.html" xlink:title="ls_rk_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-196 320,-196 320,-170 390,-170 390,-196"/>
<text text-anchor="middle" x="355" y="-180.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ls_rk_solver</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~ls_rk_solver -->
<g id="edge66" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~ls_rk_solver</title>
<path fill="none" stroke="black" d="M216.209,-333.975C231.082,-307.965 267.369,-248.767 310,-210 313.185,-207.104 316.727,-204.357 320.386,-201.803"/>
<polygon fill="black" stroke="black" points="322.529,-204.585 329.023,-196.214 318.726,-198.708 322.529,-204.585"/>
</g>
<!-- proc~test_ab&#45;&gt;proc~save_results -->
<g id="edge70" class="edge"><title>proc~test_ab&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M236.184,-522.571C248.476,-525.968 262.737,-531.2 274,-539 294.772,-553.386 290.194,-567.312 310,-583 311.534,-584.215 313.146,-585.386 314.81,-586.512"/>
<polygon fill="black" stroke="black" points="313.085,-589.559 323.45,-591.756 316.717,-583.575 313.085,-589.559"/>
</g>
<!-- proc~test_ab&#45;&gt;proc~init~8 -->
<g id="edge74" class="edge"><title>proc~test_ab&#45;&gt;proc~init~8</title>
<path fill="none" stroke="black" d="M236.046,-520.816C248.898,-523.854 263.67,-529.291 274,-539 304.792,-567.941 289.153,-590.243 310,-627 317.78,-640.719 328.272,-654.888 337.168,-666.009"/>
<polygon fill="black" stroke="black" points="334.549,-668.336 343.588,-673.862 339.968,-663.905 334.549,-668.336"/>
</g>
<!-- proc~test_ab&#45;&gt;str -->
<g id="edge76" class="edge"><title>proc~test_ab&#45;&gt;str</title>
<path fill="none" stroke="black" d="M236.046,-513.184C248.898,-510.146 263.67,-504.709 274,-495 304.792,-466.059 274.916,-430.554 310,-407 343.21,-384.704 367.64,-383.488 400,-407 435.446,-432.753 463.004,-566.114 472.967,-620.684"/>
<polygon fill="black" stroke="black" points="469.566,-621.552 474.772,-630.78 476.457,-620.32 469.566,-621.552"/>
</g>
<!-- proc~test_ab&#45;&gt;proc~ab_solver -->
<g id="edge72" class="edge"><title>proc~test_ab&#45;&gt;proc~ab_solver</title>
<path fill="none" stroke="black" d="M236.144,-513.687C249.178,-510.773 264.081,-505.295 274,-495 312.93,-454.595 285.729,-424.586 310,-374 317.453,-358.466 328.417,-342.537 337.657,-330.336"/>
<polygon fill="black" stroke="black" points="340.631,-332.213 344.005,-322.169 335.104,-327.917 340.631,-332.213"/>
</g>
<!-- proc~test_abm&#45;&gt;proc~save_results -->
<g id="edge80" class="edge"><title>proc~test_abm&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M237.676,-477.212C250.131,-480.319 264.104,-485.699 274,-495 304.792,-523.941 281.128,-552.144 310,-583 310.902,-583.964 311.856,-584.892 312.852,-585.783"/>
<polygon fill="black" stroke="black" points="311.035,-588.793 321.155,-591.928 315.199,-583.166 311.035,-588.793"/>
</g>
<!-- proc~test_abm&#45;&gt;proc~init~8 -->
<g id="edge82" class="edge"><title>proc~test_abm&#45;&gt;proc~init~8</title>
<path fill="none" stroke="black" d="M237.557,-476.515C250.292,-479.478 264.526,-484.939 274,-495 315.687,-539.271 283.283,-572.374 310,-627 316.838,-640.981 327.101,-654.987 336.1,-665.947"/>
<polygon fill="black" stroke="black" points="333.521,-668.317 342.657,-673.682 338.861,-663.791 333.521,-668.317"/>
</g>
<!-- proc~test_abm&#45;&gt;str -->
<g id="edge84" class="edge"><title>proc~test_abm&#45;&gt;str</title>
<path fill="none" stroke="black" d="M237.539,-468.183C249.822,-464.963 263.694,-459.661 274,-451 299.579,-429.503 281.268,-402.056 310,-385 344.396,-364.581 367.938,-361.083 400,-385 438.592,-413.788 464.802,-562.932 473.674,-620.911"/>
<polygon fill="black" stroke="black" points="470.231,-621.556 475.172,-630.928 477.154,-620.52 470.231,-621.556"/>
</g>
<!-- proc~test_abm&#45;&gt;proc~abm_solver -->
<g id="edge78" class="edge"><title>proc~test_abm&#45;&gt;proc~abm_solver</title>
<path fill="none" stroke="black" d="M237.786,-469.695C250.571,-466.778 264.781,-461.296 274,-451 323.779,-395.405 263.889,-345.673 310,-287 310.816,-285.962 311.694,-284.969 312.623,-284.02"/>
<polygon fill="black" stroke="black" points="315.01,-286.591 320.582,-277.58 310.607,-281.149 315.01,-286.591"/>
</g>
<!-- proc~test_emd_rk&#45;&gt;proc~save_results -->
<g id="edge88" class="edge"><title>proc~test_emd_rk&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M245.09,-605C264.161,-605 287.793,-605 308.251,-605"/>
<polygon fill="black" stroke="black" points="308.311,-608.5 318.311,-605 308.311,-601.5 308.311,-608.5"/>
</g>
<!-- proc~test_emd_rk&#45;&gt;proc~init~8 -->
<g id="edge90" class="edge"><title>proc~test_emd_rk&#45;&gt;proc~init~8</title>
<path fill="none" stroke="black" d="M245.256,-614.319C254.952,-617.589 265.182,-621.784 274,-627 292.682,-638.05 292.606,-647.017 310,-660 313.902,-662.912 318.135,-665.785 322.392,-668.508"/>
<polygon fill="black" stroke="black" points="320.714,-671.585 331.064,-673.852 324.387,-665.626 320.714,-671.585"/>
</g>
<!-- proc~test_emd_rk&#45;&gt;str -->
<g id="edge92" class="edge"><title>proc~test_emd_rk&#45;&gt;str</title>
<path fill="none" stroke="black" d="M245.238,-611.509C255.483,-614.779 266.007,-619.676 274,-627 303.346,-653.889 276.676,-687.236 310,-709 343.49,-730.873 363.757,-725.925 400,-709 422.583,-698.454 416.668,-681.733 436,-666 437.551,-664.738 439.185,-663.514 440.872,-662.333"/>
<polygon fill="black" stroke="black" points="443.026,-665.112 449.604,-656.806 439.282,-659.197 443.026,-665.112"/>
</g>
<!-- proc~test_emd_rk&#45;&gt;proc~emd_rk_solver -->
<g id="edge86" class="edge"><title>proc~test_emd_rk&#45;&gt;proc~emd_rk_solver</title>
<path fill="none" stroke="black" d="M245.016,-598.724C255.372,-595.459 266.013,-590.506 274,-583 304.792,-554.059 281.128,-525.856 310,-495 310.902,-494.036 311.856,-493.108 312.852,-492.217"/>
<polygon fill="black" stroke="black" points="315.199,-494.834 321.155,-486.072 311.035,-489.207 315.199,-494.834"/>
</g>
<!-- proc~test_ls_rk&#45;&gt;proc~save_results -->
<g id="edge94" class="edge"><title>proc~test_ls_rk&#45;&gt;proc~save_results</title>
<path fill="none" stroke="black" d="M238.217,-432.671C250.781,-435.668 264.689,-441.112 274,-451 315.687,-495.271 271.238,-536.146 310,-583 310.721,-583.871 311.484,-584.71 312.284,-585.519"/>
<polygon fill="black" stroke="black" points="310.327,-588.437 320.307,-591.992 314.722,-582.989 310.327,-588.437"/>
</g>
<!-- proc~test_ls_rk&#45;&gt;proc~init~8 -->
<g id="edge96" class="edge"><title>proc~test_ls_rk&#45;&gt;proc~init~8</title>
<path fill="none" stroke="black" d="M238.183,-432.322C250.897,-435.245 264.934,-440.728 274,-451 326.832,-510.862 277.252,-554.183 310,-627 316.384,-641.195 326.617,-655.214 335.713,-666.128"/>
<polygon fill="black" stroke="black" points="333.176,-668.545 342.364,-673.82 338.47,-663.967 333.176,-668.545"/>
</g>
<!-- proc~test_ls_rk&#45;&gt;str -->
<g id="edge100" class="edge"><title>proc~test_ls_rk&#45;&gt;str</title>
<path fill="none" stroke="black" d="M228.179,-415.862C242.757,-404.924 262.245,-388.094 274,-369 304.533,-319.404 263.503,-278.072 310,-243 341.934,-218.912 369.164,-217.522 400,-243 429.65,-267.499 464.367,-538.652 474.251,-620.649"/>
<polygon fill="black" stroke="black" points="470.792,-621.201 475.453,-630.715 477.742,-620.37 470.792,-621.201"/>
</g>
<!-- proc~test_ls_rk&#45;&gt;proc~ls_rk_solver -->
<g id="edge98" class="edge"><title>proc~test_ls_rk&#45;&gt;proc~ls_rk_solver</title>
<path fill="none" stroke="black" d="M228.779,-415.816C243.485,-404.969 262.858,-388.28 274,-369 310.254,-306.267 267.517,-268.694 310,-210 311.977,-207.269 314.322,-204.764 316.888,-202.476"/>
<polygon fill="black" stroke="black" points="319.242,-205.083 325.1,-196.255 315.016,-199.503 319.242,-205.083"/>
</g>
<!-- proc~exact_solution -->
<g id="node15" class="node"><title>proc~exact_solution</title>
<a xlink:href="../proc/exact_solution.html" xlink:title="exact_solution">
<polygon fill="#d94e8f" stroke="#d94e8f" points="517,-342 437,-342 437,-316 517,-316 517,-342"/>
<text text-anchor="middle" x="477" y="-326.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_solution</text>
</a>
</g>
<!-- proc~save_results&#45;&gt;proc~exact_solution -->
<g id="edge2" class="edge"><title>proc~save_results&#45;&gt;proc~exact_solution</title>
<path fill="none" stroke="black" d="M389.6,-591.914C393.472,-589.396 397.069,-586.443 400,-583 458.883,-513.826 472.74,-400.56 475.999,-352.135"/>
<polygon fill="black" stroke="black" points="479.499,-352.237 476.584,-342.051 472.51,-351.831 479.499,-352.237"/>
</g>
<!-- proc~init~8&#45;&gt;str -->
<g id="edge6" class="edge"><title>proc~init~8&#45;&gt;str</title>
<path fill="none" stroke="black" d="M382.076,-677.457C399.213,-671.417 421.589,-663.53 440.311,-656.931"/>
<polygon fill="black" stroke="black" points="441.732,-660.142 450,-653.516 439.405,-653.54 441.732,-660.142"/>
</g>
<!-- strz -->
<g id="node17" class="node"><title>strz</title>
<polygon fill="#777777" stroke="#777777" points="504,-701 450,-701 450,-675 504,-675 504,-701"/>
<text text-anchor="middle" x="477" y="-685.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">strz</text>
</g>
<!-- proc~init~8&#45;&gt;strz -->
<g id="edge4" class="edge"><title>proc~init~8&#45;&gt;strz</title>
<path fill="none" stroke="black" d="M382.076,-687.222C399.055,-687.361 421.177,-687.542 439.792,-687.695"/>
<polygon fill="black" stroke="black" points="439.972,-691.197 450,-687.779 440.029,-684.197 439.972,-691.197"/>
</g>
<!-- proc~compute_errors&#45;&gt;proc~exact_solution -->
<g id="edge40" class="edge"><title>proc~compute_errors&#45;&gt;proc~exact_solution</title>
<path fill="none" stroke="black" d="M389.586,-70.0982C393.46,-72.6147 397.061,-75.5631 400,-79 458.049,-146.888 472.352,-258.025 475.863,-305.886"/>
<polygon fill="black" stroke="black" points="472.371,-306.112 476.503,-315.868 479.356,-305.665 472.371,-306.112"/>
</g>
<!-- proc~print_analysis&#45;&gt;str -->
<g id="edge42" class="edge"><title>proc~print_analysis&#45;&gt;str</title>
<path fill="none" stroke="black" d="M385.212,-114.037C390.912,-117.774 396.253,-122.395 400,-128 407.005,-138.479 460.079,-521.109 473.78,-620.569"/>
<polygon fill="black" stroke="black" points="470.353,-621.339 475.184,-630.769 477.288,-620.385 470.353,-621.339"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>

    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cli"></span>type(Type_Command_Line_Interface)</td>
  
  
  <td></td><td>::</td>
  <td><strong>cli</strong></td><td></td><td></td><td><p>Command line interface handler.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-space_dimension"></span>integer,</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>space_dimension</strong></td><td> =</td><td>2</td><td><p>Space dimensions.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-initial_state%7E7"></span>real(kind=R_P),</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>initial_state</strong>(1:space_dimension)</td><td> =</td><td>[0._R_P,1._R_P]</td><td><p>Initial state.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f%7E6"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>f</strong></td><td></td><td></td><td><p>Oscillation frequency.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t_final"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>t_final</strong></td><td></td><td></td><td><p>Final time.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E14"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>Dt</strong></td><td></td><td></td><td><p>Time step.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tolerance%7E3"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>tolerance</strong></td><td></td><td></td><td><p>Tolerance on local truncation error.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-error%7E5"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>error</strong></td><td></td><td></td><td><p>Error handler.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-stages_steps"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>stages_steps</strong></td><td></td><td></td><td><p>Number of stages/steps used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-implicit_iterations"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>implicit_iterations</strong></td><td></td><td></td><td><p>Number of iterations for implicit solvers.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-solver%7E2"></span>character(len=99)</td>
  
  
  <td></td><td>::</td>
  <td><strong>solver</strong></td><td></td><td></td><td><p>Solver used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-plots"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>plots</strong></td><td></td><td></td><td><p>Flag for activating plots saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-results"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>results</strong></td><td></td><td></td><td><p>Flag for activating results saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-output_cli"></span>character(len=99)</td>
  
  
  <td></td><td>::</td>
  <td><strong>output_cli</strong></td><td></td><td></td><td><p>Output files basename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-errors_analysis"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>errors_analysis</strong></td><td></td><td></td><td><p>Flag for activating errors analysis.</p></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    
    
    

    
    
     
    <section>
    <h2>Functions</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-exact_solution"></span><h3>
function <a href='../proc/exact_solution.html'>exact_solution</a>(t) result(ex_sol)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t</strong></td><td><p>Time.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:space_dimension)</small></h4>
  <p>Exact solution.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Compute the exact solution.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-compute_errors"></span><h3>
function <a href='../proc/compute_errors.html'>compute_errors</a>(solution) result(error_L2)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:space_dimension)</small></h4>
  <p>L2 norm of the numerical error.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Compute the L2 norm of numerical error with respect the exact solution.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-estimate_orders"></span><h3>
function <a href='../proc/estimate_orders.html'>estimate_orders</a>(solver_error, Dt_used) result(order)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solver_error</strong>(1:space_dimension,1:2)</td><td><p>Computed errors.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dt_used</strong>(1:2)</td><td><p>Time steps used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:space_dimension)</small></h4>
  <p>Estimation of the order of accuracy.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Estimate the order of accuracy using 2 subsequent refined numerical solutions.</p>
        

  </div>
  </div>

    
    </section>
    <br>
    


    
    <section>
    <h2>Subroutines</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-init%7E8"></span><h3>
subroutine <a href='../proc/init%7E8.html'>init</a>(output, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=:),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>output</strong></td><td><p>Output files basename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>solution</strong>(:,:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Initialize solver local variable from global variables.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-save_results"></span><h3>
subroutine <a href='../proc/save_results.html'>save_results</a>(title, basename, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>title</strong></td><td><p>Plot title.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>basename</strong></td><td><p>Output files basename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Save plots of results.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_ab"></span><h3>
subroutine <a href='../proc/test_ab.html'>test_ab</a>(steps)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit Adams-Bashforth class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_abm"></span><h3>
subroutine <a href='../proc/test_abm.html'>test_abm</a>(steps)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test predictor-corrector Adams-Bashforth-Moulton class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_am"></span><h3>
subroutine <a href='../proc/test_am.html'>test_am</a>(steps)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test implicit Adams-Moulton class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_emd_rk"></span><h3>
subroutine <a href='../proc/test_emd_rk.html'>test_emd_rk</a>(stages)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit embedded Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_euler"></span><h3>
subroutine <a href='../proc/test_euler.html'>test_euler</a>()
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit forward Euler ODE solver.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_leapfrog"></span><h3>
subroutine <a href='../proc/test_leapfrog.html'>test_leapfrog</a>(raw)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>raw</strong></td><td><p>Activate RAW filter.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit leapfrog class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_ls_rk"></span><h3>
subroutine <a href='../proc/test_ls_rk.html'>test_ls_rk</a>(stages)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit low storage Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_tvd_rk"></span><h3>
subroutine <a href='../proc/test_tvd_rk.html'>test_tvd_rk</a>(stages)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit TVD/SSP Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-ab_solver"></span><h3>
subroutine <a href='../proc/ab_solver.html'>ab_solver</a>(steps, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit Adams-Bashforth class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-abm_solver"></span><h3>
subroutine <a href='../proc/abm_solver.html'>abm_solver</a>(steps, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all ABM solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with predictor-corrector Adams-Bashforth-Moulton class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-am_solver"></span><h3>
subroutine <a href='../proc/am_solver.html'>am_solver</a>(steps, iterations, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AM solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>iterations</strong></td><td><p>Number of fixed point iterations.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with implicit Adams-Moulton class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-emd_rk_solver"></span><h3>
subroutine <a href='../proc/emd_rk_solver.html'>emd_rk_solver</a>(stages, tol, solution, last_step)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>tol</strong></td><td><p>Tolerance on local truncation error.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>last_step</strong></td><td><p>Last time step number.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit embedded Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-euler_solver"></span><h3>
subroutine <a href='../proc/euler_solver.html'>euler_solver</a>(solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit forward Euler ODE solver.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-leapfrog_solver"></span><h3>
subroutine <a href='../proc/leapfrog_solver.html'>leapfrog_solver</a>(solution, raw)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>raw</strong></td><td><p>Activate RAW filter.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit leapfrog class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-ls_rk_solver"></span><h3>
subroutine <a href='../proc/ls_rk_solver.html'>ls_rk_solver</a>(stages, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit low storage Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-tvd_rk_solver"></span><h3>
subroutine <a href='../proc/tvd_rk_solver.html'>tvd_rk_solver</a>(stages, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit TVD/SSP Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-perform_errors_analysis"></span><h3>
subroutine <a href='../proc/perform_errors_analysis.html'>perform_errors_analysis</a>()
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Peform errors analysis.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-print_analysis"></span><h3>
subroutine <a href='../proc/print_analysis.html'>print_analysis</a>(solver, time_steps, errors, orders)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solver</strong></td><td><p>Solver name.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>time_steps</strong>(:)</td><td><p>Time steps exercised.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>errors</strong>(:,:,:)</td><td><p>Errors of the solver.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>orders</strong>(:,:,:)</td><td><p>Observed orders of the solver.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Print summary of the error analysis.</p>
        

  </div>
  </div>

    
    </section>    
    
    
    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span class="k">program </span><span class="n">integrate_oscillation</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c">!&lt; Test FOODIE with the integration of Oscillation equations.</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">use </span><span class="n">IR_Precision</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">R_P</span><span class="p">,</span> <span class="n">I_P</span><span class="p">,</span> <span class="n">FR_P</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">strz</span>
<span class="k">use </span><span class="n">type_oscillation</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">oscillation</span>
<span class="k">use </span><span class="n">Data_Type_Command_Line_Interface</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Type_Command_Line_Interface</span>
<span class="k">use </span><span class="n">foodie</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">adams_bashforth_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">adams_bashforth_moulton_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">adams_moulton_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">emd_runge_kutta_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">euler_explicit_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">leapfrog_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">ls_runge_kutta_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">tvd_runge_kutta_integrator</span>
<span class="k">use </span><span class="n">pyplot_module</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span>  <span class="n">pyplot</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">implicit none</span>
<span class="k">type</span><span class="p">(</span><span class="n">Type_Command_Line_Interface</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cli</span>                                               <span class="c">!&lt; Command line interface handler.</span>
<span class="kt">integer</span><span class="p">,</span>   <span class="k">parameter</span>              <span class="kd">::</span> <span class="n">space_dimension</span><span class="o">=</span><span class="mi">2</span>                                 <span class="c">!&lt; Space dimensions.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">parameter</span>              <span class="kd">::</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="mf">1._R_P</span><span class="p">]</span> <span class="c">!&lt; Initial state.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">f</span>                                                 <span class="c">!&lt; Oscillation frequency.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">t_final</span>                                           <span class="c">!&lt; Final time.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">Dt</span>                                                <span class="c">!&lt; Time step.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">tolerance</span>                                         <span class="c">!&lt; Tolerance on local truncation error.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">error</span>                                             <span class="c">!&lt; Error handler.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">stages_steps</span>                                      <span class="c">!&lt; Number of stages/steps used.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">implicit_iterations</span>                               <span class="c">!&lt; Number of iterations for implicit solvers.</span>
<span class="kt">character</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">solver</span>                                            <span class="c">!&lt; Solver used.</span>
<span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">plots</span>                                             <span class="c">!&lt; Flag for activating plots saving.</span>
<span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">results</span>                                           <span class="c">!&lt; Flag for activating results saving.</span>
<span class="kt">character</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">output_cli</span>                                        <span class="c">!&lt; Output files basename.</span>
<span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">errors_analysis</span>                                   <span class="c">!&lt; Flag for activating errors analysis.</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c">! setting Command Line Interface</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">progname</span>    <span class="o">=</span> <span class="s1">&#39;oscillation&#39;</span><span class="p">,</span>                                              <span class="p">&amp;</span>
              <span class="n">authors</span>     <span class="o">=</span> <span class="s1">&#39;Fortran-FOSS-Programmers&#39;</span><span class="p">,</span>                                 <span class="p">&amp;</span>
              <span class="n">license</span>     <span class="o">=</span> <span class="s1">&#39;GNU GPLv3&#39;</span><span class="p">,</span>                                                <span class="p">&amp;</span>
              <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Test FOODIE library on Oscillation equations integration&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">examples</span>    <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;oscillation --solver euler --results  &quot;</span><span class="p">,</span>                  <span class="p">&amp;</span>
                             <span class="s2">&quot;oscillation --solver ls-runge-kutta -r&quot;</span><span class="p">,</span>                  <span class="p">&amp;</span>
                             <span class="s2">&quot;oscillation --solver adams-bashforth  &quot;</span><span class="p">,</span>                  <span class="p">&amp;</span>
                             <span class="s2">&quot;oscillation --solver all --plots -r   &quot;</span><span class="p">])</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--solver&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;ODE solver used&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--ss&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Stages/steps used&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--iterations&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Number of iterations for implicit solvers&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;5&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--frequency&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Oscillation frequency&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;1e-4&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--time_step&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-Dt&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Integration time step&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;100.d0&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--tolerance&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-tol&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Tolerance on local error&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;0.001d0&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--t_final&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-tf&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Final integration time&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;1e6&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--results&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Save results&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--plots&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Save plots of results&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Output files basename&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;unset&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--errors_analysis&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Peform errors analysis&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">)</span>
<span class="c">! parsing Command Line Interface</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">parse</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--ss&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--iterations&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">implicit_iterations</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-Dt&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-tol&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-tf&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">t_final</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">plots</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">output_cli</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--errors_analysis&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">errors_analysis</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">if</span> <span class="p">(</span><span class="n">errors_analysis</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  call </span><span class="n">perform_errors_analysis</span>
<span class="k">else</span>
<span class="k">  select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">)))</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;adams-bashforth&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_ab</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;adams-bashforth-moulton&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_abm</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;adams-moulton&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_am</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;emd-runge-kutta&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_emd_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;euler&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_euler</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;leapfrog&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_leapfrog</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;leapfrog-raw&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_leapfrog</span><span class="p">(</span><span class="n">raw</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;ls-runge-kutta&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_ls_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;tvd-runge-kutta&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_tvd_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_ab</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_abm</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_am</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_emd_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_euler</span>
    <span class="k">call </span><span class="n">test_leapfrog</span>
    <span class="k">call </span><span class="n">test_ls_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_tvd_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case </span><span class="n">default</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Error: unknown solver &quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Valid solver names are:&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + adams-bashforth&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + adams-bashforth-moulton&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + adams-moulton&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + emd-runge-kutta&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + euler&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + leapfrog&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + leapfrog-raw&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + ls-runge-kutta&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + tvd-runge-kutta&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + all&#39;</span>
  <span class="n">endselect</span>
<span class="n">endif</span>
<span class="k">stop</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">contains</span>
<span class="k">  subroutine </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Initialize solver local variable from global variables.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">output</span>        <span class="c">!&lt; Output files basename.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>        <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span> <span class="c">!&lt; Solution at each time step.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">t_final</span><span class="p">,</span> <span class="n">Dt</span><span class="p">)</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Error: the final integration time must be an exact multiple of the time step used!&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Final integration time: &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">t_final</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Time step: &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">Dt</span><span class="p">)</span>
    <span class="k">stop</span>
<span class="k">  </span><span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">output_cli</span><span class="p">))</span><span class="o">/=</span><span class="s1">&#39;unset&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    if</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span><span class="o">/=</span><span class="s1">&#39;emd-runge-kutta&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      </span><span class="n">output</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">output_cli</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span><span class="o">//</span><span class="s1">&#39;-time_steps-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">output</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">output_cli</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">n</span><span class="o">=</span><span class="n">tolerance</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;-tolerance-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
    <span class="n">endif</span>
  <span class="k">else</span>
<span class="k">    if</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span><span class="o">/=</span><span class="s1">&#39;emd-runge-kutta&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      </span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;oscillation_integration-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span><span class="o">//</span><span class="s1">&#39;-time_steps-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
    <span class="k">else</span>
<span class="k">      </span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;oscillation_integration-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">n</span><span class="o">=</span><span class="n">tolerance</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;-tolerance-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
    <span class="n">endif</span>
  <span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">solution</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="p">;</span> <span class="k">allocate</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">init</span>

  <span class="k">function </span><span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ex_sol</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the exact solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">t</span>                         <span class="c">!&lt; Time.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span> <span class="c">!&lt; Exact solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
  <span class="n">ex_sol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">exact_solution</span>

  <span class="k">subroutine </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Save plots of results.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">title</span>                     <span class="c">!&lt; Plot title.</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">basename</span>                  <span class="c">!&lt; Output files basename.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>           <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">rawfile</span>                   <span class="c">!&lt; Raw file unit for saving results.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span> <span class="c">!&lt; Exact solution.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">pyplot</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">plt</span>                       <span class="c">!&lt; Plot file handler.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">i</span>                         <span class="c">!&lt; Counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">s</span>                         <span class="c">!&lt; Counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">rawfile</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">basename</span><span class="o">//</span><span class="s1">&#39;.dat&#39;</span><span class="p">)</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;TITLE=&quot;&#39;</span><span class="o">//</span><span class="n">title</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;VARIABLES=&quot;t&quot; &quot;x&quot; &quot;y&quot;&#39;</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;ZONE T=&quot;FOODIE time serie&quot;&#39;</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ubound</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(3(&#39;</span><span class="o">//</span><span class="n">FR_P</span><span class="o">//</span><span class="s1">&#39;,1X))&#39;</span><span class="p">)(</span><span class="n">solution</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">space_dimension</span><span class="p">)</span>
    <span class="n">enddo</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;ZONE T=&quot;Exact solution&quot;&#39;</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ubound</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">ex_sol</span> <span class="o">=</span> <span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(3(&#39;</span><span class="o">//</span><span class="n">FR_P</span><span class="o">//</span><span class="s1">&#39;,1X))&#39;</span><span class="p">)</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="p">(</span><span class="n">ex_sol</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_dimension</span><span class="p">)</span>
    <span class="n">enddo</span>
    <span class="k">close</span><span class="p">(</span><span class="n">rawfile</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">plots</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    call </span><span class="n">plt</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">:),</span> <span class="n">y</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">:),</span> <span class="n">y</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">savefig</span><span class="p">(</span><span class="n">basename</span><span class="o">//</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>

    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="o">//</span><span class="s1">&#39;-path&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">:),</span> <span class="n">y</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;path-&#39;</span><span class="o">//</span><span class="n">basename</span><span class="o">//</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">save_results</span>

  <span class="k">subroutine </span><span class="n">test_ab</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit Adams-Bashforth class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">steps</span>            <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">ab_steps</span><span class="o">=</span><span class="mi">4</span>       <span class="c">!&lt; Adams-Bashforth steps number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                <span class="c">!&lt; AB steps counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Steps used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>           <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>            <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of Adams-Bashforth class of solvers&#39;</span>
  <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">steps</span><span class="p">,</span> <span class="n">steps</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; AB-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit Adams-Bashforth, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">ab_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_ab</span>

  <span class="k">subroutine </span><span class="n">test_abm</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test predictor-corrector Adams-Bashforth-Moulton class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">steps</span>            <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">abm_steps</span><span class="o">=</span><span class="mi">4</span>      <span class="c">!&lt; Adams-Bashforth-Moulton steps number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                <span class="c">!&lt; ABM steps counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Steps used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>           <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>            <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth-moulton&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of Adams-Bashforth-Moulton class of solvers&#39;</span>
  <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">abm_steps</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">steps</span><span class="p">,</span> <span class="n">steps</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; ABM-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, predictor/corrector Adams-Bashforth-Moulton, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
            <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">abm_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_abm</span>

  <span class="k">subroutine </span><span class="n">test_am</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test implicit Adams-Moulton class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">steps</span>            <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">am_steps</span><span class="o">=</span><span class="mi">3</span>       <span class="c">!&lt; Adams-Moulton steps number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                <span class="c">!&lt; AM steps counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Steps used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>           <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>            <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-moulton&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of Adams-Moulton class of solvers&#39;</span>
  <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">am_steps</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">steps</span><span class="p">,</span> <span class="n">steps</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; AM-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, implicit Adams-Moulton, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
            <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">implicit_iterations</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      call </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">implicit_iterations</span><span class="p">)</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">endif</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_am</span>

  <span class="k">subroutine </span><span class="n">test_emd_rk</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit embedded Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">stages</span>            <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">7</span>       <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>     <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                 <span class="c">!&lt; RK stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Stages used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>            <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>             <span class="c">!&lt; Output files title.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">last_step</span>         <span class="c">!&lt; Last time step computed.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;emd-runge-kutta&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of embedded Runge-Kutta class of solvers&#39;</span>
  <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">stages</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">stages</span><span class="p">,</span> <span class="n">stages</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 5 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">6</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 6 stages not yet implemented</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; RK-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit embedded Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">emd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">last_step</span><span class="o">=</span><span class="n">last_step</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">(:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">last_step</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_emd_rk</span>

  <span class="k">subroutine </span><span class="n">test_euler</span><span class="p">()</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit forward Euler ODE solver.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span> <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>        <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>         <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;euler&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of explicit Euler solver&#39;</span>
  <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit Euler, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
  <span class="k">call </span><span class="n">euler_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_euler</span>

  <span class="k">subroutine </span><span class="n">test_leapfrog</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit leapfrog class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">logical</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">raw</span>           <span class="c">!&lt; Activate RAW filter.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span> <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>        <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>         <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;leapfrog&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of leapfrog (RAW filtered) class of solvers&#39;</span>
  <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, leapfrog (RAW filtered), t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
  <span class="k">call </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span><span class="p">)</span>
  <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_leapfrog</span>

  <span class="k">subroutine </span><span class="n">test_ls_rk</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit low storage Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">stages</span>            <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">14</span>      <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>     <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                 <span class="c">!&lt; RK stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Stages used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>            <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>             <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;ls-runge-kutta&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of low storage (2N) Runge-Kutta class of solvers&#39;</span>
  <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">stages</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">stages</span><span class="p">,</span> <span class="n">stages</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 8 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">9</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 9 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 10 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">11</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 11 stages not yet implemented</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; RK-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit low storage Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
      <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">ls_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_ls_rk</span>

  <span class="k">subroutine </span><span class="n">test_tvd_rk</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit TVD/SSP Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">stages</span>            <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>       <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>     <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                 <span class="c">!&lt; RK stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Stages used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>            <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>             <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;tvd-runge-kutta&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of TVD/SSP Runge-Kutta class of solvers&#39;</span>
  <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">stages</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">stages</span><span class="p">,</span> <span class="n">stages</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; RK-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit TVD/SSP Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">tvd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_tvd_rk</span>

  <span class="k">subroutine </span><span class="n">ab_solver</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit Adams-Bashforth class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">steps</span>                 <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>               <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">adams_bashforth_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_integrator</span>         <span class="c">!&lt; Adams-Bashforth integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">steps</span><span class="p">)</span>     <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                          <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">ab_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">endselect</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to s - 1 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">ab_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">-</span><span class="n">steps</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">ab_solver</span>

  <span class="k">subroutine </span><span class="n">abm_solver</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with predictor-corrector Adams-Bashforth-Moulton class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">steps</span>                 <span class="c">!&lt; Number of steps used: if negative all ABM solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>                       <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">adams_bashforth_moulton_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">abm_integrator</span>        <span class="c">!&lt; Adams-Bashforth-Moulton integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">steps</span><span class="p">)</span>     <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                                  <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">abm_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">endselect</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to s - 1 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">abm_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">-</span><span class="n">steps</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">abm_solver</span>

  <span class="k">subroutine </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with implicit Adams-Moulton class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span>           <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">steps</span>                 <span class="c">!&lt; Number of steps used: if negative all AM solvers are used.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iterations</span>            <span class="c">!&lt; Number of fixed point iterations.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>              <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>                  <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">adams_moulton_integrator</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">am_integrator</span>         <span class="c">!&lt; Adams-Moulton integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">steps</span><span class="p">)</span>     <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                             <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">am_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">steps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">endselect</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to s - 1 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">am_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">-</span><span class="n">steps</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">)</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">am_solver</span>

  <span class="k">subroutine </span><span class="n">emd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">solution</span><span class="p">,</span> <span class="n">last_step</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit embedded Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">stages</span>             <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">tol</span>                <span class="c">!&lt; Tolerance on local truncation error.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">last_step</span>          <span class="c">!&lt; Last time step number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">emd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>      <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>         <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">step</span>               <span class="c">!&lt; Time steps counter.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">Dt_a</span>               <span class="c">!&lt; Adaptive time step.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">Dt_a</span> <span class="o">=</span> <span class="mi">1000</span><span class="mf">0._R_P</span> <span class="c">! initial step very large to trigger adaptation</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt_a</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Dt_a</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="n">last_step</span> <span class="o">=</span> <span class="n">step</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">emd_rk_solver</span>

  <span class="k">subroutine </span><span class="n">euler_solver</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit forward Euler ODE solver.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>  <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">euler_explicit_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">euler_integrator</span> <span class="c">!&lt; Euler integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">oscillator</span>       <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">step</span>             <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">euler_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">euler_solver</span>

  <span class="k">subroutine </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit leapfrog class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>        <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">logical</span><span class="p">,</span> <span class="k">optional</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">raw</span>                   <span class="c">!&lt; Activate RAW filter.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>               <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">leapfrog_integrator</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">lf_integrator</span>         <span class="c">!&lt; Leapfrog integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>         <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">filter</span>                <span class="c">!&lt; Filter displacement.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                          <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="kt">logical</span>                          <span class="kd">::</span> <span class="n">filtered</span>              <span class="c">!&lt; Activate RAW filter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">filtered</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">raw</span><span class="p">))</span> <span class="n">filtered</span> <span class="o">=</span> <span class="n">raw</span>
  <span class="k">call </span><span class="n">lf_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">()</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">rk_stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">2</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to 2 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      if</span> <span class="p">(</span><span class="n">filtered</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">lf_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span> <span class="n">filter</span><span class="o">=</span><span class="n">filter</span><span class="p">)</span>
      <span class="k">else</span>
<span class="k">        call </span><span class="n">lf_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">endif</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">leapfrog_solver</span>

  <span class="k">subroutine </span><span class="n">ls_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit low storage Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">stages</span>                <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">ls_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>              <span class="kd">::</span> <span class="n">registers</span><span class="o">=</span><span class="mi">2</span>           <span class="c">!&lt; Runge-Kutta stages registers number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">registers</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta registers.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">ls_rk_solver</span>

  <span class="k">subroutine </span><span class="n">tvd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit TVD/SSP Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">stages</span>             <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>      <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>         <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">step</span>               <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">tvd_rk_solver</span>

  <span class="k">subroutine </span><span class="n">perform_errors_analysis</span><span class="p">()</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Peform errors analysis.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The analysis is based on the integration of the Oscillation equations with different, decreasing time steps in the range</span>
  <span class="c">!&lt; *[5000, 2500, 1250, 625, 320, 100]*. The error is estimated by the L2 norm of the difference between the exact (\(U_e\)) and</span>
  <span class="c">!&lt; the numerical (\(U_{\Delta t}\)) solutions for each time step:</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;\varepsilon (\Delta t) = || U_e - U_{\Delta t} ||_2 = \sqrt{ \sum_{s=1}^{N_s} { \left(U_e(t_0 + s * \Delta t) -</span>
  <span class="c">!&lt;U_{\Delta t}(t_0 + s * \Delta t) \right)^2 }}</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; Using two pairs of subsequent-decreasing time steps solution is possible to estimate the order of accuracy of the solver</span>
  <span class="c">!&lt; employed computing the \emph{observed order} of accuracy:</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;p = \frac{log10 \left( \frac{\varepsilon (\Delta t_1)}{\varepsilon (\Delta t_2)} \right)}</span>
  <span class="c">!&lt;{log10 \left( \frac{\Delta t_1}{\Delta t_2} \right)}</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt;where \(\frac{\Delta t_1}{\Delta t_2}&gt;1\).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">parameter</span>       <span class="kd">::</span> <span class="n">NDt</span><span class="o">=</span><span class="mi">6</span>                             <span class="c">!&lt; Number of time steps exercised.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">parameter</span>       <span class="kd">::</span> <span class="n">time_steps</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="mi">250</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="mi">125</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="mi">62</span><span class="mf">5._R_P</span><span class="p">,</span>  <span class="p">&amp;</span>
                                                      <span class="mi">32</span><span class="mf">0._R_P</span><span class="p">,</span>  <span class="p">&amp;</span>
                                                      <span class="mi">10</span><span class="mf">0._R_P</span><span class="p">]</span>      <span class="c">!&lt; Time steps exercised.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">parameter</span>       <span class="kd">::</span> <span class="n">tolerances</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01_R_P</span><span class="p">,</span>     <span class="p">&amp;</span>
                                                      <span class="mf">0.001_R_P</span><span class="p">,</span>    <span class="p">&amp;</span>
                                                      <span class="mf">0.0001_R_P</span><span class="p">,</span>   <span class="p">&amp;</span>
                                                      <span class="mf">0.00001_R_P</span><span class="p">,</span>  <span class="p">&amp;</span>
                                                      <span class="mf">0.000001_R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="mf">0.0000001_R_P</span><span class="p">]</span> <span class="c">!&lt; Tolerances for embedded RK solvers.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">ab_steps</span><span class="o">=</span><span class="mi">4</span>                        <span class="c">!&lt; Adams-Bashforth steps number.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">emd_rk_stages</span><span class="o">=</span><span class="mi">7</span>                   <span class="c">!&lt; Embedded Runge-Kutta stages number.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">tvd_rk_stages</span><span class="o">=</span><span class="mi">5</span>                   <span class="c">!&lt; TVD/SSP Runge-Kutta stages number.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">ls_rk_stages</span><span class="o">=</span><span class="mi">14</span>                   <span class="c">!&lt; Low storage Runge-Kutta stages number.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                                 <span class="c">!&lt; Steps/stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">d</span>                                 <span class="c">!&lt; Time steps-exercised counter.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>                            <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>                             <span class="c">!&lt; Output files title.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>                     <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">last_step</span>                         <span class="c">!&lt; Last time step computed.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">Dt_mean</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>                    <span class="c">!&lt; Mean time resolution for adaptive step methods.</span>
  <span class="c">! errors and orders</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>            <span class="c">!&lt; Adams-Bashforth errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">abm_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>           <span class="c">!&lt; Adams-Bashforth-Moulton errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">am_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>            <span class="c">!&lt; Adams-Moulton errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">emd_rk_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">emd_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>   <span class="c">!&lt; TVD/SSP Runge-Kutta errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lf_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>                   <span class="c">!&lt; Leapfrog errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ls_rk_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ls_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>     <span class="c">!&lt; Low storage Runge-Kutta errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tvd_rk_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">tvd_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>   <span class="c">!&lt; TVD/SSP Runge-Kutta errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>          <span class="c">!&lt; Adams-Bashforth orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">abm_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>         <span class="c">!&lt; Adams-Bashforth-Moulton orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">am_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>          <span class="c">!&lt; Adams-Moulton orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">emd_rk_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">emd_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">!&lt; Embedded Runge-Kutta orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lf_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                 <span class="c">!&lt; Leapfrog orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ls_rk_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ls_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>   <span class="c">!&lt; Low storage Runge-Kutta orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tvd_rk_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">tvd_rk_stages</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">!&lt; TVD/SSP Runge-Kutta orders.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">ab_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span>     <span class="p">;</span> <span class="n">ab_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">abm_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span>    <span class="p">;</span> <span class="n">abm_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">am_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span>     <span class="p">;</span> <span class="n">am_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">emd_rk_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span> <span class="p">;</span> <span class="n">emd_rk_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">lf_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span>     <span class="p">;</span> <span class="n">lf_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">ls_rk_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span>  <span class="p">;</span> <span class="n">ls_rk_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">tvd_rk_errors</span> <span class="o">=</span> <span class="mf">0._R_P</span> <span class="p">;</span> <span class="n">tvd_rk_orders</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">solution</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="p">;</span> <span class="k">allocate</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span>
  <span class="n">results</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">! activate results saving</span>
  <span class="c">! Analyze errors of Adams-Bashforth solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit Adams-Bashforth, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">ab_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">ab_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">ab_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">ab_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of Adams-Bashforth-Moulton solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth-moulton&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, predictor-corrector Adams-Bashforth-Moulton, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
              <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">abm_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">abm_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">abm_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">abm_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of Adams-Moulton solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-moulton&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ab_steps</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, implicit Adams-Moulton, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
              <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">implicit_iterations</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">implicit_iterations</span><span class="p">)</span>
      <span class="k">else</span>
<span class="k">        call </span><span class="n">am_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">endif</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">am_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ab_steps</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">am_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">am_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of embedded Runge-Kutta solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised tolerances</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">NDt</span><span class="p">)</span>
    <span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerances</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;emd-runge-kutta&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">emd_rk_stages</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 5 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">6</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 6 stages not yet implemented</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit embedded Runge-Kutta t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; stages=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">emd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tolerances</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">last_step</span><span class="o">=</span><span class="n">last_step</span><span class="p">)</span>
      <span class="n">Dt_mean</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">t_final</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">last_step</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">R_P</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">(:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">last_step</span><span class="p">))</span>
      <span class="n">emd_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">(:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">last_step</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">emd_rk_stages</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">5</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 5 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">6</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 6 stages not yet implemented</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">emd_rk_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">emd_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">Dt_mean</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of leapfrog solver</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;leapfrog&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, leapfrog (unfiltered), t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
    <span class="k">call </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">lf_errors</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;leapfrog&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, leapfrog (RAW filtered), t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
    <span class="k">call </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-raw&#39;</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">lf_errors</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">lf_orders</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">lf_errors</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">lf_orders</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">lf_errors</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of low storage Runge-Kutta solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;ls-runge-kutta&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls_rk_stages</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 8 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">9</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 9 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 10 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">11</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 11 stages not yet implemented</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit low storage Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
        <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">ls_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">ls_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls_rk_stages</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">8</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 8 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">9</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 9 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">10</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 10 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">11</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 11 stages not yet implemented</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">ls_rk_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">ls_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of TVD/SSP Runge-Kutta solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;tvd-runge-kutta&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tvd_rk_stages</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit TVD/SSP Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">tvd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">tvd_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tvd_rk_stages</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">tvd_rk_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">tvd_rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s2">&quot;Solver &amp; Time Step &amp; f*Dt &amp; Error X &amp; Error Y &amp; Observed Order of Accuracy X &amp; Observed Order of Accuracy Y&quot;</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adams-bashforth&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">ab_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">ab_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adams-bashforth-moulton&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">abm_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">abm_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adams-moulton&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">am_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">am_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;emd-runge-kutta&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">Dt_mean</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">emd_rk_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">emd_rk_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;leapfrog&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">lf_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">lf_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;ls-runge-kutta&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">ls_rk_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">ls_rk_orders</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;tvd-runge-kutta&#39;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">tvd_rk_errors</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="n">tvd_rk_orders</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">perform_errors_analysis</span>

  <span class="k">function </span><span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">error_L2</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the L2 norm of numerical error with respect the exact solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>             <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">error_L2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span> <span class="c">!&lt; L2 norm of the numerical error.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span>   <span class="c">!&lt; Exact solution.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">s</span>                           <span class="c">!&lt; Steps/stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">v</span>                           <span class="c">!&lt; Variables counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">error_L2</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ubound</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ex_sol</span> <span class="o">=</span> <span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">do </span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_dimension</span>
      <span class="n">error_L2</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">error_L2</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="n">ex_sol</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="n">error_L2</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">error_L2</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">compute_errors</span>

  <span class="k">function </span><span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="p">,</span> <span class="n">Dt_used</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Estimate the order of accuracy using 2 subsequent refined numerical solutions.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solver_error</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Computed errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Dt_used</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>                         <span class="c">!&lt; Time steps used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">order</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span>             <span class="c">!&lt; Estimation of the order of accuracy.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">v</span>                                    <span class="c">!&lt; Variables counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">do </span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_dimension</span>
    <span class="n">order</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">log</span><span class="p">(</span><span class="n">solver_error</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">solver_error</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="nb">log</span><span class="p">(</span><span class="n">Dt_used</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">Dt_used</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">estimate_orders</span>

  <span class="k">subroutine </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">orders</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Print summary of the error analysis.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solver</span>        <span class="c">!&lt; Solver name.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">time_steps</span><span class="p">(:)</span> <span class="c">!&lt; Time steps exercised.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">errors</span><span class="p">(:,:,:)</span> <span class="c">!&lt; Errors of the solver.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">orders</span><span class="p">(:,:,:)</span> <span class="c">!&lt; Observed orders of the solver.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">s</span>             <span class="c">!&lt; Solver index.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">d</span>             <span class="c">!&lt; Time steps-exercised counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="n">solver</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A)&quot;</span><span class="p">,</span> <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                 <span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; / &amp; /&quot;</span>
      <span class="k">else</span>
<span class="k">        print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A,F9.2,A,F9.2)&quot;</span><span class="p">,</span> <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                             <span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                             <span class="n">orders</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">orders</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">endif</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">print_analysis</span>
<span class="n">endprogram</span> <span class="n">integrate_oscillation</span>
</pre></div>

    </section>
    
    
    </div>
  </div>

    <hr>
    <footer>
        <div class="row">
        <div class="col-md-6">&copy; 2015 FOODIE was written by Fortran-FOSS-Programmers Group. </div>
        <div class="col-md-6"><span class="pull-right">Documentation generated by <a href="https://github.com/cmacmackin/ford">FORD</a>.</span></div>
        </div>
        <br>
    </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>