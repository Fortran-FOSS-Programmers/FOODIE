<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Fortran Object oriented Ordinary Differential Equations integration library">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>integrate_oscillation &ndash; FOODiE</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FOODiE </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
                
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
				
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>integrate_oscillation 
    <small>Program</small>
    
    </h1>
	 
<div class="row">
<div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
    <li><i class="fa fa-code"></i><a href="../src/oscillation.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/oscillation.f90.html'>oscillation.f90</a></li>
  
     <li class="active">integrate_oscillation</li>
  </ol>
</div>
</div>
</div>
    
  </div>
  
  <div class="row">
    <div class="col-lg-3">
    
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Variables</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-cli%7E5">cli</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-space_dimension%7E2">space_dimension</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-initial_state%7E10">initial_state</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-f%7E5">f</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-t_final%7E4">t_final</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-dt%7E8">Dt</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-error%7E5">error</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-stages_steps%7E2">stages_steps</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-solver%7E4">solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-plots%7E5">plots</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-results%7E5">results</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-output_cli%7E2">output_cli</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#variable-errors_analysis">errors_analysis</a>
      
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Functions</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-exact_solution">exact_solution</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-compute_errors">compute_errors</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-estimate_orders">estimate_orders</a>
      
    </div>
  </div>
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Subroutines</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-init%7E12">init</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-save_results%7E5">save_results</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_ab%7E4">test_ab</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_euler%7E4">test_euler</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_leapfrog%7E4">test_leapfrog</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_ls_rk%7E4">test_ls_rk</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-test_tvd_rk%7E4">test_tvd_rk</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-ab_solver">ab_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-euler_solver">euler_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-leapfrog_solver">leapfrog_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-ls_rk_solver">ls_rk_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-tvd_rk_solver">tvd_rk_solver</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-perform_errors_analysis">perform_errors_analysis</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html#proc-print_analysis">print_analysis</a>
      
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
    <div class="list-group">
      <a class="list-group-item" href="../program/integrate_oscillation.html#src">integrate_oscillation</a>
    </div>
  </div>
  
  <hr>
  
  <div class="panel panel-default">
    <div class="panel-heading text-left"><h3 class="panel-title">All Programs</h3></div>
    <div class="list-group">
      
      <a class="list-group-item" href="../program/integrate_burgers.html">integrate_burgers</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d.html">integrate_euler_1D</a>
      
      <a class="list-group-item" href="../program/integrate_euler_1d_openmp.html">integrate_euler_1D_openmp</a>
      
      <a class="list-group-item" href="../program/integrate_lorenz.html">integrate_lorenz</a>
      
      <a class="list-group-item" href="../program/integrate_oscillation.html">integrate_oscillation</a>
      
    </div>
  </div>
  
  
    </div>
    
    <div class="col-lg-9" id='text'>
    
  
    <ul class="list-inline">
      <li><h4>Uses:</h4></li>
      
      <li>IR_Precision</li>
      
      <li><a href='../module/type_oscillation.html'>type_oscillation</a></li>
      
      <li>Data_Type_Command_Line_Interface</li>
      
      <li><a href='../module/foodie.html'>foodie</a></li>
      
      <li>pyplot_module</li>
      
    </ul>
  

    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: program~~integrate_oscillation~~UsesGraph Pages: 1 -->
<svg id="programintegrate_oscillationUsesGraph" width="641pt" height="194pt"
 viewBox="0.00 0.00 641.00 194.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~integrate_oscillation~~UsesGraph" class="graph" transform="scale(0.679025 0.679025) rotate(0) translate(4 282)">
<title>program~~integrate_oscillation~~UsesGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-282 941,-282 941,5 -4,5"/>
<!-- program~integrate_oscillation -->
<g id="node1" class="node"><title>program~integrate_oscillation</title>
<polygon fill="none" stroke="black" points="935,-108 829,-108 829,-82 935,-82 935,-108"/>
<text text-anchor="middle" x="882" y="-92.55" font-family="Helvetica,sans-Serif" font-size="10.50">integrate_oscillation</text>
</g>
<!-- module~foodie -->
<g id="node2" class="node"><title>module~foodie</title>
<a xlink:href="../module/foodie.html" xlink:title="foodie">
<polygon fill="#337ab7" stroke="#337ab7" points="550,-172 496,-172 496,-146 550,-146 550,-172"/>
<text text-anchor="middle" x="523" y="-156.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie</text>
</a>
</g>
<!-- module~foodie&#45;&gt;program~integrate_oscillation -->
<g id="edge40" class="edge"><title>module~foodie&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M550.213,-164.762C599.775,-174.057 707.447,-188.68 792,-161 819.377,-152.038 845.31,-131.225 862.243,-115.349"/>
<polygon fill="black" stroke="black" points="865.054,-117.499 869.799,-108.026 860.182,-112.472 865.054,-117.499"/>
</g>
<!-- module~type_oscillation -->
<g id="node3" class="node"><title>module~type_oscillation</title>
<a xlink:href="../module/type_oscillation.html" xlink:title="type_oscillation">
<polygon fill="#337ab7" stroke="#337ab7" points="736,-152 652,-152 652,-126 736,-126 736,-152"/>
<text text-anchor="middle" x="694" y="-136.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">type_oscillation</text>
</a>
</g>
<!-- module~foodie&#45;&gt;module~type_oscillation -->
<g id="edge38" class="edge"><title>module~foodie&#45;&gt;module~type_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M550.095,-155.831C574.548,-152.971 611.208,-148.683 641.406,-145.151"/>
<polygon fill="black" stroke="black" points="641.847,-148.624 651.372,-143.986 641.033,-141.671 641.847,-148.624"/>
</g>
<!-- module~type_oscillation&#45;&gt;program~integrate_oscillation -->
<g id="edge42" class="edge"><title>module~type_oscillation&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M736.973,-129.537C754.109,-125.716 774.004,-121.219 792,-117 800.855,-114.924 810.19,-112.692 819.36,-110.473"/>
<polygon fill="black" stroke="black" points="820.324,-113.841 829.215,-108.08 818.672,-107.039 820.324,-113.841"/>
</g>
<!-- pyplot_module -->
<g id="node4" class="node"><title>pyplot_module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="735,-108 653,-108 653,-82 735,-82 735,-108"/>
<text text-anchor="middle" x="694" y="-92.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pyplot_module</text>
</g>
<!-- pyplot_module&#45;&gt;program~integrate_oscillation -->
<g id="edge44" class="edge"><title>pyplot_module&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M735.257,-95C759.506,-95 790.677,-95 818.05,-95"/>
<polygon fill="black" stroke="black" points="818.332,-98.5001 828.332,-95 818.332,-91.5001 818.332,-98.5001"/>
</g>
<!-- IR_Precision -->
<g id="node5" class="node"><title>IR_Precision</title>
<polygon fill="#337ab7" stroke="#337ab7" points="559,-108 487,-108 487,-82 559,-82 559,-108"/>
<text text-anchor="middle" x="523" y="-92.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">IR_Precision</text>
</g>
<!-- IR_Precision&#45;&gt;program~integrate_oscillation -->
<g id="edge46" class="edge"><title>IR_Precision&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M558.913,-81.9002C570.579,-78.2627 583.691,-74.8145 596,-73 682.18,-60.2962 705.514,-62.5828 792,-73 803.61,-74.3985 815.885,-76.777 827.51,-79.4661"/>
<polygon fill="black" stroke="black" points="826.983,-82.9396 837.526,-81.8925 828.631,-76.1364 826.983,-82.9396"/>
</g>
<!-- IR_Precision&#45;&gt;module~type_oscillation -->
<g id="edge36" class="edge"><title>IR_Precision&#45;&gt;module~type_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M559.617,-106.597C571.204,-110.116 584.094,-113.874 596,-117 610.663,-120.85 626.668,-124.622 641.414,-127.926"/>
<polygon fill="black" stroke="black" points="640.87,-131.39 651.39,-130.133 642.382,-124.555 640.87,-131.39"/>
</g>
<!-- Data_Type_Command_Line_Interface -->
<g id="node6" class="node"><title>Data_Type_Command_Line_Interface</title>
<polygon fill="#337ab7" stroke="#337ab7" points="791,-26 597,-26 597,-1.24345e-14 791,-3.55271e-15 791,-26"/>
<text text-anchor="middle" x="694" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Data_Type_Command_Line_Interface</text>
</g>
<!-- Data_Type_Command_Line_Interface&#45;&gt;program~integrate_oscillation -->
<g id="edge48" class="edge"><title>Data_Type_Command_Line_Interface&#45;&gt;program~integrate_oscillation</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M751.672,-26.0003C765.156,-29.8266 779.287,-34.4944 792,-40 814.466,-49.7294 838.013,-64.2973 855.384,-75.9963"/>
<polygon fill="black" stroke="black" points="853.64,-79.0442 863.867,-81.8118 857.599,-73.2706 853.64,-79.0442"/>
</g>
<!-- module~foodie_integrator_euler_explicit -->
<g id="node7" class="node"><title>module~foodie_integrator_euler_explicit</title>
<a xlink:href="../module/foodie_integrator_euler_explicit.html" xlink:title="foodie_integrator_euler_explicit">
<polygon fill="#337ab7" stroke="#337ab7" points="421,-278 259,-278 259,-252 421,-252 421,-278"/>
<text text-anchor="middle" x="340" y="-262.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_euler_explicit</text>
</a>
</g>
<!-- module~foodie_integrator_euler_explicit&#45;&gt;module~foodie -->
<g id="edge24" class="edge"><title>module~foodie_integrator_euler_explicit&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M421.26,-255.134C431.319,-252.092 441.159,-248.137 450,-243 475.959,-227.917 497.3,-200.195 510.065,-180.735"/>
<polygon fill="black" stroke="black" points="513.08,-182.516 515.469,-172.195 507.165,-178.774 513.08,-182.516"/>
</g>
<!-- module~type_integrand -->
<g id="node8" class="node"><title>module~type_integrand</title>
<a xlink:href="../module/type_integrand.html" xlink:title="type_integrand">
<polygon fill="#337ab7" stroke="#337ab7" points="194,-172 110,-172 110,-146 194,-146 194,-172"/>
<text text-anchor="middle" x="152" y="-156.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">type_integrand</text>
</a>
</g>
<!-- module~type_integrand&#45;&gt;module~foodie -->
<g id="edge26" class="edge"><title>module~type_integrand&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M194.096,-160.277C205.726,-160.576 218.351,-160.851 230,-161 327.77,-162.253 352.231,-162.339 450,-161 461.647,-160.84 474.337,-160.538 485.82,-160.215"/>
<polygon fill="black" stroke="black" points="486.07,-163.71 495.963,-159.917 485.864,-156.713 486.07,-163.71"/>
</g>
<!-- module~type_integrand&#45;&gt;module~foodie_integrator_euler_explicit -->
<g id="edge2" class="edge"><title>module~type_integrand&#45;&gt;module~foodie_integrator_euler_explicit</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M160.275,-172.191C172.874,-191.09 198.735,-225.516 230,-243 235.996,-246.353 242.428,-249.2 249.062,-251.616"/>
<polygon fill="black" stroke="black" points="248.305,-255.052 258.898,-254.857 250.496,-248.403 248.305,-255.052"/>
</g>
<!-- module~foodie_integrator_leapfrog -->
<g id="node9" class="node"><title>module~foodie_integrator_leapfrog</title>
<a xlink:href="../module/foodie_integrator_leapfrog.html" xlink:title="foodie_integrator_leapfrog">
<polygon fill="#337ab7" stroke="#337ab7" points="409,-234 271,-234 271,-208 409,-208 409,-234"/>
<text text-anchor="middle" x="340" y="-218.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_leapfrog</text>
</a>
</g>
<!-- module~type_integrand&#45;&gt;module~foodie_integrator_leapfrog -->
<g id="edge8" class="edge"><title>module~type_integrand&#45;&gt;module~foodie_integrator_leapfrog</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177.878,-172.035C192.839,-179.208 212.175,-187.87 230,-194 242.299,-198.23 255.585,-202.076 268.528,-205.455"/>
<polygon fill="black" stroke="black" points="267.782,-208.877 278.336,-207.946 269.506,-202.092 267.782,-208.877"/>
</g>
<!-- module~foodie_integrator_low_storage_runge_kutta -->
<g id="node10" class="node"><title>module~foodie_integrator_low_storage_runge_kutta</title>
<a xlink:href="../module/foodie_integrator_low_storage_runge_kutta.html" xlink:title="foodie_integrator_low_storage_runge_kutta">
<polygon fill="#337ab7" stroke="#337ab7" points="450,-152 230,-152 230,-126 450,-126 450,-152"/>
<text text-anchor="middle" x="340" y="-136.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_low_storage_runge_kutta</text>
</a>
</g>
<!-- module~type_integrand&#45;&gt;module~foodie_integrator_low_storage_runge_kutta -->
<g id="edge12" class="edge"><title>module~type_integrand&#45;&gt;module~foodie_integrator_low_storage_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M194.191,-154.512C202.057,-153.675 210.626,-152.763 219.541,-151.815"/>
<polygon fill="black" stroke="black" points="220.161,-155.269 229.735,-150.73 219.421,-148.308 220.161,-155.269"/>
</g>
<!-- module~foodie_integrator_tvd_runge_kutta -->
<g id="node11" class="node"><title>module~foodie_integrator_tvd_runge_kutta</title>
<a xlink:href="../module/foodie_integrator_tvd_runge_kutta.html" xlink:title="foodie_integrator_tvd_runge_kutta">
<polygon fill="#337ab7" stroke="#337ab7" points="428,-108 252,-108 252,-82 428,-82 428,-108"/>
<text text-anchor="middle" x="340" y="-92.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_tvd_runge_kutta</text>
</a>
</g>
<!-- module~type_integrand&#45;&gt;module~foodie_integrator_tvd_runge_kutta -->
<g id="edge16" class="edge"><title>module~type_integrand&#45;&gt;module~foodie_integrator_tvd_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M172.403,-145.834C187.701,-136.513 209.452,-124.4 230,-117 236.463,-114.672 243.234,-112.569 250.104,-110.671"/>
<polygon fill="black" stroke="black" points="251.423,-113.944 260.218,-108.036 249.658,-107.17 251.423,-113.944"/>
</g>
<!-- module~foodie_integrator_adams_bashforth -->
<g id="node12" class="node"><title>module~foodie_integrator_adams_bashforth</title>
<a xlink:href="../module/foodie_integrator_adams_bashforth.html" xlink:title="foodie_integrator_adams_bashforth">
<polygon fill="#337ab7" stroke="#337ab7" points="431,-64 249,-64 249,-38 431,-38 431,-64"/>
<text text-anchor="middle" x="340" y="-48.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_integrator_adams_bashforth</text>
</a>
</g>
<!-- module~type_integrand&#45;&gt;module~foodie_integrator_adams_bashforth -->
<g id="edge20" class="edge"><title>module~type_integrand&#45;&gt;module~foodie_integrator_adams_bashforth</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M175.593,-145.81C181.997,-141.581 188.636,-136.541 194,-131 215.102,-109.201 205.069,-90.2897 230,-73 232.929,-70.9685 236.002,-69.115 239.183,-67.4244"/>
<polygon fill="black" stroke="black" points="240.85,-70.5082 248.404,-63.0792 237.866,-64.1761 240.85,-70.5082"/>
</g>
<!-- module~foodie_integrator_leapfrog&#45;&gt;module~foodie -->
<g id="edge28" class="edge"><title>module~foodie_integrator_leapfrog&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M402.621,-207.999C418.282,-204.103 434.912,-199.403 450,-194 463.391,-189.204 477.603,-182.731 489.894,-176.655"/>
<polygon fill="black" stroke="black" points="491.525,-179.753 498.874,-172.121 488.369,-173.504 491.525,-179.753"/>
</g>
<!-- module~foodie_integrator_low_storage_runge_kutta&#45;&gt;module~foodie -->
<g id="edge30" class="edge"><title>module~foodie_integrator_low_storage_runge_kutta&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M450.148,-151.038C462.865,-152.428 475.08,-153.763 485.754,-154.929"/>
<polygon fill="black" stroke="black" points="485.554,-158.428 495.875,-156.035 486.314,-151.47 485.554,-158.428"/>
</g>
<!-- module~foodie_integrator_tvd_runge_kutta&#45;&gt;module~foodie -->
<g id="edge32" class="edge"><title>module~foodie_integrator_tvd_runge_kutta&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420.758,-108.002C430.745,-110.527 440.703,-113.503 450,-117 465.901,-122.98 482.405,-132.184 495.69,-140.453"/>
<polygon fill="black" stroke="black" points="494.016,-143.537 504.326,-145.977 497.788,-137.64 494.016,-143.537"/>
</g>
<!-- module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie -->
<g id="edge34" class="edge"><title>module~foodie_integrator_adams_bashforth&#45;&gt;module~foodie</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M431.332,-64.0273C437.857,-66.5255 444.158,-69.4882 450,-73 471.656,-86.0173 469.646,-97.7394 486,-117 491.967,-124.028 498.593,-131.615 504.571,-138.382"/>
<polygon fill="black" stroke="black" points="501.956,-140.709 511.211,-145.866 507.192,-136.063 501.956,-140.709"/>
</g>
<!-- module~foodie_kinds -->
<g id="node13" class="node"><title>module~foodie_kinds</title>
<a xlink:href="../module/foodie_kinds.html" xlink:title="foodie_kinds">
<polygon fill="#337ab7" stroke="#337ab7" points="73,-172 1,-172 1,-146 73,-146 73,-172"/>
<text text-anchor="middle" x="37" y="-156.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">foodie_kinds</text>
</a>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_euler_explicit -->
<g id="edge4" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_euler_explicit</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152,-243C182.727,-253.027 217.594,-258.597 248.884,-261.654"/>
<polygon fill="black" stroke="black" points="248.633,-265.145 258.908,-262.561 249.264,-258.174 248.633,-265.145"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~type_integrand -->
<g id="edge6" class="edge"><title>module~foodie_kinds&#45;&gt;module~type_integrand</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M73.7029,-159C81.9237,-159 90.8,-159 99.521,-159"/>
<polygon fill="black" stroke="black" points="99.6389,-162.5 109.639,-159 99.6388,-155.5 99.6389,-162.5"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_leapfrog -->
<g id="edge10" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_leapfrog</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M49.2276,-172.172C68.704,-192.071 108.987,-228.964 152,-243"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152,-243C172.94,-249.833 223.503,-243.477 266.922,-235.871"/>
<polygon fill="black" stroke="black" points="267.696,-239.288 276.92,-234.077 266.459,-232.398 267.696,-239.288"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_low_storage_runge_kutta -->
<g id="edge14" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_low_storage_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152,-117C172.423,-112.146 219.284,-117.616 261.108,-124.315"/>
<polygon fill="black" stroke="black" points="260.62,-127.781 271.054,-125.945 261.752,-120.873 260.62,-127.781"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_tvd_runge_kutta -->
<g id="edge18" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_tvd_runge_kutta</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152,-117C180.599,-110.203 212.166,-105.47 241.135,-102.189"/>
<polygon fill="black" stroke="black" points="241.701,-105.648 251.264,-101.087 240.945,-98.6887 241.701,-105.648"/>
</g>
<!-- module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth -->
<g id="edge22" class="edge"><title>module~foodie_kinds&#45;&gt;module~foodie_integrator_adams_bashforth</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M66.6758,-145.981C89.5575,-136.481 122.222,-124.077 152,-117"/>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152,-117C190.723,-107.797 192.687,-86.8535 230,-73 236.317,-70.6545 242.937,-68.5411 249.661,-66.64"/>
<polygon fill="black" stroke="black" points="250.801,-69.9584 259.564,-64.0041 249.001,-63.1939 250.801,-69.9584"/>
</g>
</g>
</svg>
</div>
                <script>var panprogramintegrate_oscillationUsesGraph = svgPanZoom('#programintegrate_oscillationUsesGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
    <br><br>
    <p>Test FOODiE with the integration of Oscillation equations.</p>
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: program~~integrate_oscillation~~CallsGraph Pages: 1 -->
<svg id="programintegrate_oscillationCallsGraph" width="526pt" height="658pt"
 viewBox="0.00 0.00 526.00 658.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~integrate_oscillation~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 654)">
<title>program~~integrate_oscillation~~CallsGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-654 523,-654 523,5 -4,5"/>
<!-- program~integrate_oscillation -->
<g id="node1" class="node"><title>program~integrate_oscillation</title>
<polygon fill="none" stroke="black" points="107,-432 1,-432 1,-406 107,-406 107,-432"/>
<text text-anchor="middle" x="54" y="-416.55" font-family="Helvetica,sans-Serif" font-size="10.50">integrate_oscillation</text>
</g>
<!-- proc~test_tvd_rk~4 -->
<g id="node2" class="node"><title>proc~test_tvd_rk~4</title>
<a xlink:href="../proc/test_tvd_rk%7E4.html" xlink:title="test_tvd_rk">
<polygon fill="#d9534f" stroke="#d9534f" points="241,-498 177,-498 177,-472 241,-472 241,-498"/>
<text text-anchor="middle" x="209" y="-482.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_tvd_rk</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_tvd_rk~4 -->
<g id="edge72" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_tvd_rk~4</title>
<path fill="none" stroke="black" d="M78.4398,-432.008C96.324,-441.265 121.323,-453.664 144,-463 151.281,-465.998 159.135,-468.914 166.781,-471.591"/>
<polygon fill="black" stroke="black" points="165.701,-474.92 176.296,-474.842 167.965,-468.296 165.701,-474.92"/>
</g>
<!-- proc~test_ab~4 -->
<g id="node3" class="node"><title>proc~test_ab~4</title>
<a xlink:href="../proc/test_ab%7E4.html" xlink:title="test_ab">
<polygon fill="#d9534f" stroke="#d9534f" points="236,-454 182,-454 182,-428 236,-428 236,-454"/>
<text text-anchor="middle" x="209" y="-438.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_ab</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_ab~4 -->
<g id="edge74" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_ab~4</title>
<path fill="none" stroke="black" d="M107.776,-426.633C128.876,-429.628 152.572,-432.991 171.73,-435.71"/>
<polygon fill="black" stroke="black" points="171.468,-439.208 181.861,-437.148 172.452,-432.277 171.468,-439.208"/>
</g>
<!-- proc~test_euler~4 -->
<g id="node4" class="node"><title>proc~test_euler~4</title>
<a xlink:href="../proc/test_euler%7E4.html" xlink:title="test_euler">
<polygon fill="#d9534f" stroke="#d9534f" points="239,-542 179,-542 179,-516 239,-516 239,-542"/>
<text text-anchor="middle" x="209" y="-526.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_euler</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_euler~4 -->
<g id="edge76" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_euler~4</title>
<path fill="none" stroke="black" d="M64.2215,-432.224C79.5976,-451.281 110.471,-486.431 144,-507 151.747,-511.753 160.649,-515.626 169.33,-518.723"/>
<polygon fill="black" stroke="black" points="168.371,-522.092 178.964,-521.894 170.56,-515.443 168.371,-522.092"/>
</g>
<!-- proc~test_ls_rk~4 -->
<g id="node5" class="node"><title>proc~test_ls_rk~4</title>
<a xlink:href="../proc/test_ls_rk%7E4.html" xlink:title="test_ls_rk">
<polygon fill="#d9534f" stroke="#d9534f" points="238,-410 180,-410 180,-384 238,-384 238,-410"/>
<text text-anchor="middle" x="209" y="-394.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_ls_rk</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_ls_rk~4 -->
<g id="edge78" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_ls_rk~4</title>
<path fill="none" stroke="black" d="M107.776,-411.367C128.138,-408.477 150.918,-405.244 169.704,-402.577"/>
<polygon fill="black" stroke="black" points="170.28,-406.031 179.689,-401.16 169.296,-399.1 170.28,-406.031"/>
</g>
<!-- proc~perform_errors_analysis -->
<g id="node6" class="node"><title>proc~perform_errors_analysis</title>
<a xlink:href="../proc/perform_errors_analysis.html" xlink:title="perform_errors_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="273,-240 145,-240 145,-214 273,-214 273,-240"/>
<text text-anchor="middle" x="209" y="-224.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">perform_errors_analysis</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~perform_errors_analysis -->
<g id="edge80" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~perform_errors_analysis</title>
<path fill="none" stroke="black" d="M64.6538,-405.803C91.0979,-373.046 159.915,-287.802 192.031,-248.02"/>
<polygon fill="black" stroke="black" points="194.918,-250.015 198.477,-240.035 189.472,-245.618 194.918,-250.015"/>
</g>
<!-- proc~test_leapfrog~4 -->
<g id="node7" class="node"><title>proc~test_leapfrog~4</title>
<a xlink:href="../proc/test_leapfrog%7E4.html" xlink:title="test_leapfrog">
<polygon fill="#d9534f" stroke="#d9534f" points="246,-366 172,-366 172,-340 246,-340 246,-366"/>
<text text-anchor="middle" x="209" y="-350.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">test_leapfrog</text>
</a>
</g>
<!-- program~integrate_oscillation&#45;&gt;proc~test_leapfrog~4 -->
<g id="edge82" class="edge"><title>program~integrate_oscillation&#45;&gt;proc~test_leapfrog~4</title>
<path fill="none" stroke="black" d="M78.4398,-405.992C96.324,-396.735 121.323,-384.336 144,-375 149.575,-372.705 155.487,-370.457 161.383,-368.328"/>
<polygon fill="black" stroke="black" points="162.956,-371.486 171.231,-364.869 160.636,-364.881 162.956,-371.486"/>
</g>
<!-- proc~tvd_rk_solver -->
<g id="node8" class="node"><title>proc~tvd_rk_solver</title>
<a xlink:href="../proc/tvd_rk_solver.html" xlink:title="tvd_rk_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="393,-366 317,-366 317,-340 393,-340 393,-366"/>
<text text-anchor="middle" x="355" y="-350.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tvd_rk_solver</text>
</a>
</g>
<!-- proc~test_tvd_rk~4&#45;&gt;proc~tvd_rk_solver -->
<g id="edge8" class="edge"><title>proc~test_tvd_rk~4&#45;&gt;proc~tvd_rk_solver</title>
<path fill="none" stroke="black" d="M241.653,-479.73C253.028,-476.505 265.145,-471.322 274,-463 304.792,-434.059 281.128,-405.856 310,-375 310.902,-374.036 311.856,-373.108 312.852,-372.217"/>
<polygon fill="black" stroke="black" points="315.199,-374.834 321.155,-366.072 311.035,-369.207 315.199,-374.834"/>
</g>
<!-- proc~save_results~5 -->
<g id="node9" class="node"><title>proc~save_results~5</title>
<a xlink:href="../proc/save_results%7E5.html" xlink:title="save_results">
<polygon fill="#d9534f" stroke="#d9534f" points="391,-410 319,-410 319,-384 391,-384 391,-410"/>
<text text-anchor="middle" x="355" y="-394.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">save_results</text>
</a>
</g>
<!-- proc~test_tvd_rk~4&#45;&gt;proc~save_results~5 -->
<g id="edge10" class="edge"><title>proc~test_tvd_rk~4&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M241.704,-476.446C252.348,-473.011 263.991,-468.534 274,-463 296.576,-450.519 319.066,-431.537 334.598,-417.129"/>
<polygon fill="black" stroke="black" points="337.197,-419.488 342.05,-410.07 332.383,-414.406 337.197,-419.488"/>
</g>
<!-- proc~init~12 -->
<g id="node10" class="node"><title>proc~init~12</title>
<a xlink:href="../proc/init%7E12.html" xlink:title="init">
<polygon fill="#d9534f" stroke="#d9534f" points="382,-530 328,-530 328,-504 382,-504 382,-530"/>
<text text-anchor="middle" x="355" y="-514.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init</text>
</a>
</g>
<!-- proc~test_tvd_rk~4&#45;&gt;proc~init~12 -->
<g id="edge12" class="edge"><title>proc~test_tvd_rk~4&#45;&gt;proc~init~12</title>
<path fill="none" stroke="black" d="M241.765,-492.181C264.322,-497.125 294.332,-503.703 317.79,-508.844"/>
<polygon fill="black" stroke="black" points="317.211,-512.3 327.728,-511.023 318.71,-505.463 317.211,-512.3"/>
</g>
<!-- str -->
<g id="node11" class="node"><title>str</title>
<polygon fill="#777777" stroke="#777777" points="504,-468 450,-468 450,-442 504,-442 504,-468"/>
<text text-anchor="middle" x="477" y="-452.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">str</text>
</g>
<!-- proc~test_tvd_rk~4&#45;&gt;str -->
<g id="edge14" class="edge"><title>proc~test_tvd_rk~4&#45;&gt;str</title>
<path fill="none" stroke="black" d="M241.513,-493.198C252.257,-496.628 264.009,-501.193 274,-507 292.508,-517.757 289.99,-531.392 310,-539 347.389,-553.215 363.853,-556.129 400,-539 422.833,-528.18 418.93,-513.629 436,-495 441.952,-488.504 448.695,-481.714 454.968,-475.611"/>
<polygon fill="black" stroke="black" points="457.774,-477.77 462.568,-468.322 452.928,-472.717 457.774,-477.77"/>
</g>
<!-- proc~test_ab~4&#45;&gt;proc~save_results~5 -->
<g id="edge18" class="edge"><title>proc~test_ab~4&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M236.119,-432.827C256.486,-426.689 284.865,-418.137 308.788,-410.927"/>
<polygon fill="black" stroke="black" points="309.825,-414.27 318.39,-408.033 307.805,-407.568 309.825,-414.27"/>
</g>
<!-- proc~test_ab~4&#45;&gt;proc~init~12 -->
<g id="edge20" class="edge"><title>proc~test_ab~4&#45;&gt;proc~init~12</title>
<path fill="none" stroke="black" d="M236.038,-448.05C248.029,-451.703 262.09,-456.725 274,-463 291.694,-472.323 293.403,-478.84 310,-490 314.331,-492.912 318.977,-495.873 323.579,-498.714"/>
<polygon fill="black" stroke="black" points="321.918,-501.8 332.284,-503.989 325.545,-495.813 321.918,-501.8"/>
</g>
<!-- proc~test_ab~4&#45;&gt;str -->
<g id="edge22" class="edge"><title>proc~test_ab~4&#45;&gt;str</title>
<path fill="none" stroke="black" d="M236.377,-444.66C256.662,-447.206 285.003,-450.418 310,-452 354.393,-454.81 405.547,-455.33 439.419,-455.295"/>
<polygon fill="black" stroke="black" points="439.789,-458.794 449.779,-455.266 439.769,-451.794 439.789,-458.794"/>
</g>
<!-- proc~ab_solver -->
<g id="node21" class="node"><title>proc~ab_solver</title>
<a xlink:href="../proc/ab_solver.html" xlink:title="ab_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="384,-322 326,-322 326,-296 384,-296 384,-322"/>
<text text-anchor="middle" x="355" y="-306.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ab_solver</text>
</a>
</g>
<!-- proc~test_ab~4&#45;&gt;proc~ab_solver -->
<g id="edge16" class="edge"><title>proc~test_ab~4&#45;&gt;proc~ab_solver</title>
<path fill="none" stroke="black" d="M236.046,-437.184C248.898,-434.146 263.67,-428.709 274,-419 304.792,-390.059 281.128,-361.856 310,-331 312.005,-328.857 314.264,-326.897 316.674,-325.108"/>
<polygon fill="black" stroke="black" points="318.709,-327.963 325.306,-319.673 314.979,-322.039 318.709,-327.963"/>
</g>
<!-- proc~test_euler~4&#45;&gt;proc~save_results~5 -->
<g id="edge24" class="edge"><title>proc~test_euler~4&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M239.296,-522.868C250.909,-519.505 263.805,-514.452 274,-507 305.946,-483.648 330.658,-444.008 343.995,-419.232"/>
<polygon fill="black" stroke="black" points="347.172,-420.709 348.695,-410.224 340.966,-417.471 347.172,-420.709"/>
</g>
<!-- proc~test_euler~4&#45;&gt;proc~init~12 -->
<g id="edge28" class="edge"><title>proc~test_euler~4&#45;&gt;proc~init~12</title>
<path fill="none" stroke="black" d="M239.251,-526.514C261.952,-524.648 293.167,-522.082 317.461,-520.085"/>
<polygon fill="black" stroke="black" points="318.062,-523.548 327.742,-519.24 317.489,-516.571 318.062,-523.548"/>
</g>
<!-- proc~test_euler~4&#45;&gt;str -->
<g id="edge30" class="edge"><title>proc~test_euler~4&#45;&gt;str</title>
<path fill="none" stroke="black" d="M233.472,-542.093C271.714,-560.597 346.769,-588.891 400,-558 427.893,-541.813 416.267,-520.507 436,-495 441.305,-488.142 447.753,-481.316 453.949,-475.295"/>
<polygon fill="black" stroke="black" points="456.658,-477.552 461.558,-468.158 451.869,-472.447 456.658,-477.552"/>
</g>
<!-- proc~euler_solver -->
<g id="node26" class="node"><title>proc~euler_solver</title>
<a xlink:href="../proc/euler_solver.html" xlink:title="euler_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-650 320,-650 320,-624 390,-624 390,-650"/>
<text text-anchor="middle" x="355" y="-634.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">euler_solver</text>
</a>
</g>
<!-- proc~test_euler~4&#45;&gt;proc~euler_solver -->
<g id="edge26" class="edge"><title>proc~test_euler~4&#45;&gt;proc~euler_solver</title>
<path fill="none" stroke="black" d="M223.903,-542.016C243.182,-558.602 278.087,-587.782 310,-610 314.084,-612.844 318.475,-615.703 322.854,-618.442"/>
<polygon fill="black" stroke="black" points="321.367,-621.635 331.728,-623.851 325.011,-615.658 321.367,-621.635"/>
</g>
<!-- proc~test_ls_rk~4&#45;&gt;proc~save_results~5 -->
<g id="edge32" class="edge"><title>proc~test_ls_rk~4&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M238.194,-397C258.184,-397 285.127,-397 308.099,-397"/>
<polygon fill="black" stroke="black" points="308.335,-400.5 318.335,-397 308.335,-393.5 308.335,-400.5"/>
</g>
<!-- proc~test_ls_rk~4&#45;&gt;proc~init~12 -->
<g id="edge34" class="edge"><title>proc~test_ls_rk~4&#45;&gt;proc~init~12</title>
<path fill="none" stroke="black" d="M238.105,-403.144C249.935,-406.551 263.306,-411.633 274,-419 303.425,-439.27 328.024,-473.089 342.136,-495.218"/>
<polygon fill="black" stroke="black" points="339.281,-497.257 347.525,-503.913 345.231,-493.569 339.281,-497.257"/>
</g>
<!-- proc~test_ls_rk~4&#45;&gt;str -->
<g id="edge38" class="edge"><title>proc~test_ls_rk~4&#45;&gt;str</title>
<path fill="none" stroke="black" d="M238.167,-403.371C258.338,-407.772 285.796,-413.755 310,-419 354.657,-428.677 406.047,-439.745 439.892,-447.025"/>
<polygon fill="black" stroke="black" points="439.294,-450.476 449.806,-449.157 440.765,-443.632 439.294,-450.476"/>
</g>
<!-- proc~ls_rk_solver -->
<g id="node31" class="node"><title>proc~ls_rk_solver</title>
<a xlink:href="../proc/ls_rk_solver.html" xlink:title="ls_rk_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="390,-240 320,-240 320,-214 390,-214 390,-240"/>
<text text-anchor="middle" x="355" y="-224.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ls_rk_solver</text>
</a>
</g>
<!-- proc~test_ls_rk~4&#45;&gt;proc~ls_rk_solver -->
<g id="edge36" class="edge"><title>proc~test_ls_rk~4&#45;&gt;proc~ls_rk_solver</title>
<path fill="none" stroke="black" d="M238.004,-392.706C250.376,-389.587 264.19,-384.22 274,-375 304.792,-346.059 289.153,-323.757 310,-287 317.78,-273.281 328.272,-259.112 337.168,-247.991"/>
<polygon fill="black" stroke="black" points="339.968,-250.095 343.588,-240.138 334.549,-245.664 339.968,-250.095"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~tvd_rk_solver -->
<g id="edge50" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~tvd_rk_solver</title>
<path fill="none" stroke="black" d="M219.299,-240.254C236.345,-261.527 272.304,-303.667 310,-331 311.83,-332.327 313.753,-333.612 315.731,-334.849"/>
<polygon fill="black" stroke="black" points="314.218,-338.016 324.635,-339.951 317.698,-331.942 314.218,-338.016"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~save_results~5 -->
<g id="edge60" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M216.839,-240.269C236.117,-272.584 286.007,-354.237 310,-375 311.311,-376.135 312.691,-377.226 314.121,-378.274"/>
<polygon fill="black" stroke="black" points="312.422,-381.342 322.728,-383.799 316.203,-375.451 312.422,-381.342"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~init~12 -->
<g id="edge58" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~init~12</title>
<path fill="none" stroke="black" d="M218.164,-240.037C231.489,-259.331 256.525,-296.89 274,-331 293.268,-368.609 293.179,-380.235 310,-419 321.348,-445.153 335.117,-474.866 344.412,-494.652"/>
<polygon fill="black" stroke="black" points="341.278,-496.211 348.707,-503.765 347.61,-493.227 341.278,-496.211"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;str -->
<g id="edge62" class="edge"><title>proc~perform_errors_analysis&#45;&gt;str</title>
<path fill="none" stroke="black" d="M223.17,-213.87C256.983,-184.153 343.759,-117.592 400,-161 443.442,-194.53 467.124,-367.677 474.477,-431.414"/>
<polygon fill="black" stroke="black" points="471.033,-432.11 475.625,-441.658 477.989,-431.33 471.033,-432.11"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~ab_solver -->
<g id="edge54" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~ab_solver</title>
<path fill="none" stroke="black" d="M232.457,-240.175C256.936,-253.923 295.485,-275.574 322.803,-290.917"/>
<polygon fill="black" stroke="black" points="321.168,-294.013 331.601,-295.858 324.596,-287.909 321.168,-294.013"/>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~ls_rk_solver -->
<g id="edge48" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~ls_rk_solver</title>
<path fill="none" stroke="black" d="M273.888,-227C286.016,-227 298.447,-227 309.818,-227"/>
<polygon fill="black" stroke="black" points="309.925,-230.5 319.925,-227 309.925,-223.5 309.925,-230.5"/>
</g>
<!-- proc~print_analysis -->
<g id="node36" class="node"><title>proc~print_analysis</title>
<a xlink:href="../proc/print_analysis.html" xlink:title="print_analysis">
<polygon fill="#d9534f" stroke="#d9534f" points="394,-114 316,-114 316,-88 394,-88 394,-114"/>
<text text-anchor="middle" x="355" y="-98.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_analysis</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~print_analysis -->
<g id="edge44" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~print_analysis</title>
<path fill="none" stroke="black" d="M220.575,-213.815C238.509,-193.835 274.64,-155.325 310,-128 313.852,-125.023 318.057,-122.112 322.3,-119.37"/>
<polygon fill="black" stroke="black" points="324.298,-122.249 330.959,-114.011 320.614,-116.297 324.298,-122.249"/>
</g>
<!-- proc~compute_errors -->
<g id="node37" class="node"><title>proc~compute_errors</title>
<a xlink:href="../proc/compute_errors.html" xlink:title="compute_errors">
<polygon fill="#d94e8f" stroke="#d94e8f" points="399,-26 311,-26 311,-1.24345e-14 399,-3.55271e-15 399,-26"/>
<text text-anchor="middle" x="355" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_errors</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~compute_errors -->
<g id="edge46" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~compute_errors</title>
<path fill="none" stroke="black" d="M212.833,-213.58C223.161,-179.55 254.603,-88.7841 310,-35 311.092,-33.9399 312.245,-32.922 313.445,-31.9453"/>
<polygon fill="black" stroke="black" points="315.679,-34.6559 321.916,-26.0909 311.699,-28.8975 315.679,-34.6559"/>
</g>
<!-- proc~estimate_orders -->
<g id="node38" class="node"><title>proc~estimate_orders</title>
<a xlink:href="../proc/estimate_orders.html" xlink:title="estimate_orders">
<polygon fill="#d94e8f" stroke="#d94e8f" points="400,-70 310,-70 310,-44 400,-44 400,-70"/>
<text text-anchor="middle" x="355" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">estimate_orders</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~estimate_orders -->
<g id="edge52" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~estimate_orders</title>
<path fill="none" stroke="black" d="M215.032,-213.858C228.477,-185.797 263.425,-119.304 310,-79 311.311,-77.8655 312.691,-76.7742 314.121,-75.7264"/>
<polygon fill="black" stroke="black" points="316.203,-78.5486 322.728,-70.2008 312.422,-72.658 316.203,-78.5486"/>
</g>
<!-- proc~leapfrog_solver -->
<g id="node39" class="node"><title>proc~leapfrog_solver</title>
<a xlink:href="../proc/leapfrog_solver.html" xlink:title="leapfrog_solver">
<polygon fill="#d9534f" stroke="#d9534f" points="398,-196 312,-196 312,-170 398,-170 398,-196"/>
<text text-anchor="middle" x="355" y="-180.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">leapfrog_solver</text>
</a>
</g>
<!-- proc~perform_errors_analysis&#45;&gt;proc~leapfrog_solver -->
<g id="edge56" class="edge"><title>proc~perform_errors_analysis&#45;&gt;proc~leapfrog_solver</title>
<path fill="none" stroke="black" d="M252.41,-213.918C267.932,-209.24 285.604,-203.914 301.855,-199.016"/>
<polygon fill="black" stroke="black" points="303.193,-202.269 311.758,-196.032 301.173,-195.566 303.193,-202.269"/>
</g>
<!-- proc~test_leapfrog~4&#45;&gt;proc~save_results~5 -->
<g id="edge64" class="edge"><title>proc~test_leapfrog~4&#45;&gt;proc~save_results~5</title>
<path fill="none" stroke="black" d="M246.599,-364.331C265.463,-370.016 288.49,-376.956 308.46,-382.974"/>
<polygon fill="black" stroke="black" points="307.702,-386.401 318.286,-385.936 309.721,-379.699 307.702,-386.401"/>
</g>
<!-- proc~test_leapfrog~4&#45;&gt;proc~init~12 -->
<g id="edge68" class="edge"><title>proc~test_leapfrog~4&#45;&gt;proc~init~12</title>
<path fill="none" stroke="black" d="M246.801,-360.713C256.395,-363.97 266.186,-368.559 274,-375 294.319,-391.749 327.737,-458.82 344.591,-494.465"/>
<polygon fill="black" stroke="black" points="341.467,-496.048 348.88,-503.617 347.806,-493.077 341.467,-496.048"/>
</g>
<!-- proc~test_leapfrog~4&#45;&gt;str -->
<g id="edge70" class="edge"><title>proc~test_leapfrog~4&#45;&gt;str</title>
<path fill="none" stroke="black" d="M223.442,-339.896C256.752,-311.323 340.65,-248.915 400,-287 450.382,-319.33 468.226,-393.776 474.199,-431.772"/>
<polygon fill="black" stroke="black" points="470.764,-432.477 475.641,-441.883 477.694,-431.489 470.764,-432.477"/>
</g>
<!-- proc~test_leapfrog~4&#45;&gt;proc~leapfrog_solver -->
<g id="edge66" class="edge"><title>proc~test_leapfrog~4&#45;&gt;proc~leapfrog_solver</title>
<path fill="none" stroke="black" d="M216.839,-339.731C236.117,-307.416 286.007,-225.763 310,-205 311.311,-203.865 312.691,-202.774 314.121,-201.726"/>
<polygon fill="black" stroke="black" points="316.203,-204.549 322.728,-196.201 312.422,-198.658 316.203,-204.549"/>
</g>
<!-- proc~exact_solution -->
<g id="node12" class="node"><title>proc~exact_solution</title>
<a xlink:href="../proc/exact_solution.html" xlink:title="exact_solution">
<polygon fill="#d94e8f" stroke="#d94e8f" points="517,-216 437,-216 437,-190 517,-190 517,-216"/>
<text text-anchor="middle" x="477" y="-200.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_solution</text>
</a>
</g>
<!-- proc~save_results~5&#45;&gt;proc~exact_solution -->
<g id="edge2" class="edge"><title>proc~save_results~5&#45;&gt;proc~exact_solution</title>
<path fill="none" stroke="black" d="M388.741,-383.83C392.847,-381.307 396.736,-378.376 400,-375 441.628,-331.94 463.095,-262.511 471.948,-226.444"/>
<polygon fill="black" stroke="black" points="475.43,-226.922 474.299,-216.388 468.614,-225.329 475.43,-226.922"/>
</g>
<!-- proc~init~12&#45;&gt;str -->
<g id="edge6" class="edge"><title>proc~init~12&#45;&gt;str</title>
<path fill="none" stroke="black" d="M380.873,-503.851C398.665,-494.809 422.506,-482.694 441.993,-472.79"/>
<polygon fill="black" stroke="black" points="443.835,-475.78 451.164,-468.13 440.664,-469.54 443.835,-475.78"/>
</g>
<!-- strz -->
<g id="node14" class="node"><title>strz</title>
<polygon fill="#777777" stroke="#777777" points="504,-530 450,-530 450,-504 504,-504 504,-530"/>
<text text-anchor="middle" x="477" y="-514.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">strz</text>
</g>
<!-- proc~init~12&#45;&gt;strz -->
<g id="edge4" class="edge"><title>proc~init~12&#45;&gt;strz</title>
<path fill="none" stroke="black" d="M382.076,-517C399.055,-517 421.177,-517 439.792,-517"/>
<polygon fill="black" stroke="black" points="440,-520.5 450,-517 440,-513.5 440,-520.5"/>
</g>
<!-- proc~print_analysis&#45;&gt;str -->
<g id="edge40" class="edge"><title>proc~print_analysis&#45;&gt;str</title>
<path fill="none" stroke="black" d="M384.864,-114.281C390.586,-118.003 396.024,-122.556 400,-128 436.095,-177.421 464.756,-365.563 473.915,-431.777"/>
<polygon fill="black" stroke="black" points="470.489,-432.558 475.307,-441.995 477.425,-431.614 470.489,-432.558"/>
</g>
<!-- proc~compute_errors&#45;&gt;proc~exact_solution -->
<g id="edge42" class="edge"><title>proc~compute_errors&#45;&gt;proc~exact_solution</title>
<path fill="none" stroke="black" d="M388.714,-26.1971C392.823,-28.7159 396.721,-31.6383 400,-35 441.01,-77.0464 462.742,-144.866 471.797,-180.098"/>
<polygon fill="black" stroke="black" points="468.425,-181.044 474.208,-189.921 475.224,-179.375 468.425,-181.044"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
Nodes of different colours represent the following:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(0.817602 0.817602) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 781,-30 781,5 -4,5"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-26 2.13163e-14,-26 0,-1.24345e-14 54,-3.55271e-15 54,-26"/>
<text text-anchor="middle" x="27" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-26 72,-26 72,-1.24345e-14 138,-3.55271e-15 138,-26"/>
<text text-anchor="middle" x="105" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Type -->
<g id="node3" class="node"><title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="210,-26 156,-26 156,-1.24345e-14 210,-3.55271e-15 210,-26"/>
<text text-anchor="middle" x="183" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type</text>
</g>
<!-- Subroutine -->
<g id="node4" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="292,-26 228,-26 228,-1.24345e-14 292,-3.55271e-15 292,-26"/>
<text text-anchor="middle" x="260" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node5" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="364,-26 310,-26 310,-1.24345e-14 364,-3.55271e-15 364,-26"/>
<text text-anchor="middle" x="337" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node6" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="436,-26 382,-26 382,-1.24345e-14 436,-3.55271e-15 436,-26"/>
<text text-anchor="middle" x="409" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node7" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="590,-26 454,-26 454,-1.24345e-14 590,-3.55271e-15 590,-26"/>
<text text-anchor="middle" x="522" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node8" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="662,-26 608,-26 608,-1.24345e-14 662,-3.55271e-15 662,-26"/>
<text text-anchor="middle" x="635" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node9" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="776,-26 680,-26 680,-1.24345e-14 776,-3.55271e-15 776,-26"/>
<text text-anchor="middle" x="728" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<h5>Module Graph</h5>
<p>Solid arrows point from a parent (sub)module to the submodule which is
descended from it. Dashed arrows point from a module being used to the
module using it.</p>
<h5>Type Graph</h5>
<p>Solid arrows point from one derived type to another which extends
(inherits from) it. Dashed arrows point from a derived type to another
type containing it as a components, with a label listing the name(s) of
said component(s).</p>
<h5>Call Graph</h5>
<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.</p>

                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>

    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cli%7E5"></span>type(Type_Command_Line_Interface)</td>
  
  
  <td></td><td>::</td>
  <td><strong>cli</strong></td><td></td><td></td><td><p>Command line interface handler.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-space_dimension%7E2"></span>integer,</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>space_dimension</strong></td><td> =</td><td>2</td><td><p>Space dimensions.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-initial_state%7E10"></span>real(kind=R_P),</td>
  
  
  <td>parameter</td><td>::</td>
  <td><strong>initial_state</strong>(1:space_dimension)</td><td> =</td><td>[0._R_P,1._R_P]</td><td><p>Initial state.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f%7E5"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>f</strong></td><td></td><td></td><td><p>Oscillation frequency.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t_final%7E4"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>t_final</strong></td><td></td><td></td><td><p>Final time.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dt%7E8"></span>real(kind=R_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>Dt</strong></td><td></td><td></td><td><p>Time step.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-error%7E5"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>error</strong></td><td></td><td></td><td><p>Error handler.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-stages_steps%7E2"></span>integer(kind=I_P)</td>
  
  
  <td></td><td>::</td>
  <td><strong>stages_steps</strong></td><td></td><td></td><td><p>Number of stages/steps used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-solver%7E4"></span>character(len=99)</td>
  
  
  <td></td><td>::</td>
  <td><strong>solver</strong></td><td></td><td></td><td><p>Solver used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-plots%7E5"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>plots</strong></td><td></td><td></td><td><p>Flag for activating plots saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-results%7E5"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>results</strong></td><td></td><td></td><td><p>Flag for activating results saving.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-output_cli%7E2"></span>character(len=99)</td>
  
  
  <td></td><td>::</td>
  <td><strong>output_cli</strong></td><td></td><td></td><td><p>Output files basename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-errors_analysis"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>errors_analysis</strong></td><td></td><td></td><td><p>Flag for activating errors analysis.</p></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    
    
    

    
    
     
    <section>
    <h2>Functions</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-exact_solution"></span><h3>
function <a href='../proc/exact_solution.html'>exact_solution</a>(t) result(ex_sol)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t</strong></td><td><p>Time.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:space_dimension)</small></h4>
  <p>Exact solution.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Compute the exact solution.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-compute_errors"></span><h3>
function <a href='../proc/compute_errors.html'>compute_errors</a>(solution) result(error_L2)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:space_dimension)</small></h4>
  <p>L2 norm of the numerical error.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Compute the L2 norm of numerical error with respect the exact solution.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-estimate_orders"></span><h3>
function <a href='../proc/estimate_orders.html'>estimate_orders</a>(solver_error, Dt_used) result(order)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solver_error</strong>(1:space_dimension,1:2)</td><td><p>Computed errors.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dt_used</strong>(1:2)</td><td><p>Time steps used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=R_P)
  (1:space_dimension)</small></h4>
  <p>Estimation of the order of accuracy.</p>
    
    
    <h4>Description</h4>
       
       


       
       <p>Estimate the order of accuracy using 2 subsequent refined numerical solutions.</p>
        

  </div>
  </div>

    
    </section>
    <br>
    


    
    <section>
    <h2>Subroutines</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-init%7E12"></span><h3>
subroutine <a href='../proc/init%7E12.html'>init</a>(output, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=:),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>output</strong></td><td><p>Output files basename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>allocatable</td><td>::</td>
  <td><strong>solution</strong>(:,:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Initialize solver local variable from global variables.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-save_results%7E5"></span><h3>
subroutine <a href='../proc/save_results%7E5.html'>save_results</a>(title, basename, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>title</strong></td><td><p>Plot title.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>basename</strong></td><td><p>Output files basename.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Save plots of results.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_ab%7E4"></span><h3>
subroutine <a href='../proc/test_ab%7E4.html'>test_ab</a>(steps)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit Adams-Bashforth class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_euler%7E4"></span><h3>
subroutine <a href='../proc/test_euler%7E4.html'>test_euler</a>()
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit forward Euler ODE solver.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_leapfrog%7E4"></span><h3>
subroutine <a href='../proc/test_leapfrog%7E4.html'>test_leapfrog</a>()
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit leapfrog class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_ls_rk%7E4"></span><h3>
subroutine <a href='../proc/test_ls_rk%7E4.html'>test_ls_rk</a>(stages)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit low storage Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-test_tvd_rk%7E4"></span><h3>
subroutine <a href='../proc/test_tvd_rk%7E4.html'>test_tvd_rk</a>(stages)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Test explicit TVD/SSP Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-ab_solver"></span><h3>
subroutine <a href='../proc/ab_solver.html'>ab_solver</a>(steps, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>steps</strong></td><td><p>Number of steps used: if negative all AB solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit Adams-Bashforth class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-euler_solver"></span><h3>
subroutine <a href='../proc/euler_solver.html'>euler_solver</a>(solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit forward Euler ODE solver.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-leapfrog_solver"></span><h3>
subroutine <a href='../proc/leapfrog_solver.html'>leapfrog_solver</a>(solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit leapfrog class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-ls_rk_solver"></span><h3>
subroutine <a href='../proc/ls_rk_solver.html'>ls_rk_solver</a>(stages, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit low storage Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-tvd_rk_solver"></span><h3>
subroutine <a href='../proc/tvd_rk_solver.html'>tvd_rk_solver</a>(stages, solution)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stages</strong></td><td><p>Number of stages used: if negative all RK solvers are used.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>solution</strong>(0:,0:)</td><td><p>Solution at each time step.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Solve problem with explicit TVD/SSP Runge-Kutta class of ODE solvers.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-perform_errors_analysis"></span><h3>
subroutine <a href='../proc/perform_errors_analysis.html'>perform_errors_analysis</a>()
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Peform errors analysis.</p>
        

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-print_analysis"></span><h3>
subroutine <a href='../proc/print_analysis.html'>print_analysis</a>(ab_steps, rk_stages, NDt, time_steps, ab_errors, lf_errors, ls_errors, rk_errors, ab_orders, lf_orders, ls_orders, rk_orders)
    
    
    
</h3></div>
  <div class="panel-body">
       
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ab_steps</strong></td><td><p>Adams-Bashforth steps number.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rk_stages</strong></td><td><p>Runge-Kutta stages number.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=I_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>NDt</strong></td><td><p>Number of time steps exercised.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>time_steps</strong>(:)</td><td><p>Time steps exercised.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ab_errors</strong>(:,:,:)</td><td><p>Adams-Bashforth errors.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>lf_errors</strong>(:,:)</td><td><p>Leapfrog errors.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ls_errors</strong>(:,:,:)</td><td><p>Low storage Runge-Kutta errors.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rk_errors</strong>(:,:,:)</td><td><p>TVD/SSP Runge-Kutta errors.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ab_orders</strong>(:,:,:)</td><td><p>Adams-Bashforth orders.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>lf_orders</strong>(:,:)</td><td><p>Leapfrog orders.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ls_orders</strong>(:,:,:)</td><td><p>Low storage Runge-Kutta orders.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=R_P),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rk_orders</strong>(:,:,:)</td><td><p>TVD/SSP Runge-Kutta orders.</p></td>
  
</tr>

</tbody>
</table>

      
    
    
    
    <h4>Description</h4>
       
       


       
       <p>Print summary of the error analysis.</p>
        

  </div>
  </div>

    
    </section>    
    
    
    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span class="k">program </span><span class="n">integrate_oscillation</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c">!&lt; Test FOODiE with the integration of Oscillation equations.</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">use </span><span class="n">IR_Precision</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">R_P</span><span class="p">,</span> <span class="n">I_P</span><span class="p">,</span> <span class="n">FR_P</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">strz</span>
<span class="k">use </span><span class="n">type_oscillation</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">oscillation</span>
<span class="k">use </span><span class="n">Data_Type_Command_Line_Interface</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">Type_Command_Line_Interface</span>
<span class="k">use </span><span class="n">foodie</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">adams_bashforth_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">euler_explicit_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">leapfrog_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">ls_runge_kutta_integrator</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">tvd_runge_kutta_integrator</span>
<span class="k">use </span><span class="n">pyplot_module</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span>  <span class="n">pyplot</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">implicit none</span>
<span class="k">type</span><span class="p">(</span><span class="n">Type_Command_Line_Interface</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cli</span>                                               <span class="c">!&lt; Command line interface handler.</span>
<span class="kt">integer</span><span class="p">,</span>   <span class="k">parameter</span>              <span class="kd">::</span> <span class="n">space_dimension</span><span class="o">=</span><span class="mi">2</span>                                 <span class="c">!&lt; Space dimensions.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">parameter</span>              <span class="kd">::</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="mf">1._R_P</span><span class="p">]</span> <span class="c">!&lt; Initial state.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">f</span>                                                 <span class="c">!&lt; Oscillation frequency.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">t_final</span>                                           <span class="c">!&lt; Final time.</span>
<span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">Dt</span>                                                <span class="c">!&lt; Time step.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">error</span>                                             <span class="c">!&lt; Error handler.</span>
<span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">stages_steps</span>                                      <span class="c">!&lt; Number of stages/steps used.</span>
<span class="kt">character</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">solver</span>                                            <span class="c">!&lt; Solver used.</span>
<span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">plots</span>                                             <span class="c">!&lt; Flag for activating plots saving.</span>
<span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">results</span>                                           <span class="c">!&lt; Flag for activating results saving.</span>
<span class="kt">character</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">output_cli</span>                                        <span class="c">!&lt; Output files basename.</span>
<span class="kt">logical</span>                           <span class="kd">::</span> <span class="n">errors_analysis</span>                                   <span class="c">!&lt; Flag for activating errors analysis.</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="c">! setting Command Line Interface</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">progname</span>    <span class="o">=</span> <span class="s1">&#39;oscillation&#39;</span><span class="p">,</span>                                              <span class="p">&amp;</span>
              <span class="n">authors</span>     <span class="o">=</span> <span class="s1">&#39;Fortran-FOSS-Programmers&#39;</span><span class="p">,</span>                                 <span class="p">&amp;</span>
              <span class="n">license</span>     <span class="o">=</span> <span class="s1">&#39;GNU GPLv3&#39;</span><span class="p">,</span>                                                <span class="p">&amp;</span>
              <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Test FOODiE library on Oscillation equations integration&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">examples</span>    <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;oscillation --solver euler --results  &quot;</span><span class="p">,</span>                  <span class="p">&amp;</span>
                             <span class="s2">&quot;oscillation --solver ls-runge-kutta -r&quot;</span><span class="p">,</span>                  <span class="p">&amp;</span>
                             <span class="s2">&quot;oscillation --solver adams-bashforth  &quot;</span><span class="p">,</span>                  <span class="p">&amp;</span>
                             <span class="s2">&quot;oscillation --solver all --plots -r   &quot;</span><span class="p">])</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--solver&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;ODE solver used&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--ss&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Stages/steps used&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--frequency&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Oscillation frequency&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;1e-4&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--time_step&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-Dt&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Integration time step&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;100.d0&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--t_final&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-tf&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Final integration time&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;1e6&#39;</span><span class="p">,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--results&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Save results&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--plots&#39;</span><span class="p">,</span> <span class="n">switch_ab</span><span class="o">=</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Save plots of results&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Output files basename&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;unset&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--errors_analysis&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Peform errors analysis&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">act</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">def</span><span class="o">=</span><span class="s1">&#39;.false.&#39;</span><span class="p">)</span>
<span class="c">! parsing Command Line Interface</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">parse</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--ss&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-Dt&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-tf&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">t_final</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">plots</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--output&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">output_cli</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">call </span><span class="n">cli</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">switch</span><span class="o">=</span><span class="s1">&#39;--errors_analysis&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">errors_analysis</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">stop</span>
<span class="k">if</span> <span class="p">(</span><span class="n">errors_analysis</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  call </span><span class="n">perform_errors_analysis</span>
<span class="k">else</span>
<span class="k">  select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">)))</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;adams-bashforth&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_ab</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;euler&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_euler</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;leapfrog&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_leapfrog</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;ls-runge-kutta&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_ls_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;tvd-runge-kutta&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_tvd_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_ab</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_euler</span>
    <span class="k">call </span><span class="n">test_leapfrog</span>
    <span class="k">call </span><span class="n">test_ls_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
    <span class="k">call </span><span class="n">test_tvd_rk</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages_steps</span><span class="p">)</span>
  <span class="k">case </span><span class="n">default</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Error: unknown solver &quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Valid solver names are:&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + adams-bashforth&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + euler&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + leapfrog&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + ls-runge-kutta&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + tvd-runge-kutta&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;  + all&#39;</span>
  <span class="n">endselect</span>
<span class="n">endif</span>
<span class="k">stop</span>
<span class="c">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<span class="k">contains</span>
<span class="k">  subroutine </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Initialize solver local variable from global variables.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">output</span>        <span class="c">!&lt; Output files basename.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>        <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span> <span class="c">!&lt; Solution at each time step.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">t_final</span><span class="p">,</span> <span class="n">Dt</span><span class="p">)</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Error: the final integration time must be an exact multiple of the time step used!&#39;</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Final integration time: &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">t_final</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Time step: &#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">Dt</span><span class="p">)</span>
    <span class="k">stop</span>
<span class="k">  </span><span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">output_cli</span><span class="p">))</span><span class="o">/=</span><span class="s1">&#39;unset&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">output</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">output_cli</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span><span class="o">//</span><span class="s1">&#39;-time_steps&#39;</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
  <span class="k">else</span>
<span class="k">    </span><span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;oscillation_integration-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">strz</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span><span class="o">//</span><span class="s1">&#39;-time_steps&#39;</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">solver</span><span class="p">))</span>
  <span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">solution</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="p">;</span> <span class="k">allocate</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">init</span>

  <span class="k">function </span><span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ex_sol</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the exact solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">t</span>                         <span class="c">!&lt; Time.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span> <span class="c">!&lt; Exact solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
  <span class="n">ex_sol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">initial_state</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">exact_solution</span>

  <span class="k">subroutine </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Save plots of results.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">title</span>                     <span class="c">!&lt; Plot title.</span>
  <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">basename</span>                  <span class="c">!&lt; Output files basename.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>           <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">rawfile</span>                   <span class="c">!&lt; Raw file unit for saving results.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span> <span class="c">!&lt; Exact solution.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">pyplot</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">plt</span>                       <span class="c">!&lt; Plot file handler.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">i</span>                         <span class="c">!&lt; Counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">s</span>                         <span class="c">!&lt; Counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    open</span><span class="p">(</span><span class="n">newunit</span><span class="o">=</span><span class="n">rawfile</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">basename</span><span class="o">//</span><span class="s1">&#39;.dat&#39;</span><span class="p">)</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;TITLE=&quot;&#39;</span><span class="o">//</span><span class="n">title</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;VARIABLES=&quot;t&quot; &quot;x&quot; &quot;y&quot;&#39;</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;ZONE T=&quot;FOODiE time serie&quot;&#39;</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ubound</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(3(&#39;</span><span class="o">//</span><span class="n">FR_P</span><span class="o">//</span><span class="s1">&#39;,1X))&#39;</span><span class="p">)(</span><span class="n">solution</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">space_dimension</span><span class="p">)</span>
    <span class="n">enddo</span>
    <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="s1">&#39;ZONE T=&quot;Exact solution&quot;&#39;</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ubound</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">ex_sol</span> <span class="o">=</span> <span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">write</span><span class="p">(</span><span class="n">rawfile</span><span class="p">,</span> <span class="s1">&#39;(3(&#39;</span><span class="o">//</span><span class="n">FR_P</span><span class="o">//</span><span class="s1">&#39;,1X))&#39;</span><span class="p">)</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="p">(</span><span class="n">ex_sol</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_dimension</span><span class="p">)</span>
    <span class="n">enddo</span>
    <span class="k">close</span><span class="p">(</span><span class="n">rawfile</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">plots</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    call </span><span class="n">plt</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">:),</span> <span class="n">y</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">:),</span> <span class="n">y</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">savefig</span><span class="p">(</span><span class="n">basename</span><span class="o">//</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>

    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="o">//</span><span class="s1">&#39;-path&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">add_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">:),</span> <span class="n">y</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">:),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">call </span><span class="n">plt</span><span class="p">%</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;path-&#39;</span><span class="o">//</span><span class="n">basename</span><span class="o">//</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
  <span class="n">endif</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">save_results</span>

  <span class="k">subroutine </span><span class="n">test_ab</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit Adams-Bashforth class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">steps</span>            <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">ab_steps</span><span class="o">=</span><span class="mi">4</span>       <span class="c">!&lt; Adams-Bashforth steps number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                <span class="c">!&lt; AB steps counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Steps used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>           <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>            <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of Adams-Bashforth class of solvers&#39;</span>
  <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">steps_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">steps</span><span class="p">,</span> <span class="n">steps</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">steps_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">steps_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; AB-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit Adams-Bashforth, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">ab_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_ab</span>

  <span class="k">subroutine </span><span class="n">test_euler</span><span class="p">()</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit forward Euler ODE solver.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span> <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>        <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>         <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;euler&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of explicit Euler solver&#39;</span>
  <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit Euler, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
  <span class="k">call </span><span class="n">euler_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_euler</span>

  <span class="k">subroutine </span><span class="n">test_leapfrog</span><span class="p">()</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit leapfrog class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span> <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>        <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>         <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;leapfrog&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of leapfrog (RAW filtered) class of solvers&#39;</span>
  <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, leapfrog (RAW filtered), t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
  <span class="k">call </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_leapfrog</span>

  <span class="k">subroutine </span><span class="n">test_ls_rk</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit low storage Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">stages</span>            <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>       <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>     <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                 <span class="c">!&lt; RK stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Stages used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>            <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>             <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;ls-runge-kutta&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of low storage (2N) Runge-Kutta class of solvers&#39;</span>
  <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">stages</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">stages</span><span class="p">,</span> <span class="n">stages</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; RK-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit low storage Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
      <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">ls_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_ls_rk</span>

  <span class="k">subroutine </span><span class="n">test_tvd_rk</span><span class="p">(</span><span class="n">stages</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Test explicit TVD/SSP Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">stages</span>            <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>            <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>       <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>     <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">s</span>                 <span class="c">!&lt; RK stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Stages used.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">output</span>            <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">title</span>             <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;tvd-runge-kutta&#39;</span>
  <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Integrating Oscillation equations by means of TVD/SSP Runge-Kutta class of solvers&#39;</span>
  <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span><span class="p">]</span> <span class="p">;</span> <span class="k">if</span> <span class="p">(</span><span class="n">stages</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">stages_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">stages</span><span class="p">,</span> <span class="n">stages</span><span class="p">]</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="n">stages_range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">stages_range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39; RK-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit TVD/SSP Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">call </span><span class="n">tvd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s1">&#39;Finish!&#39;</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">test_tvd_rk</span>

  <span class="k">subroutine </span><span class="n">ab_solver</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit Adams-Bashforth class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">steps</span>                 <span class="c">!&lt; Number of steps used: if negative all AB solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>               <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">adams_bashforth_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_integrator</span>         <span class="c">!&lt; Adams-Bashforth integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">steps</span><span class="p">)</span>     <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                          <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">ab_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">select case</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
  <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">endselect</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">steps</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to s - 1 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">ab_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">-</span><span class="n">steps</span><span class="p">:</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">ab_solver</span>

  <span class="k">subroutine </span><span class="n">euler_solver</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit forward Euler ODE solver.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>  <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">euler_explicit_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">euler_integrator</span> <span class="c">!&lt; Euler integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">oscillator</span>       <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">step</span>             <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">euler_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">euler_solver</span>

  <span class="k">subroutine </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit leapfrog class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>               <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>           <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">leapfrog_integrator</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">lf_integrator</span>         <span class="c">!&lt; Leapfrog integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">previous</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>         <span class="c">!&lt; Previous time steps solutions.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">filter</span>                <span class="c">!&lt; Filter displacement.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span>                          <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">lf_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">()</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">rk_stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">2</span><span class="o">&gt;=</span><span class="n">step</span><span class="p">)</span> <span class="k">then</span>
      <span class="c">! time steps from 1 to 2 must be computed with other scheme</span>
      <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
      <span class="n">previous</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span>
    <span class="k">else</span>
<span class="k">      call </span><span class="n">lf_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span> <span class="n">filter</span><span class="o">=</span><span class="n">filter</span><span class="p">)</span>
    <span class="n">endif</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">leapfrog_solver</span>

  <span class="k">subroutine </span><span class="n">ls_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit low storage Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">stages</span>                <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>       <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">ls_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>         <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>              <span class="kd">::</span> <span class="n">registers</span><span class="o">=</span><span class="mi">2</span>           <span class="c">!&lt; Runge-Kutta stages registers number.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">registers</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta registers.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">oscillator</span>            <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">step</span>                  <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">ls_rk_solver</span>

  <span class="k">subroutine </span><span class="n">tvd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Solve problem with explicit TVD/SSP Runge-Kutta class of ODE solvers.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">stages</span>             <span class="c">!&lt; Number of stages used: if negative all RK solvers are used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>    <span class="c">!&lt; Solution at each time step.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">tvd_runge_kutta_integrator</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_integrator</span>      <span class="c">!&lt; Runge-Kutta integrator.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">rk_stage</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">stages</span><span class="p">)</span> <span class="c">!&lt; Runge-Kutta stages.</span>
  <span class="k">type</span><span class="p">(</span><span class="n">oscillation</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">oscillator</span>         <span class="c">!&lt; Oscillation field.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">step</span>               <span class="c">!&lt; Time steps counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">stages</span><span class="p">)</span>
  <span class="k">call </span><span class="n">oscillator</span><span class="p">%</span><span class="n">init</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
  <span class="n">solution</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">do while</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span><span class="o">&lt;</span><span class="n">t_final</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">call </span><span class="n">rk_integrator</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="n">oscillator</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">rk_stage</span><span class="p">,</span> <span class="n">Dt</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">Dt</span>
    <span class="n">solution</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">=</span> <span class="n">oscillator</span><span class="p">%</span><span class="n">output</span><span class="p">()</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">tvd_rk_solver</span>

  <span class="k">subroutine </span><span class="n">perform_errors_analysis</span><span class="p">()</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Peform errors analysis.</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; The analysis is based on the integration of the Oscillation equations with different, decreasing time steps in the range</span>
  <span class="c">!&lt; *[5000, 2500, 1250, 625, 320, 100]*. The error is estimated by the L2 norm of the difference between the exact (\(U_e\)) and</span>
  <span class="c">!&lt; the numerical (\(U_{\Delta t}\)) solutions for each time step:</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;\varepsilon (\Delta t) = || U_e - U_{\Delta t} ||_2 = \sqrt{ \sum_{s=1}^{N_s} { \left(U_e(t_0 + s * \Delta t) -</span>
  <span class="c">!&lt;U_{\Delta t}(t_0 + s * \Delta t) \right)^2 }}</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt; Using two pairs of subsequent-decreasing time steps solution is possible to estimate the order of accuracy of the solver</span>
  <span class="c">!&lt; employed computing the \emph{observed order} of accuracy:</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;p = \frac{log10 \left( \frac{\varepsilon (\Delta t_1)}{\varepsilon (\Delta t_2)} \right)}</span>
  <span class="c">!&lt;{log10 \left( \frac{\Delta t_1}{\Delta t_2} \right)}</span>
  <span class="c">!&lt;$$</span>
  <span class="c">!&lt;</span>
  <span class="c">!&lt;where \(\frac{\Delta t_1}{\Delta t_2}&gt;1\).</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">parameter</span>          <span class="kd">::</span> <span class="n">NDt</span><span class="o">=</span><span class="mi">6</span>                        <span class="c">!&lt; Number of time steps exercised.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">parameter</span>          <span class="kd">::</span> <span class="n">time_steps</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                         <span class="mi">250</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                         <span class="mi">125</span><span class="mf">0._R_P</span><span class="p">,</span> <span class="p">&amp;</span>
                                                         <span class="mi">62</span><span class="mf">5._R_P</span><span class="p">,</span>  <span class="p">&amp;</span>
                                                         <span class="mi">32</span><span class="mf">0._R_P</span><span class="p">,</span>  <span class="p">&amp;</span>
                                                         <span class="mi">10</span><span class="mf">0._R_P</span><span class="p">]</span> <span class="c">!&lt; Time steps exercised.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>               <span class="kd">::</span> <span class="n">ab_steps</span><span class="o">=</span><span class="mi">4</span>                   <span class="c">!&lt; Adams-Bashforth steps number.</span>
  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span>               <span class="kd">::</span> <span class="n">rk_stages</span><span class="o">=</span><span class="mi">5</span>                  <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">ab_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span>       <span class="p">&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>             <span class="c">!&lt; Adams-Bashforth errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">lf_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>             <span class="c">!&lt; Leapfrog errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">ls_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">,</span>      <span class="p">&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>             <span class="c">!&lt; Low storage Runge-Kutta errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">rk_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">,</span>      <span class="p">&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="p">)</span>             <span class="c">!&lt; TVD/SSP Runge-Kutta errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">ab_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">ab_steps</span><span class="p">,</span>       <span class="p">&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>           <span class="c">!&lt; Adams-Bashforth orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">lf_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>           <span class="c">!&lt; Leapfrog orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">ls_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">,</span>      <span class="p">&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>           <span class="c">!&lt; Low storage Runge-Kutta orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>                        <span class="kd">::</span> <span class="n">rk_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">rk_stages</span><span class="p">,</span>      <span class="p">&amp;</span>
                                                <span class="mi">1</span><span class="p">:</span><span class="n">NDt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>           <span class="c">!&lt; TVD/SSP Runge-Kutta orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">allocatable</span>           <span class="kd">::</span> <span class="n">solution</span><span class="p">(:,:)</span>                <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">s</span>                            <span class="c">!&lt; Steps/stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">d</span>                            <span class="c">!&lt; Time steps-exercised counter.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">output</span>                       <span class="c">!&lt; Output files basename.</span>
  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">title</span>                        <span class="c">!&lt; Output files title.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">solution</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="p">;</span> <span class="k">allocate</span><span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">t_final</span><span class="o">/</span><span class="n">Dt</span><span class="p">)))</span>
  <span class="n">results</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">! activate results saving</span>
  <span class="c">! Analyze errors of Adams-Bashforth solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;adams-bashforth&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1st order scheme surely not stable for this test</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit Adams-Bashforth, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">ab_solver</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">ab_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1st order scheme surely not stable for this test</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">ab_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">ab_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of leapfrog solver</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;leapfrog&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, leapfrog (RAW filtered), t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span>
    <span class="k">call </span><span class="n">leapfrog_solver</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">lf_errors</span><span class="p">(:,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">lf_orders</span><span class="p">(:,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">lf_errors</span><span class="p">(:,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of low storage Runge-Kutta solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;ls-runge-kutta&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1st order scheme surely not stable for this test</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit low storage Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
        <span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">ls_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">ls_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1st order scheme surely not stable for this test</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">ls_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">ls_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="c">! Analyze errors of TVD/SSP Runge-Kutta solvers</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span> <span class="c">! loop over exercised time steps</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;tvd-runge-kutta&#39;</span>
    <span class="k">call </span><span class="n">init</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1st order scheme surely not stable for this test</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
      <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Oscillation equation integration, explicit TVD/SSP Runge-Kutta, t=&#39;</span><span class="o">//</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">t_final</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; steps=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">))</span>
      <span class="k">call </span><span class="n">tvd_rk_solver</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="k">call </span><span class="n">save_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="n">output</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span> <span class="n">s</span><span class="p">)),</span> <span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
      <span class="n">rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="o">=</span><span class="n">solution</span><span class="p">)</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1st order scheme surely not stable for this test</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">rk_orders</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="o">=</span><span class="n">rk_errors</span><span class="p">(:,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">Dt_used</span><span class="o">=</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">call </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">ab_steps</span><span class="o">=</span><span class="n">ab_steps</span><span class="p">,</span> <span class="n">rk_stages</span><span class="o">=</span><span class="n">rk_stages</span><span class="p">,</span> <span class="n">NDt</span><span class="o">=</span><span class="n">NDt</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="n">time_steps</span><span class="p">,</span> <span class="p">&amp;</span>
                      <span class="n">ab_errors</span><span class="o">=</span><span class="n">ab_errors</span><span class="p">,</span> <span class="n">lf_errors</span><span class="o">=</span><span class="n">lf_errors</span><span class="p">,</span> <span class="n">ls_errors</span><span class="o">=</span><span class="n">ls_errors</span><span class="p">,</span> <span class="n">rk_errors</span><span class="o">=</span><span class="n">rk_errors</span><span class="p">,</span> <span class="p">&amp;</span>
                      <span class="n">ab_orders</span><span class="o">=</span><span class="n">ab_orders</span><span class="p">,</span> <span class="n">lf_orders</span><span class="o">=</span><span class="n">lf_orders</span><span class="p">,</span> <span class="n">ls_orders</span><span class="o">=</span><span class="n">ls_orders</span><span class="p">,</span> <span class="n">rk_orders</span><span class="o">=</span><span class="n">rk_orders</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">perform_errors_analysis</span>

  <span class="k">function </span><span class="n">compute_errors</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">error_L2</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Compute the L2 norm of numerical error with respect the exact solution.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">:,</span><span class="mi">0</span><span class="p">:)</span>             <span class="c">!&lt; Solution at each time step.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">error_L2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span> <span class="c">!&lt; L2 norm of the numerical error.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ex_sol</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span>   <span class="c">!&lt; Exact solution.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">s</span>                           <span class="c">!&lt; Steps/stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">v</span>                           <span class="c">!&lt; Variables counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">error_L2</span> <span class="o">=</span> <span class="mf">0._R_P</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ubound</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ex_sol</span> <span class="o">=</span> <span class="n">exact_solution</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
    <span class="k">do </span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_dimension</span>
      <span class="n">error_L2</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">error_L2</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">solution</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="n">ex_sol</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="n">error_L2</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">error_L2</span><span class="p">)</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">compute_errors</span>

  <span class="k">function </span><span class="n">estimate_orders</span><span class="p">(</span><span class="n">solver_error</span><span class="p">,</span> <span class="n">Dt_used</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Estimate the order of accuracy using 2 subsequent refined numerical solutions.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">solver_error</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="c">!&lt; Computed errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Dt_used</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>                         <span class="c">!&lt; Time steps used.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">order</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">space_dimension</span><span class="p">)</span>             <span class="c">!&lt; Estimation of the order of accuracy.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">v</span>                                    <span class="c">!&lt; Variables counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">do </span><span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_dimension</span>
    <span class="n">order</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">log</span><span class="p">(</span><span class="n">solver_error</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">solver_error</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="nb">log</span><span class="p">(</span><span class="n">Dt_used</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">Dt_used</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endfunction</span> <span class="n">estimate_orders</span>

  <span class="k">subroutine </span><span class="n">print_analysis</span><span class="p">(</span><span class="n">ab_steps</span><span class="p">,</span> <span class="n">rk_stages</span><span class="p">,</span> <span class="n">NDt</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">,</span> <span class="p">&amp;</span>
                            <span class="n">ab_errors</span><span class="p">,</span> <span class="n">lf_errors</span><span class="p">,</span> <span class="n">ls_errors</span><span class="p">,</span> <span class="n">rk_errors</span><span class="p">,</span> <span class="n">ab_orders</span><span class="p">,</span> <span class="n">lf_orders</span><span class="p">,</span> <span class="n">ls_orders</span><span class="p">,</span> <span class="n">rk_orders</span><span class="p">)</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="c">!&lt; Print summary of the error analysis.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_steps</span>         <span class="c">!&lt; Adams-Bashforth steps number.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_stages</span>        <span class="c">!&lt; Runge-Kutta stages number.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NDt</span>              <span class="c">!&lt; Number of time steps exercised.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">time_steps</span><span class="p">(:)</span>    <span class="c">!&lt; Time steps exercised.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_errors</span><span class="p">(:,:,:)</span> <span class="c">!&lt; Adams-Bashforth errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lf_errors</span><span class="p">(:,:)</span>   <span class="c">!&lt; Leapfrog errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ls_errors</span><span class="p">(:,:,:)</span> <span class="c">!&lt; Low storage Runge-Kutta errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_errors</span><span class="p">(:,:,:)</span> <span class="c">!&lt; TVD/SSP Runge-Kutta errors.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ab_orders</span><span class="p">(:,:,:)</span> <span class="c">!&lt; Adams-Bashforth orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lf_orders</span><span class="p">(:,:)</span>   <span class="c">!&lt; Leapfrog orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ls_orders</span><span class="p">(:,:,:)</span> <span class="c">!&lt; Low storage Runge-Kutta orders.</span>
  <span class="kt">real</span><span class="p">(</span><span class="n">R_P</span><span class="p">),</span>    <span class="k">intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk_orders</span><span class="p">(:,:,:)</span> <span class="c">!&lt; TVD/SSP Runge-Kutta orders.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">s</span>                <span class="c">!&lt; Steps/stages counter.</span>
  <span class="kt">integer</span><span class="p">(</span><span class="n">I_P</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">d</span>                <span class="c">!&lt; Time steps-exercised counter.</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>

  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s2">&quot;Solver &amp; Time Step &amp; f*Dt &amp; Error X &amp; Error Y &amp; Observed Order of Accuracy X &amp; Observed Order of Accuracy Y&quot;</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ab_steps</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1st order scheme surely not stable for this test</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s2">&quot;Adams-Bashforth, &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; steps&quot;</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A)&quot;</span><span class="p">,</span> <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                 <span class="n">ab_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">ab_errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; / &amp; /&quot;</span>
      <span class="k">else</span>
<span class="k">        print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A,F9.2,A,F9.2)&quot;</span><span class="p">,</span> <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                            <span class="n">ab_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">ab_errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                            <span class="n">ab_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">ab_orders</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">endif</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s2">&quot;Leapfrog 2 steps&quot;</span>
  <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">      print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A)&quot;</span><span class="p">,</span> <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                              <span class="n">lf_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">lf_errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; / &amp; /&quot;</span>
    <span class="k">else</span>
<span class="k">      print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A,F9.2,A,F9.2)&quot;</span><span class="p">,</span> <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                          <span class="n">lf_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">lf_errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                          <span class="n">lf_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">lf_orders</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">endif</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1st order scheme surely not stable for this test</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 2 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 3 stages not yet implemented</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s2">&quot;Low Storage Runge-Kutta, &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; stages&quot;</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A)&quot;</span><span class="p">,</span> <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                <span class="n">ls_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">ls_errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; / &amp; /&quot;</span>
      <span class="k">else</span>
<span class="k">        print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A,F9.2,A,F9.2)&quot;</span><span class="p">,</span> <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                            <span class="n">ls_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">ls_errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                            <span class="n">ls_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">ls_orders</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">endif</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">do </span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rk_stages</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 1st order scheme surely not stable for this test</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">cycle</span> <span class="c">! 4 stages not yet implemented</span>
    <span class="k">print</span> <span class="s2">&quot;(A)&quot;</span><span class="p">,</span> <span class="s2">&quot;TVD/SSP Runge-Kutta, &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">str</span><span class="p">(.</span><span class="n">true</span><span class="p">.,</span><span class="n">s</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; stages&quot;</span>
    <span class="k">do </span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NDt</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A)&quot;</span><span class="p">,</span> <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                <span class="n">rk_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">rk_errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; / &amp; /&quot;</span>
      <span class="k">else</span>
<span class="k">        print</span> <span class="s2">&quot;(A,F8.1,A,F10.3,A,E10.3,A,E10.3,A,F9.2,A,F9.2)&quot;</span><span class="p">,</span> <span class="s2">&quot;  &amp; &quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">*</span><span class="n">time_steps</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                            <span class="n">rk_errors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">rk_errors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                            <span class="n">rk_orders</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot; &amp; &quot;</span> <span class="p">,</span> <span class="n">rk_orders</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">endif</span>
    <span class="n">enddo</span>
  <span class="n">enddo</span>
  <span class="k">return</span>
  <span class="c">!---------------------------------------------------------------------------------------------------------------------------------</span>
  <span class="n">endsubroutine</span> <span class="n">print_analysis</span>
<span class="n">endprogram</span> <span class="n">integrate_oscillation</span>
</pre></div>

    </section>
    
    
    </div>
  </div>

    <hr>
    <footer>
        <div class="row">
        <div class="col-md-6">&copy; 2015 FOODiE was written by Fortran-FOSS-Programmers Group. </div>
        <div class="col-md-6"><span class="pull-right">Documentation generated by <a href="https://github.com/cmacmackin/ford">FORD</a>.</span></div>
        </div>
        <br>
    </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>